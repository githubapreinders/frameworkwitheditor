{"version":3,"sources":["codemirror.min.js"],"names":["uiCodemirrorDirective","$timeout","uiCodemirrorConfig","postLink","scope","iElement","iAttrs","ngModel","codemirrorOptions","angular","extend","value","text","codemirror","$eval","uiCodemirror","uiCodemirrorOpts","newCodemirrorEditor","configOptionsWatcher","configNgModelLink","configUiRefreshAttribute","uiRefresh","$on","event","callback","isFunction","Error","onLoad","codemirrot","tagName","window","CodeMirror","fromTextArea","html","cm_el","append","uiCodemirrorAttr","updateOptions","newValues","oldValue","isObject","codemirrorDefaultsKeys","forEach","key","hasOwnProperty","setOption","Object","keys","defaults","$watch","$formatters","push","isUndefined","isArray","$render","safeViewValue","$viewValue","setValue","on","instance","newValue","getValue","$evalAsync","$setViewValue","codeMirror","uiRefreshAttr","newVal","oldVal","refresh","restrict","require","compile","module","constant","directive","$inject","global","factory","exports","define","amd","this","classTest","cls","RegExp","removeChildren","e","count","childNodes","length","removeChild","firstChild","removeChildrenAndAdd","parent","appendChild","elt","tag","content","className","style","document","createElement","cssText","createTextNode","i","eltP","setAttribute","contains","child","nodeType","parentNode","host","activeElt","activeElement","body","shadowRoot","addClass","node","current","test","joinClasses","a","b","as","split","bind","f","args","Array","prototype","slice","call","arguments","apply","copyObj","obj","target","overwrite","prop","countColumn","string","end","tabSize","startIndex","startValue","search","n","nextTab","indexOf","array","findColumn","goal","pos","col","skipped","Math","min","spaceStr","spaceStrs","lst","arr","map","out","insertSorted","score","priority","splice","nothing","createObj","base","props","inst","create","isWordCharBasic","ch","toUpperCase","toLowerCase","nonASCIISingleCaseWordChar","isWordChar","helper","source","isEmpty","isExtendingChar","charCodeAt","extendingChars","skipExtendingChars","str","dir","charAt","findFirst","pred","from","to","midF","mid","ceil","floor","Display","place","doc","input","d","scrollbarFiller","gutterFiller","lineDiv","selectionDiv","cursorDiv","measure","lineMeasure","lineSpace","lines","mover","sizer","sizerWidth","heightForcer","scrollerGap","gutters","lineGutter","scroller","wrapper","ie","ie_version","zIndex","paddingRight","webkit","gecko","mobile","draggable","viewFrom","viewTo","first","reportedViewFrom","reportedViewTo","view","renderedView","externalMeasured","viewOffset","lastWrapHeight","lastWrapWidth","updateLineNumbers","nativeBarWidth","barHeight","barWidth","scrollbarsClipped","lineNumWidth","lineNumInnerWidth","lineNumChars","alignWidgets","cachedCharWidth","cachedTextHeight","cachedPaddingH","maxLine","maxLineLength","maxLineChanged","wheelDX","wheelDY","wheelStartX","wheelStartY","shift","selForContextMenu","activeTouch","init","getLine","size","chunk","children","sz","chunkSize","getBetween","start","line","iter","getLines","updateLineHeight","height","diff","lineNo","cur","no","lineAtHeight","h","outer","i$1","lh","isLine","l","lineNumberFor","options","String","lineNumberFormatter","firstLineNumber","Pos","sticky","cmp","equalCursorPos","copyPos","x","maxPos","minPos","clipLine","max","clipPos","last","clipToLen","linelen","clipPosArray","seeReadOnlySpans","sawReadOnlySpans","seeCollapsedSpans","sawCollapsedSpans","MarkedSpan","marker","getMarkedSpanFor","spans","span","removeMarkedSpan","r","addMarkedSpan","markedSpans","concat","attachLine","markedSpansBefore","old","startCh","isInsert","nw","startsBefore","inclusiveLeft","type","insertLeft","endsAfter","inclusiveRight","markedSpansAfter","endCh","stretchSpansOverChange","change","full","oldFirst","oldLast","sameLine","offset","found","span$1","found$1","clearEmptySpans","newMarkers","gapMarkers","gap","i$2","i$3","clearWhenEmpty","removeReadOnlyRanges","markers","mark","readOnly","parts","mk","m","find","j","p","newParts","dfrom","dto","detachMarkedSpans","detachLine","attachMarkedSpans","extraLeft","extraRight","compareCollapsedMarkers","lenDiff","aPos","bPos","fromCmp","toCmp","id","collapsedSpanAtSide","sps","sp","collapsed","collapsedSpanAtStart","collapsedSpanAtEnd","conflictingCollapsedRange","visualLine","merged","visualLineEnd","visualLineContinued","visualLineNo","lineN","vis","visualLineEndNo","lastLine","lineIsHidden","widgetNode","lineIsHiddenInner","heightAtLine","lineObj","lineLength","len","findMaxLine","cm","display","iterateBidiSections","order","part","level","getBidiPartAt","bidiOther","getOrder","direction","bidiOrdering","getHandlers","emitter","_handlers","noHandlers","off","removeEventListener","detachEvent","index","signal","handlers","signalDOMEvent","override","preventDefault","defaultPrevented","e_defaultPrevented","codemirrorIgnore","signalCursorActivity","cursorActivity","set","curOp","cursorActivityHandlers","hasHandler","eventMixin","ctor","e_preventDefault","returnValue","e_stopPropagation","stopPropagation","cancelBubble","e_stop","e_target","srcElement","e_button","which","button","mac","ctrlKey","zeroWidthElement","zwspSupported","offsetHeight","offsetWidth","hasBadBidiRects","badBidiRects","txt","r0","range","getBoundingClientRect","r1","left","right","hasBadZoomedRects","badZoomedRects","normal","fromRange","abs","defineMode","name","mode","dependencies","modes","defineMIME","mime","spec","mimeModes","resolveMode","getMode","mfactory","modeObj","modeExtensions","exts","helperType","modeProps","prop$1","extendMode","properties","copyState","state","nstate","val","innerMode","info","startState","a1","a2","highlightLine","context","forceToEnd","st","modeGen","lineClasses","runMode","loop","o","baseTokens","overlay","overlays","at","i_end","opaque","baseTokenPos","styles","classes","bgClass","textClass","getLineStyles","updateFrontier","getContextBefore","resetState","maxHighlightLength","result","stateAfter","save","styleClasses","highlightFrontier","modeFrontier","precise","Context","findStartLine","saved","fromSaved","processLine","nextLine","startAt","stream","StringStream","callBlankLine","eol","readToken","blankLine","inner","token","takeToken","asArray","tokens","Token","extractLineClasses","output","lineClass","match","flattenSpans","curStart","curStyle","addModeClass","mName","minindent","minline","lim","after","SavedContext","lookAhead","indented","retreatFrontier","updateLine","estimateHeight","estHeight","cleanUpLine","interpretTokenStyle","cache","styleToClassCacheWithMode","styleToClassCache","replace","buildLineContent","lineView","builder","pre","trailingSpace","splitSpaces","getOption","rest","addToken","buildToken","buildTokenBadBidi","allowFrontierUpdate","insertLineContent","maps","caches","lastChild","querySelector","defaultSpecialCharPlaceholder","title","toString","startStyle","endStyle","css","displayText","special","specialChars","mustWrap","createDocumentFragment","lastIndex","exec","txt$1","tabWidth","specialCharPlaceholder","fullStyle","trailingBefore","spaceBefore","buildCollapsedSpan","ignoreWidget","widget","needsContentAttribute","setUneditable","allText","spanStyle","spanEndStyle","spanStartStyle","nextChange","Infinity","foundBookmarks","endStyles","j$1","j$2","upto","tokenText","LineView","hidden","buildViewArray","nextPos","pushOperation","op","operationGroup","ops","ownsGroup","delayedCallbacks","fireCallbacksForOps","group","callbacks","cursorActivityCalled","finishOperation","endCb","signalLater","list","orphanDelayedCallbacks","setTimeout","fireOrphanDelayed","delayed","updateLineForChanges","dims","changes","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","ensureLineWrapped","replaceChild","updateLineBackground","background","wrap","insertBefore","getLineContent","ext","built","wrapClass","gutter","gutterBackground","gutterClass","fixedGutter","fixedPos","gutterTotalWidth","gutterMarkers","lineNumbers","wrap$1","gutterWrap","lineNumber","gutterLeft","k","gutterWidth","alignable","next","nextSibling","insertLineWidgets","buildLineElement","insertLineWidgetsFor","allowAbove","widgets","ws","handleMouseEvents","positionLineWidget","above","noHScroll","width","wrapperWidth","coverGutter","paddingLeft","position","marginLeft","widgetHeight","parentStyle","clientWidth","eventInWidget","getAttribute","paddingTop","offsetTop","paddingVert","paddingH","getComputedStyle","currentStyle","data","parseInt","isNaN","scrollGap","displayWidth","displayHeight","clientHeight","ensureLineHeights","rect","wrapping","lineWrapping","curWidth","heights","rects","getClientRects","bottom","top","mapFromLineView","before","updateExternalMeasurement","measureChar","bias","measureCharPrepared","prepareMeasureForLine","findViewForLine","findViewIndex","getDimensions","forceUpdate","hasHeights","prepared","varHeight","measureCharInner","bogus","rtop","rbottom","nodeAndOffsetInLineMap","collapse","mStart","mEnd","coverStart","coverEnd","getUsefulRect","nullRect","maybeUpdateRectForZooming","rSpan","charWidth","rbot","bot","singleCursorHeightPerLine","screen","logicalXDPI","deviceXDPI","scaleX","scaleY","logicalYDPI","deviceYDPI","clearLineMeasurementCacheFor","clearLineMeasurementCache","externalMeasure","clearCaches","pageScrollX","chrome","android","pageXOffset","documentElement","scrollLeft","pageScrollY","marginTop","pageYOffset","scrollTop","widgetTopHeight","intoCoordSystem","includeWidgets","yOff","lOff","xOff","fromCoordSystem","coords","localBox","lineSpaceBox","charCoords","cursorCoords","preparedMeasure","get","getBidi","partPos","invert","other","estimateCoords","PosWithInfo","outside","xRel","coordsChar","y","coordsCharInner","mergedPos","wrappedLineExtent","begin","wrappedLineExtentChar","targetTop","boxIsAfter","box","ltr","coordsBidiPartWrapped","coordsBidiPart","baseX","chAround","boxAround","atLeft","atStart","_lineNo","ref","closestDist","endX","dist","textHeight","measureText","anchor","clientLeft","offsetLeft","compensateForHScroll","th","perLine","widgetsHeight","estimateLineHeights","est","posFromMouse","liberal","forRect","space","clientX","clientY","colDiff","round","updateSelection","showSelection","prepareSelection","primary","curFragment","cursors","selFragment","selection","sel","ranges","primIndex","empty","showCursorWhenSelecting","drawSelectionCursor","head","drawSelectionRange","cursor","cursorHeight","otherCursor","cmpCoords","add","fragment","rightSide","drawForLine","fromArg","toArg","wrapX","side","extent","lineLen","fromPos","toPos","openStart","openEnd","openLeft","docLTR","openRight","leftSide","topLeft","topRight","botLeft","botRight","padding","sFrom","sTo","fromLine","toLine","singleVLine","leftEnd","rightStart","restartBlink","focused","clearInterval","blinker","visibility","cursorBlinkRate","setInterval","ensureFocus","focus","onFocus","delayBlurEvent","delayingBlurEvent","onBlur","reset","receivedFocus","rmClass","updateHeightsInViewport","prevBottom","updateWidgetHeight","visibleLines","viewport","ensure","ensureFrom","ensureTo","alignHorizontally","comp","gutterW","align","maybeUpdateLineNumberWidth","innerW","updateGutterSpace","maybeScrollWindow","doScroll","innerHeight","phantom","scrollNode","scrollIntoView","scrollPosIntoView","margin","limit","changed","endCoords","scrollPos","calculateScrollPos","startTop","startLeft","updateScrollTop","setScrollLeft","snapMargin","screentop","docBottom","atTop","atBottom","newTop","screenleft","screenw","tooWide","addToScrollTop","resolveScrollToPos","ensureCursorVisible","getCursor","scrollToPos","cursorScrollMargin","scrollToCoords","scrollToRange","scrollToCoordsRange","sPos","updateDisplaySimple","setScrollTop","startWorker","forceScroll","scrollHeight","scrollbars","isScroller","scrollWidth","measureForScrollbars","docH","viewHeight","viewWidth","barLeft","docHeight","updateScrollbars","startWidth","startHeight","updateScrollbarsInner","sizes","update","paddingBottom","borderBottom","coverGutterNextToScrollbar","initScrollbars","clear","scrollbarModel","scrollbarStyle","axis","startOperation","viewChanged","updateInput","typing","changeObjs","selectionChanged","updateMaxLine","nextOpId","endOperation","endOperations","endOperation_R1","endOperation_W1","endOperation_R2","endOperation_W2","i$4","endOperation_finish","maybeClipScrollbars","mustUpdate","DisplayUpdate","updatedDisplay","updateDisplayIfNeeded","barMeasure","adjustWidthTo","maxScrollLeft","preparedSelection","minWidth","takeFocus","setDocumentHeight","postUpdateDisplay","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","finish","runInOp","operation","methodOp","docMethodOp","regChange","lendiff","resetView","cut","viewCuttingPoint","cut$1","cutTop","cutBot","regLineChange","oldN","newN","adjustView","countDirtyView","dirty","time","highlight","highlightWorker","Date","workTime","changedLines","oldStyles","highlighted","oldCls","newCls","ischange","workDelay","marginBottom","borderRightWidth","selectionSnapshot","hasFocus","active","getSelection","anchorNode","anchorOffset","focusNode","focusOffset","restoreSelection","snapshot","createRange","setEnd","removeAllRanges","addRange","editorIsHidden","force","visible","viewportMargin","different","wrapperHeight","toUpdate","selSnapshot","patchDisplay","minHeight","oldDisplayWidth","updateNumbersFrom","rm","currentWheelTarget","container","updateNumber","updateGutters","specs","gElt","setGuttersForLineNumbers","wheelEventDelta","dx","wheelDeltaX","dy","wheelDeltaY","detail","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","wheelEventPixels","delta","wheelPixelsPerUnit","onScrollWheel","scroll","canScrollX","canScrollY","presto","pixels","wheelSamples","movedX","movedY","sample","normalizeSelection","prim","sort","prev","inv","Range","Selection","simpleSelection","changeEnd","adjustForChange","computeSelAfterChange","offsetPos","computeReplacedSel","hint","oldPrev","newPrev","loadMode","modeOption","resetModeState","isWholeLineUpdate","wholeLineUpdateBefore","updateDoc","spansFor","linesFor","Line","firstLine","lastText","lastSpans","nlines","insert","remove","added","added$1","added$2","linkedDocs","sharedHistOnly","propagate","skip","sharedHist","linked","rel","shared","attachDoc","setDirectionClass","directionChanged","History","startGen","done","undone","undoDepth","lastModTime","lastSelTime","lastOp","lastSelOp","lastOrigin","lastSelOrigin","generation","maxGeneration","historyChangeFromChange","histChange","attachLocalSpans","clearSelectionEvents","pop","lastChangeEvent","hist","addChangeToHistory","selAfter","opId","history","origin","historyEventDelay","pushSelectionToHistory","selectionEventCanBeMerged","somethingSelected","addSelectionToHistory","clearRedo","dest","equals","existing","removeClearedSpans","explicitlyCleared","getOldSpans","mergeOldSpans","stretched","oldCur","stretchCur","copyHistoryArray","events","newGroup","instantiateSel","copy","deepCopy","newChanges","Number","extendRange","posBefore","extendSelection","setSelection","extendSelections","heads","newSel","replaceOneSelection","setSimpleSelection","filterSelectionChange","this$1","setSelectionReplaceHistory","setSelectionNoUndo","NaN","setSelectionInner","skipAtomicInSelection","reCheckSelection","mayClear","newAnchor","skipAtomic","newHead","skipAtomicInner","oldPos","atomic","near","movePos","far","cantEdit","selectAll","sel_dontScroll","filterChange","canceled","cancel","undefined","makeChange","ignoreReadOnly","suppressEdits","makeChangeInner","makeChangeSingleDoc","rebased","rebaseHist","makeChangeFromHistory","allowSelectionOnly","antiChanges","filter","returned","v","shiftDoc","distance","removed","makeChangeSingleDocInEditor","recomputeMaxLength","checkWidthStart","changesHandler","changeHandler","replaceRange","code","assign","splitLines","rebaseHistSelSingle","rebaseHistArray","sub","ok","copied","changeLine","handle","changeType","LeafChunk","BranchChunk","adjustScrollWhenAboveVisible","addLineWidget","LineWidget","insertAt","aboveVisible","markText","markTextShared","TextMarker","replacedWith","addToHistory","curLine","clearOnEnter","clearHistory","nextMarkerId","cloneNode","isParent","SharedTextMarker","findSharedMarkers","findMarks","copySharedMarkers","mFrom","mTo","subMark","detachSharedMarkers","subMarker","onDrop","clearDragCursor","lastDrop","files","dataTransfer","isReadOnly","FileReader","File","read","loadFile","file","allowDropFileTypes","reader","onload","join","lineSeparator","readAsText","draggingText","text$1","getData","selected","listSelections","replaceSelection","onDragStart","setData","effectAllowed","setDragImage","safari","img","src","_top","onDragOver","frag","dragCursor","forEachCodeMirror","getElementsByClassName","byClass","ensureGlobalHandlers","globalsRegistered","registerGlobalHandlers","resizeTimer","onResize","setSize","normalizeKeyName","alt","ctrl","cmd","mod","normalizeKeyMap","keymap","keyname","lookupKey","getKeyMap","fallthrough","isModifierKey","keyNames","keyCode","addModifierNames","noShift","altKey","flipCtrlCmd","metaKey","shiftKey","keyName","altGraphKey","keyMap","deleteNearSelection","compute","kill","toKill","replaced","moveCharLogically","moveLogically","endOfLine","visually","moveInStorageOrder","prep","moveVisually","bidi","mv","getWrappedLineExtent","searchInVisualLine","getRes","res","nextCh","lineStart","visual","lineEnd","lineStartSmart","firstNonWS","inWS","doHandleBinding","bound","dropShift","commands","ensurePolled","prevShift","Pass","lookupKeyForEditor","keyMaps","extraKeys","dispatchKey","seq","keySeq","stopSeq","handleKeyBinding","motion","handleCharBinding","onKeyDown","handled","lastStoppedKey","hasCopyEvent","showCrossHair","up","onKeyUp","onKeyPress","charCode","fromCharCode","clickRepeat","now","lastDoubleClick","compare","lastClick","PastClick","onMouseDown","supportsTouch","clickInGutter","repeat","selectingText","handleMappedButton","leftButtonDown","captureRightClick","onContextMenu","configureMouse","option","unit","chromeOS","addNew","moveOnDrag","contained","behavior","dragDrop","dragAndDrop","leftButtonStartDrag","leftButtonSelect","moved","dragEnd","mouseMove","dragStart","e2","rangeForUnit","findWordAt","extendTo","lastPos","startCol","posCol","leftPos","startSel","ourIndex","oldRange","ourRange","ranges$1","bidiSimplify","sel_mouse","curCount","counter","editorSize","move","anchorLine","boundary","headIndex","usePart","gutterEvent","prevent","mX","mY","touches","lineBox","g","contextMenuInGutter","themeChanged","theme","defineOptions","deflt","notOnInit","optionHandlers","Init","defineOption","lineSep","newBreaks","getInputField","spellcheck","windows","guttersChanged","detach","attach","wrappingChanged","integer","blur","readOnlyChanged","dragDropChanged","resetPosition","getField","tabIndex","setDirection","wasOn","funcs","dragFunctions","toggle","enter","over","leave","drop","Doc","inputStyles","inputStyle","pasteIncoming","cutIncoming","Delayed","autofocus","registerEventHandlers","opt","finishInit","initHooks","textRendering","finishTouch","touchFinished","prevTouch","isMouseLikeTouchEvent","touch","radiusX","radiusY","farAway","word","clearTimeout","pageX","pageY","inp","indentLine","how","aggressive","indent","curSpace","indentation","curSpaceString","indentUnit","indentString","indentWithTabs","pos$1","setLastCopied","newLastCopied","lastCopied","applyTextInput","inserted","deleted","paste","textLines","splitLinesAuto","multiPaste","pasteLinesPerSelection","lineWise","changeEvent","triggerElectric","handlePaste","pasted","clipboardData","disableInput","electricChars","smartIndent","getModeAt","electricInput","copyableRanges","lineRange","getRange","disableBrowserMagic","field","hiddenTextarea","te","div","ios","border","addEditorMethods","helpers","constructor","getDoc","addKeyMap","removeKeyMap","addOverlay","modeSpec","removeOverlay","indentSelection","newRanges","getTokenAt","getLineTokens","getTokenTypeAt","getHelper","getHelpers","help","_global","getStateAfter","defaultTextHeight","defaultCharWidth","getViewport","addWidget","vert","horiz","vspace","hspace","triggerOnKeyDown","triggerOnKeyPress","triggerOnKeyUp","triggerOnMouseDown","execCommand","findPosH","amount","hitSide","moveH","extendSelectionsBy","rtlMoveVisually","sel_move","deleteH","findPosV","goalColumn","moveV","goals","headPos","startChar","check","toggleOverwrite","scrollTo","getScrollInfo","interpret","oldHeight","swapDoc","getWrapperElement","getScrollerElement","getGutterElement","registerHelper","registerGlobalHelper","predicate","findNextLine","moveOnce","boundToLine","origDir","sawType","pageSize","moveAmount","posToDOM","isInGutter","scan","badPos","bad","domTextBetween","recognizeMarker","close","closing","addText","walk","cmText","textContent","markerID","isBlock","nodeName","nodeValue","domToPos","lineNode","locateNodeInLineView","textNode","topNode","curNode","previousSibling","dist$1","textarea","tabindex","placeholder","realSubmit","form","leaveSubmitMethodAlone","submit","wrappedSubmit","getTextArea","toTextArea","addLegacyProps","cmpPos","userAgent","navigator","platform","ie_upto10","ie_11up","edge","documentMode","qtwebkit","vendor","mac_geMountainLion","presto_version","endNode","setStart","createTextRange","moveToElementText","moveEnd","moveStart","selectInput","select","selectionStart","selectionEnd","_e","ms","charType","lowTypes","arabicTypes","BidiSpan","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","outerType","types","type$1","prev$1","type$2","type$3","i$5","cur$1","type$4","i$6","end$1","replace$1","i$7","nstart","unshift","reverse","addEventListener","attachEvent","nl","rt","hasSelection","ownerDocument","parentElement","compareEndPoints","oncopy","lineOracle","lastColumnPos","lastColumnValue","sol","peek","eat","eatWhile","eatSpace","skipToEnd","skipTo","backUp","column","pattern","consume","caseInsensitive","cased","substr","hideFirstChars","oracle","baseToken","maxLookAhead","NativeScrollbars","checkedZeroWidth","needsH","needsV","sWidth","totalHeight","totalWidth","zeroWidthHack","disableHoriz","enableZeroWidthBar","disableVert","w","pointerEvents","bar","delay","maybeDisable","elementFromPoint","NullScrollbars","native","null","here","there","removeInner","insertInner","iterN","remaining","leaf","maybeSpill","me","spilled","sibling","myIndex","used","oldH","withOp","dHeight","nextDocId","cleanGeneration","getLineHandle","getLineNumber","getLineHandleVisualStart","lineCount","setCursor","setSelections","addSelection","getSelections","dup","replaceSelections","undo","redo","undoSelection","redoSelection","setExtending","getExtending","historySize","markClean","changeGeneration","forceSplit","isClean","gen","getHistory","setHistory","histData","setGutterMarker","gutterID","clearGutter","lineInfo","addLineClass","where","removeLineClass","removeLineWidget","setBookmark","realOpts","findMarksAt","getAllMarks","posFromIndex","sepSize","indexFromPos","copyHistory","linkedDoc","unlinkDoc","link","splitIds","iterLinkedDocs","getEditor","eachLine","3","8","9","13","16","17","18","19","20","27","32","33","34","35","36","37","38","39","40","44","45","46","59","61","91","92","93","106","107","109","110","111","127","173","186","187","188","189","190","191","192","219","220","221","222","63232","63233","63234","63235","63272","63273","63275","63276","63277","63302","basic","Left","Right","Up","Down","End","Home","PageUp","PageDown","Delete","Backspace","Shift-Backspace","Tab","Shift-Tab","Enter","Insert","Esc","pcDefault","Ctrl-A","Ctrl-D","Ctrl-Z","Shift-Ctrl-Z","Ctrl-Y","Ctrl-Home","Ctrl-End","Ctrl-Up","Ctrl-Down","Ctrl-Left","Ctrl-Right","Alt-Left","Alt-Right","Ctrl-Backspace","Ctrl-Delete","Ctrl-S","Ctrl-F","Ctrl-G","Shift-Ctrl-G","Shift-Ctrl-F","Shift-Ctrl-R","Ctrl-[","Ctrl-]","Ctrl-U","Shift-Ctrl-U","Alt-U","emacsy","Ctrl-B","Ctrl-P","Ctrl-N","Alt-F","Alt-B","Ctrl-E","Ctrl-V","Shift-Ctrl-V","Ctrl-H","Alt-D","Alt-Backspace","Ctrl-K","Ctrl-T","Ctrl-O","macDefault","Cmd-A","Cmd-D","Cmd-Z","Shift-Cmd-Z","Cmd-Y","Cmd-Home","Cmd-Up","Cmd-End","Cmd-Down","Cmd-Left","Cmd-Right","Ctrl-Alt-Backspace","Alt-Delete","Cmd-S","Cmd-F","Cmd-G","Shift-Cmd-G","Cmd-Alt-F","Shift-Cmd-Alt-F","Cmd-[","Cmd-]","Cmd-Backspace","Cmd-Delete","Cmd-U","Shift-Cmd-U","singleSelection","killLine","deleteLine","delLineLeft","delWrappedLineLeft","delWrappedLineRight","rightPos","goDocStart","goDocEnd","goLineStart","goLineStartSmart","goLineEnd","goLineRight","goLineLeft","goLineLeftSmart","goLineUp","goLineDown","goPageUp","goPageDown","goCharLeft","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentAuto","indentMore","indentLess","insertTab","insertSoftTab","spaces","defaultTab","transposeChars","newlineAndIndent","sels","openLine","DOUBLECLICK_DELAY","defineInitHook","ContentEditableInput","lastAnchorNode","lastAnchorOffset","lastFocusNode","lastFocusOffset","polling","composing","gracePeriod","readDOMTimeout","onCopyCut","lineWiseCopyCut","clearData","kludge","hadFocus","showPrimarySelection","updateFromDOM","readFromDOMSoon","forceCompositionEnd","showMultipleSelections","curAnchor","curFocus","rng","rangeCount","getRangeAt","startGracePeriod","rememberSelection","selectionInEditor","commonAncestorContainer","poll","pollSelection","pollInterval","pollContent","fromIndex","fromNode","toNode","toIndex","newText","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","contentEditable","TextareaInput","prevInput","pollingFast","prepareCopyCut","fastPoll","moveInputWithCursor","wrapOff","lineOff","teTop","teLeft","drawn","contextMenuPending","slowPoll","missed","same","prepareSelectAllHack","extval","rehide","oldWrapperCSS","oldCSS","detectingSelectAll","resetSelectionOnContextMenu","wrapperBox","oldScrollY","scrollY","mouseup","disabled","dontDelegate","method","contenteditable","defineExtension","func","defineDocExtension","version","regexpFlags","regexp","flags","ignoreCase","multiline","ensureGlobal","maybeMultiline","searchRegexpForward","searchRegexpForwardMultiline","inside","startLine","lastMatchIn","cutOff","newMatch","searchRegexpBackward","searchRegexpBackwardMultiline","adjustPos","orig","folded","foldFunc","searchStringForward","query","caseFold","fold","doFold","noFold","cutFrom","endString","searchStringBackward","lastIndexOf","topString","SearchCursor","atOccurrence","matches","normalize","findNext","findPrevious","getSearchCursor","searchOverlay","SearchState","posFrom","posTo","lastQuery","getSearchState","queryCaseInsensitive","persistentDialog","onEnter","openDialog","selectValueOnOpen","closeOnEnter","onClose","clearSearch","dialog","shortText","prompt","confirmDialog","fs","openConfirm","confirm","parseString","_","parseQuery","isRE","startSearch","queryText","showMatchesOnScrollbar","annotate","doSearch","rev","persistent","immediate","q","hiding","searchNext","opacity","queryDialog","extra","replaceAll","all","dialogText","replaceQueryDialog","replacementQueryDialog","advance","doReplaceConfirm","doReplace","findPersistent","findPersistentNext","findPersistentPrev","findPrev","State","parseOptions","opts","indicatorOpen","indicatorFolded","isFolded","marks","__isFold","updateFoldInfo","foldGutter","minSize","foldOption","updateInViewport","vp","onGutterClick","foldCode","rangeFinder","onChange","changeUpdate","foldOnChangeTimeSpan","onViewportChange","updateViewportTimeSpan","onFold","Iter","tagAt","prevLine","toTagEnd","gt","lastSlash","selfClose","toTagStart","lt","xmlTagStart","toNextTag","toPrevTag","findMatchingClose","stack","findMatchingOpen","endLine","nameStartChar","nameChar","openTag","startPos","endPos","findMatchingTag","open","findEnclosingTag","forward","scanForClosingTag","allowFolded","finder","cleared","myWidget","makeWidget","myRange","editorOptions","foldOptions","defaultOptions","newFoldFunction","toggleFold","unfold","foldAll","unfoldAll","auto","minFoldSize","scanUp","tagHit","tagOther","doMatchTags","failedTagMatch","matchBothTags","hit","maybeUpdateMatch","bothTags","toMatchingTag","getHints","tags","schemaInfo","quote","quoteChar","prefix","tagStart","replaceToken","tagType","cx","curTag","childList","attrs","globalAttrs","nm","atValues","atName","attr","Completion","debounce","tick","startLen","self","activityFunc","isNewCompletion","editor","hintOptions","resolve","getText","completion","console","log","buildKeyMap","addBinding","baseMap","ourMap","moveFocus","menuSize","setFocus","pick","custom","customKeys","getHintElement","hintsElement","el","Widget","picked","hints","selectedHint","completions","HINT_ELEMENT_CLASS","ACTIVE_HINT_ELEMENT_CLASS","render","hintId","alignWithWord","below","winW","innerWidth","winH","overlapY","scrolls","startScroll","curTop","overlapX","avoidWrap","changeActive","screenAmount","closeOnUnfocus","closingOnBlur","onScroll","curScroll","point","t","completeOnSingleClick","applicableHelpers","supportsSelection","fetchHints","async","then","resolveAutoHints","words","resolved","run","app","fromList","anyword","showHint","newOpts","selections","completionActive","requestAnimationFrame","fn","cancelAnimationFrame","closeCharacters","disable","myTick","finishUpdate","completeSingle","term","autocomplete","htmlConfig","autoSelfClosers","area","br","command","embed","frame","hr","keygen","meta","param","track","wbr","menuitem","implicitlyClosed","dd","li","optgroup","rp","tbody","td","tfoot","tr","contextGrabbers","dt","address","article","aside","blockquote","dl","fieldset","footer","h1","h2","h3","h4","h5","h6","header","hgroup","menu","nav","ol","section","table","ul","thead","doNotIndent","allowUnquoted","allowMissing","xmlConfig","editorConf","config_","inText","chain","parser","tokenize","inBlock","doctype","inTag","baseState","inAttribute","stringStartCol","closure","isInAttribute","terminator","depth","startOfLine","config","noIndent","popContext","maybePopContext","nextTagName","parentTagName","tagNameState","closeTagNameState","setStyle","attrState","matchClosing","closeState","closeStateErr","_stream","attrEqState","attrValueState","attrContinuedState","htmlMode","isInText","baseIndent","textAfter","fullLine","multilineTagIndentPastTag","multilineTagIndentFactor","alignCDATA","tagAfter","grabbers","blockCommentStart","blockCommentEnd","configuration","skipAttribute"],"mappings":"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","file":"codemirror.min.js","sourcesContent":["'use strict';\r\n\r\nangular.module('ui.codemirror', [])\r\n  .constant('uiCodemirrorConfig', {})\r\n  .directive('uiCodemirror', uiCodemirrorDirective);\r\n\r\nfunction uiCodemirrorDirective($timeout, uiCodemirrorConfig) {\r\n\r\n  return {\r\n    restrict: 'EA',\r\n    require: '?ngModel',\r\n    compile: function compile() {\r\n\r\n      if (angular.isUndefined(window.CodeMirror)) {\r\n        throw new Error('ui-codemirror needs CodeMirror to work... (o rly?)');\r\n      }\r\n\r\n      return postLink;\r\n    }\r\n  };\r\n\r\n  function postLink(scope, iElement, iAttrs, ngModel) {\r\n\r\n    var codemirrorOptions = angular.extend(\r\n      { value: iElement.text() },\r\n      uiCodemirrorConfig.codemirror || {},\r\n      scope.$eval(iAttrs.uiCodemirror),\r\n      scope.$eval(iAttrs.uiCodemirrorOpts)\r\n    );\r\n\r\n    var codemirror = newCodemirrorEditor(iElement, codemirrorOptions);\r\n\r\n    configOptionsWatcher(\r\n      codemirror,\r\n      iAttrs.uiCodemirror || iAttrs.uiCodemirrorOpts,\r\n      scope\r\n    );\r\n\r\n    configNgModelLink(codemirror, ngModel, scope);\r\n\r\n    configUiRefreshAttribute(codemirror, iAttrs.uiRefresh, scope);\r\n\r\n    scope.$on('CodeMirror', function(event, callback) {\r\n      if (angular.isFunction(callback)) {\r\n        callback(codemirror);\r\n      } else {\r\n        throw new Error('the CodeMirror event requires a callback function');\r\n      }\r\n    });\r\n\r\n    if (angular.isFunction(codemirrorOptions.onLoad)) {\r\n      codemirrorOptions.onLoad(codemirror);\r\n    }\r\n  }\r\n\r\n  function newCodemirrorEditor(iElement, codemirrorOptions) {\r\n    var codemirrot;\r\n\r\n    if (iElement[0].tagName === 'TEXTAREA') {\r\n      codemirrot = window.CodeMirror.fromTextArea(iElement[0], codemirrorOptions);\r\n    } else {\r\n      iElement.html('');\r\n      codemirrot = new window.CodeMirror(function(cm_el) {\r\n        iElement.append(cm_el);\r\n      }, codemirrorOptions);\r\n    }\r\n\r\n    return codemirrot;\r\n  }\r\n\r\n  function configOptionsWatcher(codemirrot, uiCodemirrorAttr, scope) {\r\n    if (!uiCodemirrorAttr) { return; }\r\n\r\n    var codemirrorDefaultsKeys = Object.keys(window.CodeMirror.defaults);\r\n    scope.$watch(uiCodemirrorAttr, updateOptions, true);\r\n    function updateOptions(newValues, oldValue) {\r\n      if (!angular.isObject(newValues)) { return; }\r\n      codemirrorDefaultsKeys.forEach(function(key) {\r\n        if (newValues.hasOwnProperty(key)) {\r\n\r\n          if (oldValue && newValues[key] === oldValue[key]) {\r\n            return;\r\n          }\r\n\r\n          codemirrot.setOption(key, newValues[key]);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  function configNgModelLink(codemirror, ngModel, scope) {\r\n    if (!ngModel) { return; }\r\n    ngModel.$formatters.push(function(value) {\r\n      if (angular.isUndefined(value) || value === null) {\r\n        return '';\r\n      } else if (angular.isObject(value) || angular.isArray(value)) {\r\n        throw new Error('ui-codemirror cannot use an object or an array as a model');\r\n      }\r\n      return value;\r\n    });\r\n\r\n\r\n    ngModel.$render = function() {\r\n      var safeViewValue = ngModel.$viewValue || '';\r\n      codemirror.setValue(safeViewValue);\r\n    };\r\n\r\n\r\n    codemirror.on('change', function(instance) {\r\n      var newValue = instance.getValue();\r\n      if (newValue !== ngModel.$viewValue) {\r\n        scope.$evalAsync(function() {\r\n          ngModel.$setViewValue(newValue);\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  function configUiRefreshAttribute(codeMirror, uiRefreshAttr, scope) {\r\n    if (!uiRefreshAttr) { return; }\r\n\r\n    scope.$watch(uiRefreshAttr, function(newVal, oldVal) {\r\n      if (newVal !== oldVal) {\r\n        $timeout(function() {\r\n          codeMirror.refresh();\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\nuiCodemirrorDirective.$inject = [\"$timeout\", \"uiCodemirrorConfig\"];\r\n\n\r\n\r\n(function (global, factory) {\r\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\r\n  typeof define === 'function' && define.amd ? define(factory) :\r\n  (global.CodeMirror = factory());\r\n}(this, (function () { 'use strict';\r\n\r\nvar userAgent = navigator.userAgent\r\nvar platform = navigator.platform\r\n\r\nvar gecko = /gecko\\/\\d/i.test(userAgent)\r\nvar ie_upto10 = /MSIE \\d/.test(userAgent)\r\nvar ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent)\r\nvar edge = /Edge\\/(\\d+)/.exec(userAgent)\r\nvar ie = ie_upto10 || ie_11up || edge\r\nvar ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1])\r\nvar webkit = !edge && /WebKit\\//.test(userAgent)\r\nvar qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent)\r\nvar chrome = !edge && /Chrome\\//.test(userAgent)\r\nvar presto = /Opera\\//.test(userAgent)\r\nvar safari = /Apple Computer/.test(navigator.vendor)\r\nvar mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent)\r\nvar phantom = /PhantomJS/.test(userAgent)\r\n\r\nvar ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent)\r\nvar android = /Android/.test(userAgent)\r\nvar mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent)\r\nvar mac = ios || /Mac/.test(platform)\r\nvar chromeOS = /\\bCrOS\\b/.test(userAgent)\r\nvar windows = /win/i.test(platform)\r\n\r\nvar presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/)\r\nif (presto_version) { presto_version = Number(presto_version[1]) }\r\nif (presto_version && presto_version >= 15) { presto = false; webkit = true }\r\nvar flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11))\r\nvar captureRightClick = gecko || (ie && ie_version >= 9)\r\n\r\nfunction classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\r\n\r\nvar rmClass = function(node, cls) {\r\n  var current = node.className\r\n  var match = classTest(cls).exec(current)\r\n  if (match) {\r\n    var after = current.slice(match.index + match[0].length)\r\n    node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\")\r\n  }\r\n}\r\n\r\nfunction removeChildren(e) {\r\n  for (var count = e.childNodes.length; count > 0; --count)\r\n    { e.removeChild(e.firstChild) }\r\n  return e\r\n}\r\n\r\nfunction removeChildrenAndAdd(parent, e) {\r\n  return removeChildren(parent).appendChild(e)\r\n}\r\n\r\nfunction elt(tag, content, className, style) {\r\n  var e = document.createElement(tag)\r\n  if (className) { e.className = className }\r\n  if (style) { e.style.cssText = style }\r\n  if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)) }\r\n  else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]) } }\r\n  return e\r\n}\r\nfunction eltP(tag, content, className, style) {\r\n  var e = elt(tag, content, className, style)\r\n  e.setAttribute(\"role\", \"presentation\")\r\n  return e\r\n}\r\n\r\nvar range\r\nif (document.createRange) { range = function(node, start, end, endNode) {\r\n  var r = document.createRange()\r\n  r.setEnd(endNode || node, end)\r\n  r.setStart(node, start)\r\n  return r\r\n} }\r\nelse { range = function(node, start, end) {\r\n  var r = document.body.createTextRange()\r\n  try { r.moveToElementText(node.parentNode) }\r\n  catch(e) { return r }\r\n  r.collapse(true)\r\n  r.moveEnd(\"character\", end)\r\n  r.moveStart(\"character\", start)\r\n  return r\r\n} }\r\n\r\nfunction contains(parent, child) {\r\n  if (child.nodeType == 3) \r\n    { child = child.parentNode }\r\n  if (parent.contains)\r\n    { return parent.contains(child) }\r\n  do {\r\n    if (child.nodeType == 11) { child = child.host }\r\n    if (child == parent) { return true }\r\n  } while (child = child.parentNode)\r\n}\r\n\r\nfunction activeElt() {\r\n  var activeElement\r\n  try {\r\n    activeElement = document.activeElement\r\n  } catch(e) {\r\n    activeElement = document.body || null\r\n  }\r\n  while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\r\n    { activeElement = activeElement.shadowRoot.activeElement }\r\n  return activeElement\r\n}\r\n\r\nfunction addClass(node, cls) {\r\n  var current = node.className\r\n  if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls }\r\n}\r\nfunction joinClasses(a, b) {\r\n  var as = a.split(\" \")\r\n  for (var i = 0; i < as.length; i++)\r\n    { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i] } }\r\n  return b\r\n}\r\n\r\nvar selectInput = function(node) { node.select() }\r\nif (ios) \r\n  { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length } }\r\nelse if (ie) \r\n  { selectInput = function(node) { try { node.select() } catch(_e) {} } }\r\n\r\nfunction bind(f) {\r\n  var args = Array.prototype.slice.call(arguments, 1)\r\n  return function(){return f.apply(null, args)}\r\n}\r\n\r\nfunction copyObj(obj, target, overwrite) {\r\n  if (!target) { target = {} }\r\n  for (var prop in obj)\r\n    { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\r\n      { target[prop] = obj[prop] } }\r\n  return target\r\n}\r\n\r\nfunction countColumn(string, end, tabSize, startIndex, startValue) {\r\n  if (end == null) {\r\n    end = string.search(/[^\\s\\u00a0]/)\r\n    if (end == -1) { end = string.length }\r\n  }\r\n  for (var i = startIndex || 0, n = startValue || 0;;) {\r\n    var nextTab = string.indexOf(\"\\t\", i)\r\n    if (nextTab < 0 || nextTab >= end)\r\n      { return n + (end - i) }\r\n    n += nextTab - i\r\n    n += tabSize - (n % tabSize)\r\n    i = nextTab + 1\r\n  }\r\n}\r\n\r\nvar Delayed = function() {this.id = null};\r\nDelayed.prototype.set = function (ms, f) {\r\n  clearTimeout(this.id)\r\n  this.id = setTimeout(f, ms)\r\n};\r\n\r\nfunction indexOf(array, elt) {\r\n  for (var i = 0; i < array.length; ++i)\r\n    { if (array[i] == elt) { return i } }\r\n  return -1\r\n}\r\n\r\nvar scrollerGap = 30\r\n\r\nvar Pass = {toString: function(){return \"CodeMirror.Pass\"}}\r\n\r\nvar sel_dontScroll = {scroll: false};\r\nvar sel_mouse = {origin: \"*mouse\"};\r\nvar sel_move = {origin: \"+move\"};\r\nfunction findColumn(string, goal, tabSize) {\r\n  for (var pos = 0, col = 0;;) {\r\n    var nextTab = string.indexOf(\"\\t\", pos)\r\n    if (nextTab == -1) { nextTab = string.length }\r\n    var skipped = nextTab - pos\r\n    if (nextTab == string.length || col + skipped >= goal)\r\n      { return pos + Math.min(skipped, goal - col) }\r\n    col += nextTab - pos\r\n    col += tabSize - (col % tabSize)\r\n    pos = nextTab + 1\r\n    if (col >= goal) { return pos }\r\n  }\r\n}\r\n\r\nvar spaceStrs = [\"\"]\r\nfunction spaceStr(n) {\r\n  while (spaceStrs.length <= n)\r\n    { spaceStrs.push(lst(spaceStrs) + \" \") }\r\n  return spaceStrs[n]\r\n}\r\n\r\nfunction lst(arr) { return arr[arr.length-1] }\r\n\r\nfunction map(array, f) {\r\n  var out = []\r\n  for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i) }\r\n  return out\r\n}\r\n\r\nfunction insertSorted(array, value, score) {\r\n  var pos = 0, priority = score(value)\r\n  while (pos < array.length && score(array[pos]) <= priority) { pos++ }\r\n  array.splice(pos, 0, value)\r\n}\r\n\r\nfunction nothing() {}\r\n\r\nfunction createObj(base, props) {\r\n  var inst\r\n  if (Object.create) {\r\n    inst = Object.create(base)\r\n  } else {\r\n    nothing.prototype = base\r\n    inst = new nothing()\r\n  }\r\n  if (props) { copyObj(props, inst) }\r\n  return inst\r\n}\r\n\r\nvar nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/\r\nfunction isWordCharBasic(ch) {\r\n  return /\\w/.test(ch) || ch > \"\\x80\" &&\r\n    (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\r\n}\r\nfunction isWordChar(ch, helper) {\r\n  if (!helper) { return isWordCharBasic(ch) }\r\n  if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\r\n  return helper.test(ch)\r\n}\r\n\r\nfunction isEmpty(obj) {\r\n  for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\r\n  return true\r\n}\r\n\r\nvar extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/\r\nfunction isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\r\n\r\nfunction skipExtendingChars(str, pos, dir) {\r\n  while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir }\r\n  return pos\r\n}\r\n\r\nfunction findFirst(pred, from, to) {\r\n  var dir = from > to ? -1 : 1\r\n  for (;;) {\r\n    if (from == to) { return from }\r\n    var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF)\r\n    if (mid == from) { return pred(mid) ? from : to }\r\n    if (pred(mid)) { to = mid }\r\n    else { from = mid + dir }\r\n  }\r\n}\r\n\r\n\r\nfunction Display(place, doc, input) {\r\n  var d = this\r\n  this.input = input\r\n\r\n  d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\")\r\n  d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\")\r\n  d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\")\r\n  d.gutterFiller.setAttribute(\"cm-not-content\", \"true\")\r\n  d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\")\r\n  d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\")\r\n  d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\")\r\n  d.measure = elt(\"div\", null, \"CodeMirror-measure\")\r\n  d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\")\r\n  d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\r\n                    null, \"position: relative; outline: none\")\r\n  var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\")\r\n  d.mover = elt(\"div\", [lines], null, \"position: relative\")\r\n  d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\")\r\n  d.sizerWidth = null\r\n  d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\")\r\n  d.gutters = elt(\"div\", null, \"CodeMirror-gutters\")\r\n  d.lineGutter = null\r\n  d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\")\r\n  d.scroller.setAttribute(\"tabIndex\", \"-1\")\r\n  d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\")\r\n\r\n  if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0 }\r\n  if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true }\r\n\r\n  if (place) {\r\n    if (place.appendChild) { place.appendChild(d.wrapper) }\r\n    else { place(d.wrapper) }\r\n  }\r\n\r\n  d.viewFrom = d.viewTo = doc.first\r\n  d.reportedViewFrom = d.reportedViewTo = doc.first\r\n  d.view = []\r\n  d.renderedView = null\r\n  d.externalMeasured = null\r\n  d.viewOffset = 0\r\n  d.lastWrapHeight = d.lastWrapWidth = 0\r\n  d.updateLineNumbers = null\r\n\r\n  d.nativeBarWidth = d.barHeight = d.barWidth = 0\r\n  d.scrollbarsClipped = false\r\n\r\n  d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null\r\n  d.alignWidgets = false\r\n\r\n  d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null\r\n\r\n  d.maxLine = null\r\n  d.maxLineLength = 0\r\n  d.maxLineChanged = false\r\n\r\n  d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null\r\n\r\n  d.shift = false\r\n\r\n  d.selForContextMenu = null\r\n\r\n  d.activeTouch = null\r\n\r\n  input.init(d)\r\n}\r\n\r\nfunction getLine(doc, n) {\r\n  n -= doc.first\r\n  if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\r\n  var chunk = doc\r\n  while (!chunk.lines) {\r\n    for (var i = 0;; ++i) {\r\n      var child = chunk.children[i], sz = child.chunkSize()\r\n      if (n < sz) { chunk = child; break }\r\n      n -= sz\r\n    }\r\n  }\r\n  return chunk.lines[n]\r\n}\r\n\r\nfunction getBetween(doc, start, end) {\r\n  var out = [], n = start.line\r\n  doc.iter(start.line, end.line + 1, function (line) {\r\n    var text = line.text\r\n    if (n == end.line) { text = text.slice(0, end.ch) }\r\n    if (n == start.line) { text = text.slice(start.ch) }\r\n    out.push(text)\r\n    ++n\r\n  })\r\n  return out\r\n}\r\nfunction getLines(doc, from, to) {\r\n  var out = []\r\n  doc.iter(from, to, function (line) { out.push(line.text) }) \r\n  return out\r\n}\r\n\r\nfunction updateLineHeight(line, height) {\r\n  var diff = height - line.height\r\n  if (diff) { for (var n = line; n; n = n.parent) { n.height += diff } }\r\n}\r\n\r\nfunction lineNo(line) {\r\n  if (line.parent == null) { return null }\r\n  var cur = line.parent, no = indexOf(cur.lines, line)\r\n  for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\r\n    for (var i = 0;; ++i) {\r\n      if (chunk.children[i] == cur) { break }\r\n      no += chunk.children[i].chunkSize()\r\n    }\r\n  }\r\n  return no + cur.first\r\n}\r\n\r\nfunction lineAtHeight(chunk, h) {\r\n  var n = chunk.first\r\n  outer: do {\r\n    for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\r\n      var child = chunk.children[i$1], ch = child.height\r\n      if (h < ch) { chunk = child; continue outer }\r\n      h -= ch\r\n      n += child.chunkSize()\r\n    }\r\n    return n\r\n  } while (!chunk.lines)\r\n  var i = 0\r\n  for (; i < chunk.lines.length; ++i) {\r\n    var line = chunk.lines[i], lh = line.height\r\n    if (h < lh) { break }\r\n    h -= lh\r\n  }\r\n  return n + i\r\n}\r\n\r\nfunction isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\r\n\r\nfunction lineNumberFor(options, i) {\r\n  return String(options.lineNumberFormatter(i + options.firstLineNumber))\r\n}\r\n\r\nfunction Pos(line, ch, sticky) {\r\n  if ( sticky === void 0 ) sticky = null;\r\n\r\n  if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\r\n  this.line = line\r\n  this.ch = ch\r\n  this.sticky = sticky\r\n}\r\n\r\nfunction cmp(a, b) { return a.line - b.line || a.ch - b.ch }\r\n\r\nfunction equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\r\n\r\nfunction copyPos(x) {return Pos(x.line, x.ch)}\r\nfunction maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\r\nfunction minPos(a, b) { return cmp(a, b) < 0 ? a : b }\r\n\r\nfunction clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\r\nfunction clipPos(doc, pos) {\r\n  if (pos.line < doc.first) { return Pos(doc.first, 0) }\r\n  var last = doc.first + doc.size - 1\r\n  if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\r\n  return clipToLen(pos, getLine(doc, pos.line).text.length)\r\n}\r\nfunction clipToLen(pos, linelen) {\r\n  var ch = pos.ch\r\n  if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\r\n  else if (ch < 0) { return Pos(pos.line, 0) }\r\n  else { return pos }\r\n}\r\nfunction clipPosArray(doc, array) {\r\n  var out = []\r\n  for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]) }\r\n  return out\r\n}\r\n\r\nvar sawReadOnlySpans = false;\r\nvar sawCollapsedSpans = false;\r\nfunction seeReadOnlySpans() {\r\n  sawReadOnlySpans = true\r\n}\r\n\r\nfunction seeCollapsedSpans() {\r\n  sawCollapsedSpans = true\r\n}\r\n\r\n\r\nfunction MarkedSpan(marker, from, to) {\r\n  this.marker = marker\r\n  this.from = from; this.to = to\r\n}\r\n\r\nfunction getMarkedSpanFor(spans, marker) {\r\n  if (spans) { for (var i = 0; i < spans.length; ++i) {\r\n    var span = spans[i]\r\n    if (span.marker == marker) { return span }\r\n  } }\r\n}\r\nfunction removeMarkedSpan(spans, span) {\r\n  var r\r\n  for (var i = 0; i < spans.length; ++i)\r\n    { if (spans[i] != span) { (r || (r = [])).push(spans[i]) } }\r\n  return r\r\n}\r\nfunction addMarkedSpan(line, span) {\r\n  line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span]\r\n  span.marker.attachLine(line)\r\n}\r\n\r\nfunction markedSpansBefore(old, startCh, isInsert) {\r\n  var nw\r\n  if (old) { for (var i = 0; i < old.length; ++i) {\r\n    var span = old[i], marker = span.marker\r\n    var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh)\r\n    if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\r\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh)\r\n      ;(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to))\r\n    }\r\n  } }\r\n  return nw\r\n}\r\nfunction markedSpansAfter(old, endCh, isInsert) {\r\n  var nw\r\n  if (old) { for (var i = 0; i < old.length; ++i) {\r\n    var span = old[i], marker = span.marker\r\n    var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh)\r\n    if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\r\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh)\r\n      ;(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\r\n                                            span.to == null ? null : span.to - endCh))\r\n    }\r\n  } }\r\n  return nw\r\n}\r\n\r\nfunction stretchSpansOverChange(doc, change) {\r\n  if (change.full) { return null }\r\n  var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans\r\n  var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans\r\n  if (!oldFirst && !oldLast) { return null }\r\n\r\n  var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0\r\n  var first = markedSpansBefore(oldFirst, startCh, isInsert)\r\n  var last = markedSpansAfter(oldLast, endCh, isInsert)\r\n\r\n  var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0)\r\n  if (first) {\r\n    for (var i = 0; i < first.length; ++i) {\r\n      var span = first[i]\r\n      if (span.to == null) {\r\n        var found = getMarkedSpanFor(last, span.marker)\r\n        if (!found) { span.to = startCh }\r\n        else if (sameLine) { span.to = found.to == null ? null : found.to + offset }\r\n      }\r\n    }\r\n  }\r\n  if (last) {\r\n    for (var i$1 = 0; i$1 < last.length; ++i$1) {\r\n      var span$1 = last[i$1]\r\n      if (span$1.to != null) { span$1.to += offset }\r\n      if (span$1.from == null) {\r\n        var found$1 = getMarkedSpanFor(first, span$1.marker)\r\n        if (!found$1) {\r\n          span$1.from = offset\r\n          if (sameLine) { (first || (first = [])).push(span$1) }\r\n        }\r\n      } else {\r\n        span$1.from += offset\r\n        if (sameLine) { (first || (first = [])).push(span$1) }\r\n      }\r\n    }\r\n  }\r\n  if (first) { first = clearEmptySpans(first) }\r\n  if (last && last != first) { last = clearEmptySpans(last) }\r\n\r\n  var newMarkers = [first]\r\n  if (!sameLine) {\r\n    var gap = change.text.length - 2, gapMarkers\r\n    if (gap > 0 && first)\r\n      { for (var i$2 = 0; i$2 < first.length; ++i$2)\r\n        { if (first[i$2].to == null)\r\n          { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)) } } }\r\n    for (var i$3 = 0; i$3 < gap; ++i$3)\r\n      { newMarkers.push(gapMarkers) }\r\n    newMarkers.push(last)\r\n  }\r\n  return newMarkers\r\n}\r\n\r\nfunction clearEmptySpans(spans) {\r\n  for (var i = 0; i < spans.length; ++i) {\r\n    var span = spans[i]\r\n    if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\r\n      { spans.splice(i--, 1) }\r\n  }\r\n  if (!spans.length) { return null }\r\n  return spans\r\n}\r\n\r\nfunction removeReadOnlyRanges(doc, from, to) {\r\n  var markers = null\r\n  doc.iter(from.line, to.line + 1, function (line) {\r\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\r\n      var mark = line.markedSpans[i].marker\r\n      if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\r\n        { (markers || (markers = [])).push(mark) }\r\n    } }\r\n  })\r\n  if (!markers) { return null }\r\n  var parts = [{from: from, to: to}]\r\n  for (var i = 0; i < markers.length; ++i) {\r\n    var mk = markers[i], m = mk.find(0)\r\n    for (var j = 0; j < parts.length; ++j) {\r\n      var p = parts[j]\r\n      if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\r\n      var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to)\r\n      if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\r\n        { newParts.push({from: p.from, to: m.from}) }\r\n      if (dto > 0 || !mk.inclusiveRight && !dto)\r\n        { newParts.push({from: m.to, to: p.to}) }\r\n      parts.splice.apply(parts, newParts)\r\n      j += newParts.length - 3\r\n    }\r\n  }\r\n  return parts\r\n}\r\n\r\nfunction detachMarkedSpans(line) {\r\n  var spans = line.markedSpans\r\n  if (!spans) { return }\r\n  for (var i = 0; i < spans.length; ++i)\r\n    { spans[i].marker.detachLine(line) }\r\n  line.markedSpans = null\r\n}\r\nfunction attachMarkedSpans(line, spans) {\r\n  if (!spans) { return }\r\n  for (var i = 0; i < spans.length; ++i)\r\n    { spans[i].marker.attachLine(line) }\r\n  line.markedSpans = spans\r\n}\r\n\r\nfunction extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\r\nfunction extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\r\n\r\nfunction compareCollapsedMarkers(a, b) {\r\n  var lenDiff = a.lines.length - b.lines.length\r\n  if (lenDiff != 0) { return lenDiff }\r\n  var aPos = a.find(), bPos = b.find()\r\n  var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b)\r\n  if (fromCmp) { return -fromCmp }\r\n  var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b)\r\n  if (toCmp) { return toCmp }\r\n  return b.id - a.id\r\n}\r\n\r\nfunction collapsedSpanAtSide(line, start) {\r\n  var sps = sawCollapsedSpans && line.markedSpans, found\r\n  if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\r\n    sp = sps[i]\r\n    if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\r\n        (!found || compareCollapsedMarkers(found, sp.marker) < 0))\r\n      { found = sp.marker }\r\n  } }\r\n  return found\r\n}\r\nfunction collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\r\nfunction collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\r\n\r\nfunction conflictingCollapsedRange(doc, lineNo, from, to, marker) {\r\n  var line = getLine(doc, lineNo)\r\n  var sps = sawCollapsedSpans && line.markedSpans\r\n  if (sps) { for (var i = 0; i < sps.length; ++i) {\r\n    var sp = sps[i]\r\n    if (!sp.marker.collapsed) { continue }\r\n    var found = sp.marker.find(0)\r\n    var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker)\r\n    var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker)\r\n    if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\r\n    if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\r\n        fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\r\n      { return true }\r\n  } }\r\n}\r\n\r\nfunction visualLine(line) {\r\n  var merged\r\n  while (merged = collapsedSpanAtStart(line))\r\n    { line = merged.find(-1, true).line }\r\n  return line\r\n}\r\n\r\nfunction visualLineEnd(line) {\r\n  var merged\r\n  while (merged = collapsedSpanAtEnd(line))\r\n    { line = merged.find(1, true).line }\r\n  return line\r\n}\r\n\r\nfunction visualLineContinued(line) {\r\n  var merged, lines\r\n  while (merged = collapsedSpanAtEnd(line)) {\r\n    line = merged.find(1, true).line\r\n    ;(lines || (lines = [])).push(line)\r\n  }\r\n  return lines\r\n}\r\n\r\nfunction visualLineNo(doc, lineN) {\r\n  var line = getLine(doc, lineN), vis = visualLine(line)\r\n  if (line == vis) { return lineN }\r\n  return lineNo(vis)\r\n}\r\n\r\nfunction visualLineEndNo(doc, lineN) {\r\n  if (lineN > doc.lastLine()) { return lineN }\r\n  var line = getLine(doc, lineN), merged\r\n  if (!lineIsHidden(doc, line)) { return lineN }\r\n  while (merged = collapsedSpanAtEnd(line))\r\n    { line = merged.find(1, true).line }\r\n  return lineNo(line) + 1\r\n}\r\n\r\nfunction lineIsHidden(doc, line) {\r\n  var sps = sawCollapsedSpans && line.markedSpans\r\n  if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\r\n    sp = sps[i]\r\n    if (!sp.marker.collapsed) { continue }\r\n    if (sp.from == null) { return true }\r\n    if (sp.marker.widgetNode) { continue }\r\n    if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\r\n      { return true }\r\n  } }\r\n}\r\nfunction lineIsHiddenInner(doc, line, span) {\r\n  if (span.to == null) {\r\n    var end = span.marker.find(1, true)\r\n    return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\r\n  }\r\n  if (span.marker.inclusiveRight && span.to == line.text.length)\r\n    { return true }\r\n  for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\r\n    sp = line.markedSpans[i]\r\n    if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\r\n        (sp.to == null || sp.to != span.from) &&\r\n        (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\r\n        lineIsHiddenInner(doc, line, sp)) { return true }\r\n  }\r\n}\r\n\r\nfunction heightAtLine(lineObj) {\r\n  lineObj = visualLine(lineObj)\r\n\r\n  var h = 0, chunk = lineObj.parent\r\n  for (var i = 0; i < chunk.lines.length; ++i) {\r\n    var line = chunk.lines[i]\r\n    if (line == lineObj) { break }\r\n    else { h += line.height }\r\n  }\r\n  for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\r\n    for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\r\n      var cur = p.children[i$1]\r\n      if (cur == chunk) { break }\r\n      else { h += cur.height }\r\n    }\r\n  }\r\n  return h\r\n}\r\n\r\nfunction lineLength(line) {\r\n  if (line.height == 0) { return 0 }\r\n  var len = line.text.length, merged, cur = line\r\n  while (merged = collapsedSpanAtStart(cur)) {\r\n    var found = merged.find(0, true)\r\n    cur = found.from.line\r\n    len += found.from.ch - found.to.ch\r\n  }\r\n  cur = line\r\n  while (merged = collapsedSpanAtEnd(cur)) {\r\n    var found$1 = merged.find(0, true)\r\n    len -= cur.text.length - found$1.from.ch\r\n    cur = found$1.to.line\r\n    len += cur.text.length - found$1.to.ch\r\n  }\r\n  return len\r\n}\r\n\r\nfunction findMaxLine(cm) {\r\n  var d = cm.display, doc = cm.doc\r\n  d.maxLine = getLine(doc, doc.first)\r\n  d.maxLineLength = lineLength(d.maxLine)\r\n  d.maxLineChanged = true\r\n  doc.iter(function (line) {\r\n    var len = lineLength(line)\r\n    if (len > d.maxLineLength) {\r\n      d.maxLineLength = len\r\n      d.maxLine = line\r\n    }\r\n  })\r\n}\r\n\r\n\r\nfunction iterateBidiSections(order, from, to, f) {\r\n  if (!order) { return f(from, to, \"ltr\", 0) }\r\n  var found = false\r\n  for (var i = 0; i < order.length; ++i) {\r\n    var part = order[i]\r\n    if (part.from < to && part.to > from || from == to && part.to == from) {\r\n      f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i)\r\n      found = true\r\n    }\r\n  }\r\n  if (!found) { f(from, to, \"ltr\") }\r\n}\r\n\r\nvar bidiOther = null\r\nfunction getBidiPartAt(order, ch, sticky) {\r\n  var found\r\n  bidiOther = null\r\n  for (var i = 0; i < order.length; ++i) {\r\n    var cur = order[i]\r\n    if (cur.from < ch && cur.to > ch) { return i }\r\n    if (cur.to == ch) {\r\n      if (cur.from != cur.to && sticky == \"before\") { found = i }\r\n      else { bidiOther = i }\r\n    }\r\n    if (cur.from == ch) {\r\n      if (cur.from != cur.to && sticky != \"before\") { found = i }\r\n      else { bidiOther = i }\r\n    }\r\n  }\r\n  return found != null ? found : bidiOther\r\n}\r\n\r\n\r\n\r\nvar bidiOrdering = (function() {\r\n  var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\"\r\n  var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\"\r\n  function charType(code) {\r\n    if (code <= 0xf7) { return lowTypes.charAt(code) }\r\n    else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\r\n    else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\r\n    else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\r\n    else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\r\n    else if (code == 0x200c) { return \"b\" }\r\n    else { return \"L\" }\r\n  }\r\n\r\n  var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/\r\n  var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/\r\n\r\n  function BidiSpan(level, from, to) {\r\n    this.level = level\r\n    this.from = from; this.to = to\r\n  }\r\n\r\n  return function(str, direction) {\r\n    var outerType = direction == \"ltr\" ? \"L\" : \"R\"\r\n\r\n    if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\r\n    var len = str.length, types = []\r\n    for (var i = 0; i < len; ++i)\r\n      { types.push(charType(str.charCodeAt(i))) }\r\n\r\n    for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\r\n      var type = types[i$1]\r\n      if (type == \"m\") { types[i$1] = prev }\r\n      else { prev = type }\r\n    }\r\n\r\n    for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\r\n      var type$1 = types[i$2]\r\n      if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\" }\r\n      else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\" } }\r\n    }\r\n\r\n    for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\r\n      var type$2 = types[i$3]\r\n      if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\" }\r\n      else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\r\n               (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1 }\r\n      prev$1 = type$2\r\n    }\r\n\r\n    for (var i$4 = 0; i$4 < len; ++i$4) {\r\n      var type$3 = types[i$4]\r\n      if (type$3 == \",\") { types[i$4] = \"N\" }\r\n      else if (type$3 == \"%\") {\r\n        var end = (void 0)\r\n        for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\r\n        var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\"\r\n        for (var j = i$4; j < end; ++j) { types[j] = replace }\r\n        i$4 = end - 1\r\n      }\r\n    }\r\n\r\n    for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\r\n      var type$4 = types[i$5]\r\n      if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\" }\r\n      else if (isStrong.test(type$4)) { cur$1 = type$4 }\r\n    }\r\n\r\n    for (var i$6 = 0; i$6 < len; ++i$6) {\r\n      if (isNeutral.test(types[i$6])) {\r\n        var end$1 = (void 0)\r\n        for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\r\n        var before = (i$6 ? types[i$6-1] : outerType) == \"L\"\r\n        var after = (end$1 < len ? types[end$1] : outerType) == \"L\"\r\n        var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType\r\n        for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1 }\r\n        i$6 = end$1 - 1\r\n      }\r\n    }\r\n\r\n    var order = [], m\r\n    for (var i$7 = 0; i$7 < len;) {\r\n      if (countsAsLeft.test(types[i$7])) {\r\n        var start = i$7\r\n        for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\r\n        order.push(new BidiSpan(0, start, i$7))\r\n      } else {\r\n        var pos = i$7, at = order.length\r\n        for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\r\n        for (var j$2 = pos; j$2 < i$7;) {\r\n          if (countsAsNum.test(types[j$2])) {\r\n            if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)) }\r\n            var nstart = j$2\r\n            for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\r\n            order.splice(at, 0, new BidiSpan(2, nstart, j$2))\r\n            pos = j$2\r\n          } else { ++j$2 }\r\n        }\r\n        if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)) }\r\n      }\r\n    }\r\n    if (direction == \"ltr\") {\r\n      if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\r\n        order[0].from = m[0].length\r\n        order.unshift(new BidiSpan(0, 0, m[0].length))\r\n      }\r\n      if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\r\n        lst(order).to -= m[0].length\r\n        order.push(new BidiSpan(0, len - m[0].length, len))\r\n      }\r\n    }\r\n\r\n    return direction == \"rtl\" ? order.reverse() : order\r\n  }\r\n})()\r\n\r\nfunction getOrder(line, direction) {\r\n  var order = line.order\r\n  if (order == null) { order = line.order = bidiOrdering(line.text, direction) }\r\n  return order\r\n}\r\n\r\n\r\n\r\nvar noHandlers = []\r\n\r\nvar on = function(emitter, type, f) {\r\n  if (emitter.addEventListener) {\r\n    emitter.addEventListener(type, f, false)\r\n  } else if (emitter.attachEvent) {\r\n    emitter.attachEvent(\"on\" + type, f)\r\n  } else {\r\n    var map = emitter._handlers || (emitter._handlers = {})\r\n    map[type] = (map[type] || noHandlers).concat(f)\r\n  }\r\n}\r\n\r\nfunction getHandlers(emitter, type) {\r\n  return emitter._handlers && emitter._handlers[type] || noHandlers\r\n}\r\n\r\nfunction off(emitter, type, f) {\r\n  if (emitter.removeEventListener) {\r\n    emitter.removeEventListener(type, f, false)\r\n  } else if (emitter.detachEvent) {\r\n    emitter.detachEvent(\"on\" + type, f)\r\n  } else {\r\n    var map = emitter._handlers, arr = map && map[type]\r\n    if (arr) {\r\n      var index = indexOf(arr, f)\r\n      if (index > -1)\r\n        { map[type] = arr.slice(0, index).concat(arr.slice(index + 1)) }\r\n    }\r\n  }\r\n}\r\n\r\nfunction signal(emitter, type ) {\r\n  var handlers = getHandlers(emitter, type)\r\n  if (!handlers.length) { return }\r\n  var args = Array.prototype.slice.call(arguments, 2)\r\n  for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args) }\r\n}\r\n\r\nfunction signalDOMEvent(cm, e, override) {\r\n  if (typeof e == \"string\")\r\n    { e = {type: e, preventDefault: function() { this.defaultPrevented = true }} }\r\n  signal(cm, override || e.type, cm, e)\r\n  return e_defaultPrevented(e) || e.codemirrorIgnore\r\n}\r\n\r\nfunction signalCursorActivity(cm) {\r\n  var arr = cm._handlers && cm._handlers.cursorActivity\r\n  if (!arr) { return }\r\n  var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = [])\r\n  for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\r\n    { set.push(arr[i]) } }\r\n}\r\n\r\nfunction hasHandler(emitter, type) {\r\n  return getHandlers(emitter, type).length > 0\r\n}\r\n\r\nfunction eventMixin(ctor) {\r\n  ctor.prototype.on = function(type, f) {on(this, type, f)}\r\n  ctor.prototype.off = function(type, f) {off(this, type, f)}\r\n}\r\n\r\n\r\nfunction e_preventDefault(e) {\r\n  if (e.preventDefault) { e.preventDefault() }\r\n  else { e.returnValue = false }\r\n}\r\nfunction e_stopPropagation(e) {\r\n  if (e.stopPropagation) { e.stopPropagation() }\r\n  else { e.cancelBubble = true }\r\n}\r\nfunction e_defaultPrevented(e) {\r\n  return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\r\n}\r\nfunction e_stop(e) {e_preventDefault(e); e_stopPropagation(e)}\r\n\r\nfunction e_target(e) {return e.target || e.srcElement}\r\nfunction e_button(e) {\r\n  var b = e.which\r\n  if (b == null) {\r\n    if (e.button & 1) { b = 1 }\r\n    else if (e.button & 2) { b = 3 }\r\n    else if (e.button & 4) { b = 2 }\r\n  }\r\n  if (mac && e.ctrlKey && b == 1) { b = 3 }\r\n  return b\r\n}\r\n\r\nvar dragAndDrop = function() {\r\n  if (ie && ie_version < 9) { return false }\r\n  var div = elt('div')\r\n  return \"draggable\" in div || \"dragDrop\" in div\r\n}()\r\n\r\nvar zwspSupported\r\nfunction zeroWidthElement(measure) {\r\n  if (zwspSupported == null) {\r\n    var test = elt(\"span\", \"\\u200b\")\r\n    removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]))\r\n    if (measure.firstChild.offsetHeight != 0)\r\n      { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8) }\r\n  }\r\n  var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\r\n    elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\")\r\n  node.setAttribute(\"cm-text\", \"\")\r\n  return node\r\n}\r\n\r\nvar badBidiRects\r\nfunction hasBadBidiRects(measure) {\r\n  if (badBidiRects != null) { return badBidiRects }\r\n  var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"))\r\n  var r0 = range(txt, 0, 1).getBoundingClientRect()\r\n  var r1 = range(txt, 1, 2).getBoundingClientRect()\r\n  removeChildren(measure)\r\n  if (!r0 || r0.left == r0.right) { return false } \r\n  return badBidiRects = (r1.right - r0.right < 3)\r\n}\r\n\r\nvar splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\r\n  var pos = 0, result = [], l = string.length\r\n  while (pos <= l) {\r\n    var nl = string.indexOf(\"\\n\", pos)\r\n    if (nl == -1) { nl = string.length }\r\n    var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl)\r\n    var rt = line.indexOf(\"\\r\")\r\n    if (rt != -1) {\r\n      result.push(line.slice(0, rt))\r\n      pos += rt + 1\r\n    } else {\r\n      result.push(line)\r\n      pos = nl + 1\r\n    }\r\n  }\r\n  return result\r\n} : function (string) { return string.split(/\\r\\n?|\\n/); }\r\n\r\nvar hasSelection = window.getSelection ? function (te) {\r\n  try { return te.selectionStart != te.selectionEnd }\r\n  catch(e) { return false }\r\n} : function (te) {\r\n  var range\r\n  try {range = te.ownerDocument.selection.createRange()}\r\n  catch(e) {}\r\n  if (!range || range.parentElement() != te) { return false }\r\n  return range.compareEndPoints(\"StartToEnd\", range) != 0\r\n}\r\n\r\nvar hasCopyEvent = (function () {\r\n  var e = elt(\"div\")\r\n  if (\"oncopy\" in e) { return true }\r\n  e.setAttribute(\"oncopy\", \"return;\")\r\n  return typeof e.oncopy == \"function\"\r\n})()\r\n\r\nvar badZoomedRects = null\r\nfunction hasBadZoomedRects(measure) {\r\n  if (badZoomedRects != null) { return badZoomedRects }\r\n  var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"))\r\n  var normal = node.getBoundingClientRect()\r\n  var fromRange = range(node, 0, 1).getBoundingClientRect()\r\n  return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\r\n}\r\n\r\nvar modes = {};\r\nvar mimeModes = {};\r\nfunction defineMode(name, mode) {\r\n  if (arguments.length > 2)\r\n    { mode.dependencies = Array.prototype.slice.call(arguments, 2) }\r\n  modes[name] = mode\r\n}\r\n\r\nfunction defineMIME(mime, spec) {\r\n  mimeModes[mime] = spec\r\n}\r\n\r\nfunction resolveMode(spec) {\r\n  if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\r\n    spec = mimeModes[spec]\r\n  } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\r\n    var found = mimeModes[spec.name]\r\n    if (typeof found == \"string\") { found = {name: found} }\r\n    spec = createObj(found, spec)\r\n    spec.name = found.name\r\n  } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\r\n    return resolveMode(\"application/xml\")\r\n  } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\r\n    return resolveMode(\"application/json\")\r\n  }\r\n  if (typeof spec == \"string\") { return {name: spec} }\r\n  else { return spec || {name: \"null\"} }\r\n}\r\n\r\nfunction getMode(options, spec) {\r\n  spec = resolveMode(spec)\r\n  var mfactory = modes[spec.name]\r\n  if (!mfactory) { return getMode(options, \"text/plain\") }\r\n  var modeObj = mfactory(options, spec)\r\n  if (modeExtensions.hasOwnProperty(spec.name)) {\r\n    var exts = modeExtensions[spec.name]\r\n    for (var prop in exts) {\r\n      if (!exts.hasOwnProperty(prop)) { continue }\r\n      if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop] }\r\n      modeObj[prop] = exts[prop]\r\n    }\r\n  }\r\n  modeObj.name = spec.name\r\n  if (spec.helperType) { modeObj.helperType = spec.helperType }\r\n  if (spec.modeProps) { for (var prop$1 in spec.modeProps)\r\n    { modeObj[prop$1] = spec.modeProps[prop$1] } }\r\n\r\n  return modeObj\r\n}\r\n\r\nvar modeExtensions = {}\r\nfunction extendMode(mode, properties) {\r\n  var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {})\r\n  copyObj(properties, exts)\r\n}\r\n\r\nfunction copyState(mode, state) {\r\n  if (state === true) { return state }\r\n  if (mode.copyState) { return mode.copyState(state) }\r\n  var nstate = {}\r\n  for (var n in state) {\r\n    var val = state[n]\r\n    if (val instanceof Array) { val = val.concat([]) }\r\n    nstate[n] = val\r\n  }\r\n  return nstate\r\n}\r\n\r\nfunction innerMode(mode, state) {\r\n  var info\r\n  while (mode.innerMode) {\r\n    info = mode.innerMode(state)\r\n    if (!info || info.mode == mode) { break }\r\n    state = info.state\r\n    mode = info.mode\r\n  }\r\n  return info || {mode: mode, state: state}\r\n}\r\n\r\nfunction startState(mode, a1, a2) {\r\n  return mode.startState ? mode.startState(a1, a2) : true\r\n}\r\n\r\n\r\n\r\nvar StringStream = function(string, tabSize, lineOracle) {\r\n  this.pos = this.start = 0\r\n  this.string = string\r\n  this.tabSize = tabSize || 8\r\n  this.lastColumnPos = this.lastColumnValue = 0\r\n  this.lineStart = 0\r\n  this.lineOracle = lineOracle\r\n};\r\n\r\nStringStream.prototype.eol = function () {return this.pos >= this.string.length};\r\nStringStream.prototype.sol = function () {return this.pos == this.lineStart};\r\nStringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\r\nStringStream.prototype.next = function () {\r\n  if (this.pos < this.string.length)\r\n    { return this.string.charAt(this.pos++) }\r\n};\r\nStringStream.prototype.eat = function (match) {\r\n  var ch = this.string.charAt(this.pos)\r\n  var ok\r\n  if (typeof match == \"string\") { ok = ch == match }\r\n  else { ok = ch && (match.test ? match.test(ch) : match(ch)) }\r\n  if (ok) {++this.pos; return ch}\r\n};\r\nStringStream.prototype.eatWhile = function (match) {\r\n  var start = this.pos\r\n  while (this.eat(match)){}\r\n  return this.pos > start\r\n};\r\nStringStream.prototype.eatSpace = function () {\r\n    var this$1 = this;\r\n\r\n  var start = this.pos\r\n  while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this$1.pos }\r\n  return this.pos > start\r\n};\r\nStringStream.prototype.skipToEnd = function () {this.pos = this.string.length};\r\nStringStream.prototype.skipTo = function (ch) {\r\n  var found = this.string.indexOf(ch, this.pos)\r\n  if (found > -1) {this.pos = found; return true}\r\n};\r\nStringStream.prototype.backUp = function (n) {this.pos -= n};\r\nStringStream.prototype.column = function () {\r\n  if (this.lastColumnPos < this.start) {\r\n    this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue)\r\n    this.lastColumnPos = this.start\r\n  }\r\n  return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\r\n};\r\nStringStream.prototype.indentation = function () {\r\n  return countColumn(this.string, null, this.tabSize) -\r\n    (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\r\n};\r\nStringStream.prototype.match = function (pattern, consume, caseInsensitive) {\r\n  if (typeof pattern == \"string\") {\r\n    var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; }\r\n    var substr = this.string.substr(this.pos, pattern.length)\r\n    if (cased(substr) == cased(pattern)) {\r\n      if (consume !== false) { this.pos += pattern.length }\r\n      return true\r\n    }\r\n  } else {\r\n    var match = this.string.slice(this.pos).match(pattern)\r\n    if (match && match.index > 0) { return null }\r\n    if (match && consume !== false) { this.pos += match[0].length }\r\n    return match\r\n  }\r\n};\r\nStringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\r\nStringStream.prototype.hideFirstChars = function (n, inner) {\r\n  this.lineStart += n\r\n  try { return inner() }\r\n  finally { this.lineStart -= n }\r\n};\r\nStringStream.prototype.lookAhead = function (n) {\r\n  var oracle = this.lineOracle\r\n  return oracle && oracle.lookAhead(n)\r\n};\r\nStringStream.prototype.baseToken = function () {\r\n  var oracle = this.lineOracle\r\n  return oracle && oracle.baseToken(this.pos)\r\n};\r\n\r\nvar SavedContext = function(state, lookAhead) {\r\n  this.state = state\r\n  this.lookAhead = lookAhead\r\n};\r\n\r\nvar Context = function(doc, state, line, lookAhead) {\r\n  this.state = state\r\n  this.doc = doc\r\n  this.line = line\r\n  this.maxLookAhead = lookAhead || 0\r\n  this.baseTokens = null\r\n  this.baseTokenPos = 1\r\n};\r\n\r\nContext.prototype.lookAhead = function (n) {\r\n  var line = this.doc.getLine(this.line + n)\r\n  if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n }\r\n  return line\r\n};\r\n\r\nContext.prototype.baseToken = function (n) {\r\n    var this$1 = this;\r\n\r\n  if (!this.baseTokens) { return null }\r\n  while (this.baseTokens[this.baseTokenPos] <= n)\r\n    { this$1.baseTokenPos += 2 }\r\n  var type = this.baseTokens[this.baseTokenPos + 1]\r\n  return {type: type && type.replace(/( |^)overlay .*/, \"\"),\r\n          size: this.baseTokens[this.baseTokenPos] - n}\r\n};\r\n\r\nContext.prototype.nextLine = function () {\r\n  this.line++\r\n  if (this.maxLookAhead > 0) { this.maxLookAhead-- }\r\n};\r\n\r\nContext.fromSaved = function (doc, saved, line) {\r\n  if (saved instanceof SavedContext)\r\n    { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\r\n  else\r\n    { return new Context(doc, copyState(doc.mode, saved), line) }\r\n};\r\n\r\nContext.prototype.save = function (copy) {\r\n  var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state\r\n  return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\r\n};\r\n\r\n\r\nfunction highlightLine(cm, line, context, forceToEnd) {\r\n  var st = [cm.state.modeGen], lineClasses = {}\r\n  runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\r\n          lineClasses, forceToEnd)\r\n  var state = context.state\r\n\r\n  var loop = function ( o ) {\r\n    context.baseTokens = st\r\n    var overlay = cm.state.overlays[o], i = 1, at = 0\r\n    context.state = true\r\n    runMode(cm, line.text, overlay.mode, context, function (end, style) {\r\n      var start = i\r\n      while (at < end) {\r\n        var i_end = st[i]\r\n        if (i_end > end)\r\n          { st.splice(i, 1, end, st[i+1], i_end) }\r\n        i += 2\r\n        at = Math.min(end, i_end)\r\n      }\r\n      if (!style) { return }\r\n      if (overlay.opaque) {\r\n        st.splice(start, i - start, end, \"overlay \" + style)\r\n        i = start + 2\r\n      } else {\r\n        for (; start < i; start += 2) {\r\n          var cur = st[start+1]\r\n          st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style\r\n        }\r\n      }\r\n    }, lineClasses)\r\n    context.state = state\r\n    context.baseTokens = null\r\n    context.baseTokenPos = 1\r\n  };\r\n\r\n  for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\r\n\r\n  return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\r\n}\r\n\r\nfunction getLineStyles(cm, line, updateFrontier) {\r\n  if (!line.styles || line.styles[0] != cm.state.modeGen) {\r\n    var context = getContextBefore(cm, lineNo(line))\r\n    var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state)\r\n    var result = highlightLine(cm, line, context)\r\n    if (resetState) { context.state = resetState }\r\n    line.stateAfter = context.save(!resetState)\r\n    line.styles = result.styles\r\n    if (result.classes) { line.styleClasses = result.classes }\r\n    else if (line.styleClasses) { line.styleClasses = null }\r\n    if (updateFrontier === cm.doc.highlightFrontier)\r\n      { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier) }\r\n  }\r\n  return line.styles\r\n}\r\n\r\nfunction getContextBefore(cm, n, precise) {\r\n  var doc = cm.doc, display = cm.display\r\n  if (!doc.mode.startState) { return new Context(doc, true, n) }\r\n  var start = findStartLine(cm, n, precise)\r\n  var saved = start > doc.first && getLine(doc, start - 1).stateAfter\r\n  var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start)\r\n\r\n  doc.iter(start, n, function (line) {\r\n    processLine(cm, line.text, context)\r\n    var pos = context.line\r\n    line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null\r\n    context.nextLine()\r\n  })\r\n  if (precise) { doc.modeFrontier = context.line }\r\n  return context\r\n}\r\n\r\nfunction processLine(cm, text, context, startAt) {\r\n  var mode = cm.doc.mode\r\n  var stream = new StringStream(text, cm.options.tabSize, context)\r\n  stream.start = stream.pos = startAt || 0\r\n  if (text == \"\") { callBlankLine(mode, context.state) }\r\n  while (!stream.eol()) {\r\n    readToken(mode, stream, context.state)\r\n    stream.start = stream.pos\r\n  }\r\n}\r\n\r\nfunction callBlankLine(mode, state) {\r\n  if (mode.blankLine) { return mode.blankLine(state) }\r\n  if (!mode.innerMode) { return }\r\n  var inner = innerMode(mode, state)\r\n  if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\r\n}\r\n\r\nfunction readToken(mode, stream, state, inner) {\r\n  for (var i = 0; i < 10; i++) {\r\n    if (inner) { inner[0] = innerMode(mode, state).mode }\r\n    var style = mode.token(stream, state)\r\n    if (stream.pos > stream.start) { return style }\r\n  }\r\n  throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\r\n}\r\n\r\nvar Token = function(stream, type, state) {\r\n  this.start = stream.start; this.end = stream.pos\r\n  this.string = stream.current()\r\n  this.type = type || null\r\n  this.state = state\r\n};\r\n\r\nfunction takeToken(cm, pos, precise, asArray) {\r\n  var doc = cm.doc, mode = doc.mode, style\r\n  pos = clipPos(doc, pos)\r\n  var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise)\r\n  var stream = new StringStream(line.text, cm.options.tabSize, context), tokens\r\n  if (asArray) { tokens = [] }\r\n  while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\r\n    stream.start = stream.pos\r\n    style = readToken(mode, stream, context.state)\r\n    if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))) }\r\n  }\r\n  return asArray ? tokens : new Token(stream, style, context.state)\r\n}\r\n\r\nfunction extractLineClasses(type, output) {\r\n  if (type) { for (;;) {\r\n    var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/)\r\n    if (!lineClass) { break }\r\n    type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length)\r\n    var prop = lineClass[1] ? \"bgClass\" : \"textClass\"\r\n    if (output[prop] == null)\r\n      { output[prop] = lineClass[2] }\r\n    else if (!(new RegExp(\"(?:^|\\s)\" + lineClass[2] + \"(?:$|\\s)\")).test(output[prop]))\r\n      { output[prop] += \" \" + lineClass[2] }\r\n  } }\r\n  return type\r\n}\r\n\r\nfunction runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\r\n  var flattenSpans = mode.flattenSpans\r\n  if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans }\r\n  var curStart = 0, curStyle = null\r\n  var stream = new StringStream(text, cm.options.tabSize, context), style\r\n  var inner = cm.options.addModeClass && [null]\r\n  if (text == \"\") { extractLineClasses(callBlankLine(mode, context.state), lineClasses) }\r\n  while (!stream.eol()) {\r\n    if (stream.pos > cm.options.maxHighlightLength) {\r\n      flattenSpans = false\r\n      if (forceToEnd) { processLine(cm, text, context, stream.pos) }\r\n      stream.pos = text.length\r\n      style = null\r\n    } else {\r\n      style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses)\r\n    }\r\n    if (inner) {\r\n      var mName = inner[0].name\r\n      if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName) }\r\n    }\r\n    if (!flattenSpans || curStyle != style) {\r\n      while (curStart < stream.start) {\r\n        curStart = Math.min(stream.start, curStart + 5000)\r\n        f(curStart, curStyle)\r\n      }\r\n      curStyle = style\r\n    }\r\n    stream.start = stream.pos\r\n  }\r\n  while (curStart < stream.pos) {\r\n    var pos = Math.min(stream.pos, curStart + 5000)\r\n    f(pos, curStyle)\r\n    curStart = pos\r\n  }\r\n}\r\n\r\nfunction findStartLine(cm, n, precise) {\r\n  var minindent, minline, doc = cm.doc\r\n  var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100)\r\n  for (var search = n; search > lim; --search) {\r\n    if (search <= doc.first) { return doc.first }\r\n    var line = getLine(doc, search - 1), after = line.stateAfter\r\n    if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\r\n      { return search }\r\n    var indented = countColumn(line.text, null, cm.options.tabSize)\r\n    if (minline == null || minindent > indented) {\r\n      minline = search - 1\r\n      minindent = indented\r\n    }\r\n  }\r\n  return minline\r\n}\r\n\r\nfunction retreatFrontier(doc, n) {\r\n  doc.modeFrontier = Math.min(doc.modeFrontier, n)\r\n  if (doc.highlightFrontier < n - 10) { return }\r\n  var start = doc.first\r\n  for (var line = n - 1; line > start; line--) {\r\n    var saved = getLine(doc, line).stateAfter\r\n    if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\r\n      start = line + 1\r\n      break\r\n    }\r\n  }\r\n  doc.highlightFrontier = Math.min(doc.highlightFrontier, start)\r\n}\r\n\r\n\r\nvar Line = function(text, markedSpans, estimateHeight) {\r\n  this.text = text\r\n  attachMarkedSpans(this, markedSpans)\r\n  this.height = estimateHeight ? estimateHeight(this) : 1\r\n};\r\n\r\nLine.prototype.lineNo = function () { return lineNo(this) };\r\neventMixin(Line)\r\n\r\nfunction updateLine(line, text, markedSpans, estimateHeight) {\r\n  line.text = text\r\n  if (line.stateAfter) { line.stateAfter = null }\r\n  if (line.styles) { line.styles = null }\r\n  if (line.order != null) { line.order = null }\r\n  detachMarkedSpans(line)\r\n  attachMarkedSpans(line, markedSpans)\r\n  var estHeight = estimateHeight ? estimateHeight(line) : 1\r\n  if (estHeight != line.height) { updateLineHeight(line, estHeight) }\r\n}\r\n\r\nfunction cleanUpLine(line) {\r\n  line.parent = null\r\n  detachMarkedSpans(line)\r\n}\r\n\r\nvar styleToClassCache = {};\r\nvar styleToClassCacheWithMode = {};\r\nfunction interpretTokenStyle(style, options) {\r\n  if (!style || /^\\s*$/.test(style)) { return null }\r\n  var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache\r\n  return cache[style] ||\r\n    (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\r\n}\r\n\r\nfunction buildLineContent(cm, lineView) {\r\n  var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null)\r\n  var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\r\n                 col: 0, pos: 0, cm: cm,\r\n                 trailingSpace: false,\r\n                 splitSpaces: (ie || webkit) && cm.getOption(\"lineWrapping\")}\r\n  lineView.measure = {}\r\n\r\n  for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\r\n    var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0)\r\n    builder.pos = 0\r\n    builder.addToken = buildToken\r\n    if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\r\n      { builder.addToken = buildTokenBadBidi(builder.addToken, order) }\r\n    builder.map = []\r\n    var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line)\r\n    insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate))\r\n    if (line.styleClasses) {\r\n      if (line.styleClasses.bgClass)\r\n        { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\") }\r\n      if (line.styleClasses.textClass)\r\n        { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\") }\r\n    }\r\n\r\n    if (builder.map.length == 0)\r\n      { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))) }\r\n\r\n    if (i == 0) {\r\n      lineView.measure.map = builder.map\r\n      lineView.measure.cache = {}\r\n    } else {\r\n      ;(lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\r\n      ;(lineView.measure.caches || (lineView.measure.caches = [])).push({})\r\n    }\r\n  }\r\n\r\n  if (webkit) {\r\n    var last = builder.content.lastChild\r\n    if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\r\n      { builder.content.className = \"cm-tab-wrap-hack\" }\r\n  }\r\n\r\n  signal(cm, \"renderLine\", cm, lineView.line, builder.pre)\r\n  if (builder.pre.className)\r\n    { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\") }\r\n\r\n  return builder\r\n}\r\n\r\nfunction defaultSpecialCharPlaceholder(ch) {\r\n  var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\")\r\n  token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16)\r\n  token.setAttribute(\"aria-label\", token.title)\r\n  return token\r\n}\r\n\r\nfunction buildToken(builder, text, style, startStyle, endStyle, title, css) {\r\n  if (!text) { return }\r\n  var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text\r\n  var special = builder.cm.state.specialChars, mustWrap = false\r\n  var content\r\n  if (!special.test(text)) {\r\n    builder.col += text.length\r\n    content = document.createTextNode(displayText)\r\n    builder.map.push(builder.pos, builder.pos + text.length, content)\r\n    if (ie && ie_version < 9) { mustWrap = true }\r\n    builder.pos += text.length\r\n  } else {\r\n    content = document.createDocumentFragment()\r\n    var pos = 0\r\n    while (true) {\r\n      special.lastIndex = pos\r\n      var m = special.exec(text)\r\n      var skipped = m ? m.index - pos : text.length - pos\r\n      if (skipped) {\r\n        var txt = document.createTextNode(displayText.slice(pos, pos + skipped))\r\n        if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])) }\r\n        else { content.appendChild(txt) }\r\n        builder.map.push(builder.pos, builder.pos + skipped, txt)\r\n        builder.col += skipped\r\n        builder.pos += skipped\r\n      }\r\n      if (!m) { break }\r\n      pos += skipped + 1\r\n      var txt$1 = (void 0)\r\n      if (m[0] == \"\\t\") {\r\n        var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize\r\n        txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"))\r\n        txt$1.setAttribute(\"role\", \"presentation\")\r\n        txt$1.setAttribute(\"cm-text\", \"\\t\")\r\n        builder.col += tabWidth\r\n      } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\r\n        txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"))\r\n        txt$1.setAttribute(\"cm-text\", m[0])\r\n        builder.col += 1\r\n      } else {\r\n        txt$1 = builder.cm.options.specialCharPlaceholder(m[0])\r\n        txt$1.setAttribute(\"cm-text\", m[0])\r\n        if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])) }\r\n        else { content.appendChild(txt$1) }\r\n        builder.col += 1\r\n      }\r\n      builder.map.push(builder.pos, builder.pos + 1, txt$1)\r\n      builder.pos++\r\n    }\r\n  }\r\n  builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32\r\n  if (style || startStyle || endStyle || mustWrap || css) {\r\n    var fullStyle = style || \"\"\r\n    if (startStyle) { fullStyle += startStyle }\r\n    if (endStyle) { fullStyle += endStyle }\r\n    var token = elt(\"span\", [content], fullStyle, css)\r\n    if (title) { token.title = title }\r\n    return builder.content.appendChild(token)\r\n  }\r\n  builder.content.appendChild(content)\r\n}\r\n\r\nfunction splitSpaces(text, trailingBefore) {\r\n  if (text.length > 1 && !/  /.test(text)) { return text }\r\n  var spaceBefore = trailingBefore, result = \"\"\r\n  for (var i = 0; i < text.length; i++) {\r\n    var ch = text.charAt(i)\r\n    if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\r\n      { ch = \"\\u00a0\" }\r\n    result += ch\r\n    spaceBefore = ch == \" \"\r\n  }\r\n  return result\r\n}\r\n\r\nfunction buildTokenBadBidi(inner, order) {\r\n  return function (builder, text, style, startStyle, endStyle, title, css) {\r\n    style = style ? style + \" cm-force-border\" : \"cm-force-border\"\r\n    var start = builder.pos, end = start + text.length\r\n    for (;;) {\r\n      var part = (void 0)\r\n      for (var i = 0; i < order.length; i++) {\r\n        part = order[i]\r\n        if (part.to > start && part.from <= start) { break }\r\n      }\r\n      if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, title, css) }\r\n      inner(builder, text.slice(0, part.to - start), style, startStyle, null, title, css)\r\n      startStyle = null\r\n      text = text.slice(part.to - start)\r\n      start = part.to\r\n    }\r\n  }\r\n}\r\n\r\nfunction buildCollapsedSpan(builder, size, marker, ignoreWidget) {\r\n  var widget = !ignoreWidget && marker.widgetNode\r\n  if (widget) { builder.map.push(builder.pos, builder.pos + size, widget) }\r\n  if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\r\n    if (!widget)\r\n      { widget = builder.content.appendChild(document.createElement(\"span\")) }\r\n    widget.setAttribute(\"cm-marker\", marker.id)\r\n  }\r\n  if (widget) {\r\n    builder.cm.display.input.setUneditable(widget)\r\n    builder.content.appendChild(widget)\r\n  }\r\n  builder.pos += size\r\n  builder.trailingSpace = false\r\n}\r\n\r\nfunction insertLineContent(line, builder, styles) {\r\n  var spans = line.markedSpans, allText = line.text, at = 0\r\n  if (!spans) {\r\n    for (var i$1 = 1; i$1 < styles.length; i$1+=2)\r\n      { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)) }\r\n    return\r\n  }\r\n\r\n  var len = allText.length, pos = 0, i = 1, text = \"\", style, css\r\n  var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, title, collapsed\r\n  for (;;) {\r\n    if (nextChange == pos) { \r\n      spanStyle = spanEndStyle = spanStartStyle = title = css = \"\"\r\n      collapsed = null; nextChange = Infinity\r\n      var foundBookmarks = [], endStyles = (void 0)\r\n      for (var j = 0; j < spans.length; ++j) {\r\n        var sp = spans[j], m = sp.marker\r\n        if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\r\n          foundBookmarks.push(m)\r\n        } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\r\n          if (sp.to != null && sp.to != pos && nextChange > sp.to) {\r\n            nextChange = sp.to\r\n            spanEndStyle = \"\"\r\n          }\r\n          if (m.className) { spanStyle += \" \" + m.className }\r\n          if (m.css) { css = (css ? css + \";\" : \"\") + m.css }\r\n          if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle }\r\n          if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to) }\r\n          if (m.title && !title) { title = m.title }\r\n          if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\r\n            { collapsed = sp }\r\n        } else if (sp.from > pos && nextChange > sp.from) {\r\n          nextChange = sp.from\r\n        }\r\n      }\r\n      if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\r\n        { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1] } } }\r\n\r\n      if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\r\n        { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]) } }\r\n      if (collapsed && (collapsed.from || 0) == pos) {\r\n        buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\r\n                           collapsed.marker, collapsed.from == null)\r\n        if (collapsed.to == null) { return }\r\n        if (collapsed.to == pos) { collapsed = false }\r\n      }\r\n    }\r\n    if (pos >= len) { break }\r\n\r\n    var upto = Math.min(len, nextChange)\r\n    while (true) {\r\n      if (text) {\r\n        var end = pos + text.length\r\n        if (!collapsed) {\r\n          var tokenText = end > upto ? text.slice(0, upto - pos) : text\r\n          builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\r\n                           spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", title, css)\r\n        }\r\n        if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\r\n        pos = end\r\n        spanStartStyle = \"\"\r\n      }\r\n      text = allText.slice(at, at = styles[i++])\r\n      style = interpretTokenStyle(styles[i++], builder.cm.options)\r\n    }\r\n  }\r\n}\r\n\r\n\r\nfunction LineView(doc, line, lineN) {\r\n  this.line = line\r\n  this.rest = visualLineContinued(line)\r\n  this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1\r\n  this.node = this.text = null\r\n  this.hidden = lineIsHidden(doc, line)\r\n}\r\n\r\nfunction buildViewArray(cm, from, to) {\r\n  var array = [], nextPos\r\n  for (var pos = from; pos < to; pos = nextPos) {\r\n    var view = new LineView(cm.doc, getLine(cm.doc, pos), pos)\r\n    nextPos = pos + view.size\r\n    array.push(view)\r\n  }\r\n  return array\r\n}\r\n\r\nvar operationGroup = null\r\n\r\nfunction pushOperation(op) {\r\n  if (operationGroup) {\r\n    operationGroup.ops.push(op)\r\n  } else {\r\n    op.ownsGroup = operationGroup = {\r\n      ops: [op],\r\n      delayedCallbacks: []\r\n    }\r\n  }\r\n}\r\n\r\nfunction fireCallbacksForOps(group) {\r\n  var callbacks = group.delayedCallbacks, i = 0\r\n  do {\r\n    for (; i < callbacks.length; i++)\r\n      { callbacks[i].call(null) }\r\n    for (var j = 0; j < group.ops.length; j++) {\r\n      var op = group.ops[j]\r\n      if (op.cursorActivityHandlers)\r\n        { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\r\n          { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm) } }\r\n    }\r\n  } while (i < callbacks.length)\r\n}\r\n\r\nfunction finishOperation(op, endCb) {\r\n  var group = op.ownsGroup\r\n  if (!group) { return }\r\n\r\n  try { fireCallbacksForOps(group) }\r\n  finally {\r\n    operationGroup = null\r\n    endCb(group)\r\n  }\r\n}\r\n\r\nvar orphanDelayedCallbacks = null\r\n\r\nfunction signalLater(emitter, type ) {\r\n  var arr = getHandlers(emitter, type)\r\n  if (!arr.length) { return }\r\n  var args = Array.prototype.slice.call(arguments, 2), list\r\n  if (operationGroup) {\r\n    list = operationGroup.delayedCallbacks\r\n  } else if (orphanDelayedCallbacks) {\r\n    list = orphanDelayedCallbacks\r\n  } else {\r\n    list = orphanDelayedCallbacks = []\r\n    setTimeout(fireOrphanDelayed, 0)\r\n  }\r\n  var loop = function ( i ) {\r\n    list.push(function () { return arr[i].apply(null, args); })\r\n  };\r\n\r\n  for (var i = 0; i < arr.length; ++i)\r\n    loop( i );\r\n}\r\n\r\nfunction fireOrphanDelayed() {\r\n  var delayed = orphanDelayedCallbacks\r\n  orphanDelayedCallbacks = null\r\n  for (var i = 0; i < delayed.length; ++i) { delayed[i]() }\r\n}\r\n\r\nfunction updateLineForChanges(cm, lineView, lineN, dims) {\r\n  for (var j = 0; j < lineView.changes.length; j++) {\r\n    var type = lineView.changes[j]\r\n    if (type == \"text\") { updateLineText(cm, lineView) }\r\n    else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims) }\r\n    else if (type == \"class\") { updateLineClasses(cm, lineView) }\r\n    else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims) }\r\n  }\r\n  lineView.changes = null\r\n}\r\n\r\nfunction ensureLineWrapped(lineView) {\r\n  if (lineView.node == lineView.text) {\r\n    lineView.node = elt(\"div\", null, null, \"position: relative\")\r\n    if (lineView.text.parentNode)\r\n      { lineView.text.parentNode.replaceChild(lineView.node, lineView.text) }\r\n    lineView.node.appendChild(lineView.text)\r\n    if (ie && ie_version < 8) { lineView.node.style.zIndex = 2 }\r\n  }\r\n  return lineView.node\r\n}\r\n\r\nfunction updateLineBackground(cm, lineView) {\r\n  var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass\r\n  if (cls) { cls += \" CodeMirror-linebackground\" }\r\n  if (lineView.background) {\r\n    if (cls) { lineView.background.className = cls }\r\n    else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null }\r\n  } else if (cls) {\r\n    var wrap = ensureLineWrapped(lineView)\r\n    lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild)\r\n    cm.display.input.setUneditable(lineView.background)\r\n  }\r\n}\r\n\r\nfunction getLineContent(cm, lineView) {\r\n  var ext = cm.display.externalMeasured\r\n  if (ext && ext.line == lineView.line) {\r\n    cm.display.externalMeasured = null\r\n    lineView.measure = ext.measure\r\n    return ext.built\r\n  }\r\n  return buildLineContent(cm, lineView)\r\n}\r\n\r\nfunction updateLineText(cm, lineView) {\r\n  var cls = lineView.text.className\r\n  var built = getLineContent(cm, lineView)\r\n  if (lineView.text == lineView.node) { lineView.node = built.pre }\r\n  lineView.text.parentNode.replaceChild(built.pre, lineView.text)\r\n  lineView.text = built.pre\r\n  if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\r\n    lineView.bgClass = built.bgClass\r\n    lineView.textClass = built.textClass\r\n    updateLineClasses(cm, lineView)\r\n  } else if (cls) {\r\n    lineView.text.className = cls\r\n  }\r\n}\r\n\r\nfunction updateLineClasses(cm, lineView) {\r\n  updateLineBackground(cm, lineView)\r\n  if (lineView.line.wrapClass)\r\n    { ensureLineWrapped(lineView).className = lineView.line.wrapClass }\r\n  else if (lineView.node != lineView.text)\r\n    { lineView.node.className = \"\" }\r\n  var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass\r\n  lineView.text.className = textClass || \"\"\r\n}\r\n\r\nfunction updateLineGutter(cm, lineView, lineN, dims) {\r\n  if (lineView.gutter) {\r\n    lineView.node.removeChild(lineView.gutter)\r\n    lineView.gutter = null\r\n  }\r\n  if (lineView.gutterBackground) {\r\n    lineView.node.removeChild(lineView.gutterBackground)\r\n    lineView.gutterBackground = null\r\n  }\r\n  if (lineView.line.gutterClass) {\r\n    var wrap = ensureLineWrapped(lineView)\r\n    lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\r\n                                    (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"))\r\n    cm.display.input.setUneditable(lineView.gutterBackground)\r\n    wrap.insertBefore(lineView.gutterBackground, lineView.text)\r\n  }\r\n  var markers = lineView.line.gutterMarkers\r\n  if (cm.options.lineNumbers || markers) {\r\n    var wrap$1 = ensureLineWrapped(lineView)\r\n    var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"))\r\n    cm.display.input.setUneditable(gutterWrap)\r\n    wrap$1.insertBefore(gutterWrap, lineView.text)\r\n    if (lineView.line.gutterClass)\r\n      { gutterWrap.className += \" \" + lineView.line.gutterClass }\r\n    if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\r\n      { lineView.lineNumber = gutterWrap.appendChild(\r\n        elt(\"div\", lineNumberFor(cm.options, lineN),\r\n            \"CodeMirror-linenumber CodeMirror-gutter-elt\",\r\n            (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))) }\r\n    if (markers) { for (var k = 0; k < cm.options.gutters.length; ++k) {\r\n      var id = cm.options.gutters[k], found = markers.hasOwnProperty(id) && markers[id]\r\n      if (found)\r\n        { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\r\n                                   (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))) }\r\n    } }\r\n  }\r\n}\r\n\r\nfunction updateLineWidgets(cm, lineView, dims) {\r\n  if (lineView.alignable) { lineView.alignable = null }\r\n  for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\r\n    next = node.nextSibling\r\n    if (node.className == \"CodeMirror-linewidget\")\r\n      { lineView.node.removeChild(node) }\r\n  }\r\n  insertLineWidgets(cm, lineView, dims)\r\n}\r\n\r\nfunction buildLineElement(cm, lineView, lineN, dims) {\r\n  var built = getLineContent(cm, lineView)\r\n  lineView.text = lineView.node = built.pre\r\n  if (built.bgClass) { lineView.bgClass = built.bgClass }\r\n  if (built.textClass) { lineView.textClass = built.textClass }\r\n\r\n  updateLineClasses(cm, lineView)\r\n  updateLineGutter(cm, lineView, lineN, dims)\r\n  insertLineWidgets(cm, lineView, dims)\r\n  return lineView.node\r\n}\r\n\r\nfunction insertLineWidgets(cm, lineView, dims) {\r\n  insertLineWidgetsFor(cm, lineView.line, lineView, dims, true)\r\n  if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\r\n    { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false) } }\r\n}\r\n\r\nfunction insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\r\n  if (!line.widgets) { return }\r\n  var wrap = ensureLineWrapped(lineView)\r\n  for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\r\n    var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\")\r\n    if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\") }\r\n    positionLineWidget(widget, node, lineView, dims)\r\n    cm.display.input.setUneditable(node)\r\n    if (allowAbove && widget.above)\r\n      { wrap.insertBefore(node, lineView.gutter || lineView.text) }\r\n    else\r\n      { wrap.appendChild(node) }\r\n    signalLater(widget, \"redraw\")\r\n  }\r\n}\r\n\r\nfunction positionLineWidget(widget, node, lineView, dims) {\r\n  if (widget.noHScroll) {\r\n    ;(lineView.alignable || (lineView.alignable = [])).push(node)\r\n    var width = dims.wrapperWidth\r\n    node.style.left = dims.fixedPos + \"px\"\r\n    if (!widget.coverGutter) {\r\n      width -= dims.gutterTotalWidth\r\n      node.style.paddingLeft = dims.gutterTotalWidth + \"px\"\r\n    }\r\n    node.style.width = width + \"px\"\r\n  }\r\n  if (widget.coverGutter) {\r\n    node.style.zIndex = 5\r\n    node.style.position = \"relative\"\r\n    if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\" }\r\n  }\r\n}\r\n\r\nfunction widgetHeight(widget) {\r\n  if (widget.height != null) { return widget.height }\r\n  var cm = widget.doc.cm\r\n  if (!cm) { return 0 }\r\n  if (!contains(document.body, widget.node)) {\r\n    var parentStyle = \"position: relative;\"\r\n    if (widget.coverGutter)\r\n      { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\" }\r\n    if (widget.noHScroll)\r\n      { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\" }\r\n    removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle))\r\n  }\r\n  return widget.height = widget.node.parentNode.offsetHeight\r\n}\r\n\r\nfunction eventInWidget(display, e) {\r\n  for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\r\n    if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\r\n        (n.parentNode == display.sizer && n != display.mover))\r\n      { return true }\r\n  }\r\n}\r\n\r\n\r\nfunction paddingTop(display) {return display.lineSpace.offsetTop}\r\nfunction paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\r\nfunction paddingH(display) {\r\n  if (display.cachedPaddingH) { return display.cachedPaddingH }\r\n  var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\"))\r\n  var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle\r\n  var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)}\r\n  if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data }\r\n  return data\r\n}\r\n\r\nfunction scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\r\nfunction displayWidth(cm) {\r\n  return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\r\n}\r\nfunction displayHeight(cm) {\r\n  return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\r\n}\r\n\r\nfunction ensureLineHeights(cm, lineView, rect) {\r\n  var wrapping = cm.options.lineWrapping\r\n  var curWidth = wrapping && displayWidth(cm)\r\n  if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\r\n    var heights = lineView.measure.heights = []\r\n    if (wrapping) {\r\n      lineView.measure.width = curWidth\r\n      var rects = lineView.text.firstChild.getClientRects()\r\n      for (var i = 0; i < rects.length - 1; i++) {\r\n        var cur = rects[i], next = rects[i + 1]\r\n        if (Math.abs(cur.bottom - next.bottom) > 2)\r\n          { heights.push((cur.bottom + next.top) / 2 - rect.top) }\r\n      }\r\n    }\r\n    heights.push(rect.bottom - rect.top)\r\n  }\r\n}\r\n\r\nfunction mapFromLineView(lineView, line, lineN) {\r\n  if (lineView.line == line)\r\n    { return {map: lineView.measure.map, cache: lineView.measure.cache} }\r\n  for (var i = 0; i < lineView.rest.length; i++)\r\n    { if (lineView.rest[i] == line)\r\n      { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\r\n  for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\r\n    { if (lineNo(lineView.rest[i$1]) > lineN)\r\n      { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\r\n}\r\n\r\nfunction updateExternalMeasurement(cm, line) {\r\n  line = visualLine(line)\r\n  var lineN = lineNo(line)\r\n  var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN)\r\n  view.lineN = lineN\r\n  var built = view.built = buildLineContent(cm, view)\r\n  view.text = built.pre\r\n  removeChildrenAndAdd(cm.display.lineMeasure, built.pre)\r\n  return view\r\n}\r\n\r\nfunction measureChar(cm, line, ch, bias) {\r\n  return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\r\n}\r\n\r\nfunction findViewForLine(cm, lineN) {\r\n  if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\r\n    { return cm.display.view[findViewIndex(cm, lineN)] }\r\n  var ext = cm.display.externalMeasured\r\n  if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\r\n    { return ext }\r\n}\r\n\r\nfunction prepareMeasureForLine(cm, line) {\r\n  var lineN = lineNo(line)\r\n  var view = findViewForLine(cm, lineN)\r\n  if (view && !view.text) {\r\n    view = null\r\n  } else if (view && view.changes) {\r\n    updateLineForChanges(cm, view, lineN, getDimensions(cm))\r\n    cm.curOp.forceUpdate = true\r\n  }\r\n  if (!view)\r\n    { view = updateExternalMeasurement(cm, line) }\r\n\r\n  var info = mapFromLineView(view, line, lineN)\r\n  return {\r\n    line: line, view: view, rect: null,\r\n    map: info.map, cache: info.cache, before: info.before,\r\n    hasHeights: false\r\n  }\r\n}\r\n\r\nfunction measureCharPrepared(cm, prepared, ch, bias, varHeight) {\r\n  if (prepared.before) { ch = -1 }\r\n  var key = ch + (bias || \"\"), found\r\n  if (prepared.cache.hasOwnProperty(key)) {\r\n    found = prepared.cache[key]\r\n  } else {\r\n    if (!prepared.rect)\r\n      { prepared.rect = prepared.view.text.getBoundingClientRect() }\r\n    if (!prepared.hasHeights) {\r\n      ensureLineHeights(cm, prepared.view, prepared.rect)\r\n      prepared.hasHeights = true\r\n    }\r\n    found = measureCharInner(cm, prepared, ch, bias)\r\n    if (!found.bogus) { prepared.cache[key] = found }\r\n  }\r\n  return {left: found.left, right: found.right,\r\n          top: varHeight ? found.rtop : found.top,\r\n          bottom: varHeight ? found.rbottom : found.bottom}\r\n}\r\n\r\nvar nullRect = {left: 0, right: 0, top: 0, bottom: 0}\r\n\r\nfunction nodeAndOffsetInLineMap(map, ch, bias) {\r\n  var node, start, end, collapse, mStart, mEnd\r\n  for (var i = 0; i < map.length; i += 3) {\r\n    mStart = map[i]\r\n    mEnd = map[i + 1]\r\n    if (ch < mStart) {\r\n      start = 0; end = 1\r\n      collapse = \"left\"\r\n    } else if (ch < mEnd) {\r\n      start = ch - mStart\r\n      end = start + 1\r\n    } else if (i == map.length - 3 || ch == mEnd && map[i + 3] > ch) {\r\n      end = mEnd - mStart\r\n      start = end - 1\r\n      if (ch >= mEnd) { collapse = \"right\" }\r\n    }\r\n    if (start != null) {\r\n      node = map[i + 2]\r\n      if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\r\n        { collapse = bias }\r\n      if (bias == \"left\" && start == 0)\r\n        { while (i && map[i - 2] == map[i - 3] && map[i - 1].insertLeft) {\r\n          node = map[(i -= 3) + 2]\r\n          collapse = \"left\"\r\n        } }\r\n      if (bias == \"right\" && start == mEnd - mStart)\r\n        { while (i < map.length - 3 && map[i + 3] == map[i + 4] && !map[i + 5].insertLeft) {\r\n          node = map[(i += 3) + 2]\r\n          collapse = \"right\"\r\n        } }\r\n      break\r\n    }\r\n  }\r\n  return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\r\n}\r\n\r\nfunction getUsefulRect(rects, bias) {\r\n  var rect = nullRect\r\n  if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\r\n    if ((rect = rects[i]).left != rect.right) { break }\r\n  } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\r\n    if ((rect = rects[i$1]).left != rect.right) { break }\r\n  } }\r\n  return rect\r\n}\r\n\r\nfunction measureCharInner(cm, prepared, ch, bias) {\r\n  var place = nodeAndOffsetInLineMap(prepared.map, ch, bias)\r\n  var node = place.node, start = place.start, end = place.end, collapse = place.collapse\r\n\r\n  var rect\r\n  if (node.nodeType == 3) { \r\n    for (var i$1 = 0; i$1 < 4; i$1++) { \r\n      while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start }\r\n      while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end }\r\n      if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\r\n        { rect = node.parentNode.getBoundingClientRect() }\r\n      else\r\n        { rect = getUsefulRect(range(node, start, end).getClientRects(), bias) }\r\n      if (rect.left || rect.right || start == 0) { break }\r\n      end = start\r\n      start = start - 1\r\n      collapse = \"right\"\r\n    }\r\n    if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect) }\r\n  } else { \r\n    if (start > 0) { collapse = bias = \"right\" }\r\n    var rects\r\n    if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\r\n      { rect = rects[bias == \"right\" ? rects.length - 1 : 0] }\r\n    else\r\n      { rect = node.getBoundingClientRect() }\r\n  }\r\n  if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\r\n    var rSpan = node.parentNode.getClientRects()[0]\r\n    if (rSpan)\r\n      { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom} }\r\n    else\r\n      { rect = nullRect }\r\n  }\r\n\r\n  var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top\r\n  var mid = (rtop + rbot) / 2\r\n  var heights = prepared.view.measure.heights\r\n  var i = 0\r\n  for (; i < heights.length - 1; i++)\r\n    { if (mid < heights[i]) { break } }\r\n  var top = i ? heights[i - 1] : 0, bot = heights[i]\r\n  var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\r\n                right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\r\n                top: top, bottom: bot}\r\n  if (!rect.left && !rect.right) { result.bogus = true }\r\n  if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot }\r\n\r\n  return result\r\n}\r\n\r\nfunction maybeUpdateRectForZooming(measure, rect) {\r\n  if (!window.screen || screen.logicalXDPI == null ||\r\n      screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\r\n    { return rect }\r\n  var scaleX = screen.logicalXDPI / screen.deviceXDPI\r\n  var scaleY = screen.logicalYDPI / screen.deviceYDPI\r\n  return {left: rect.left * scaleX, right: rect.right * scaleX,\r\n          top: rect.top * scaleY, bottom: rect.bottom * scaleY}\r\n}\r\n\r\nfunction clearLineMeasurementCacheFor(lineView) {\r\n  if (lineView.measure) {\r\n    lineView.measure.cache = {}\r\n    lineView.measure.heights = null\r\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\r\n      { lineView.measure.caches[i] = {} } }\r\n  }\r\n}\r\n\r\nfunction clearLineMeasurementCache(cm) {\r\n  cm.display.externalMeasure = null\r\n  removeChildren(cm.display.lineMeasure)\r\n  for (var i = 0; i < cm.display.view.length; i++)\r\n    { clearLineMeasurementCacheFor(cm.display.view[i]) }\r\n}\r\n\r\nfunction clearCaches(cm) {\r\n  clearLineMeasurementCache(cm)\r\n  cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null\r\n  if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true }\r\n  cm.display.lineNumChars = null\r\n}\r\n\r\nfunction pageScrollX() {\r\n  if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\r\n  return window.pageXOffset || (document.documentElement || document.body).scrollLeft\r\n}\r\nfunction pageScrollY() {\r\n  if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\r\n  return window.pageYOffset || (document.documentElement || document.body).scrollTop\r\n}\r\n\r\nfunction widgetTopHeight(lineObj) {\r\n  var height = 0\r\n  if (lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above)\r\n    { height += widgetHeight(lineObj.widgets[i]) } } }\r\n  return height\r\n}\r\n\r\nfunction intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\r\n  if (!includeWidgets) {\r\n    var height = widgetTopHeight(lineObj)\r\n    rect.top += height; rect.bottom += height\r\n  }\r\n  if (context == \"line\") { return rect }\r\n  if (!context) { context = \"local\" }\r\n  var yOff = heightAtLine(lineObj)\r\n  if (context == \"local\") { yOff += paddingTop(cm.display) }\r\n  else { yOff -= cm.display.viewOffset }\r\n  if (context == \"page\" || context == \"window\") {\r\n    var lOff = cm.display.lineSpace.getBoundingClientRect()\r\n    yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY())\r\n    var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX())\r\n    rect.left += xOff; rect.right += xOff\r\n  }\r\n  rect.top += yOff; rect.bottom += yOff\r\n  return rect\r\n}\r\n\r\nfunction fromCoordSystem(cm, coords, context) {\r\n  if (context == \"div\") { return coords }\r\n  var left = coords.left, top = coords.top\r\n  if (context == \"page\") {\r\n    left -= pageScrollX()\r\n    top -= pageScrollY()\r\n  } else if (context == \"local\" || !context) {\r\n    var localBox = cm.display.sizer.getBoundingClientRect()\r\n    left += localBox.left\r\n    top += localBox.top\r\n  }\r\n\r\n  var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect()\r\n  return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\r\n}\r\n\r\nfunction charCoords(cm, pos, context, lineObj, bias) {\r\n  if (!lineObj) { lineObj = getLine(cm.doc, pos.line) }\r\n  return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\r\n}\r\n\r\nfunction cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\r\n  lineObj = lineObj || getLine(cm.doc, pos.line)\r\n  if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj) }\r\n  function get(ch, right) {\r\n    var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight)\r\n    if (right) { m.left = m.right; } else { m.right = m.left }\r\n    return intoCoordSystem(cm, lineObj, m, context)\r\n  }\r\n  var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky\r\n  if (ch >= lineObj.text.length) {\r\n    ch = lineObj.text.length\r\n    sticky = \"before\"\r\n  } else if (ch <= 0) {\r\n    ch = 0\r\n    sticky = \"after\"\r\n  }\r\n  if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\r\n\r\n  function getBidi(ch, partPos, invert) {\r\n    var part = order[partPos], right = part.level == 1\r\n    return get(invert ? ch - 1 : ch, right != invert)\r\n  }\r\n  var partPos = getBidiPartAt(order, ch, sticky)\r\n  var other = bidiOther\r\n  var val = getBidi(ch, partPos, sticky == \"before\")\r\n  if (other != null) { val.other = getBidi(ch, other, sticky != \"before\") }\r\n  return val\r\n}\r\n\r\nfunction estimateCoords(cm, pos) {\r\n  var left = 0\r\n  pos = clipPos(cm.doc, pos)\r\n  if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch }\r\n  var lineObj = getLine(cm.doc, pos.line)\r\n  var top = heightAtLine(lineObj) + paddingTop(cm.display)\r\n  return {left: left, right: left, top: top, bottom: top + lineObj.height}\r\n}\r\n\r\nfunction PosWithInfo(line, ch, sticky, outside, xRel) {\r\n  var pos = Pos(line, ch, sticky)\r\n  pos.xRel = xRel\r\n  if (outside) { pos.outside = true }\r\n  return pos\r\n}\r\n\r\nfunction coordsChar(cm, x, y) {\r\n  var doc = cm.doc\r\n  y += cm.display.viewOffset\r\n  if (y < 0) { return PosWithInfo(doc.first, 0, null, true, -1) }\r\n  var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1\r\n  if (lineN > last)\r\n    { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, true, 1) }\r\n  if (x < 0) { x = 0 }\r\n\r\n  var lineObj = getLine(doc, lineN)\r\n  for (;;) {\r\n    var found = coordsCharInner(cm, lineObj, lineN, x, y)\r\n    var merged = collapsedSpanAtEnd(lineObj)\r\n    var mergedPos = merged && merged.find(0, true)\r\n    if (merged && (found.ch > mergedPos.from.ch || found.ch == mergedPos.from.ch && found.xRel > 0))\r\n      { lineN = lineNo(lineObj = mergedPos.to.line) }\r\n    else\r\n      { return found }\r\n  }\r\n}\r\n\r\nfunction wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\r\n  y -= widgetTopHeight(lineObj)\r\n  var end = lineObj.text.length\r\n  var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0)\r\n  end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end)\r\n  return {begin: begin, end: end}\r\n}\r\n\r\nfunction wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\r\n  if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj) }\r\n  var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top\r\n  return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\r\n}\r\n\r\nfunction boxIsAfter(box, x, y, left) {\r\n  return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\r\n}\r\n\r\nfunction coordsCharInner(cm, lineObj, lineNo, x, y) {\r\n  y -= heightAtLine(lineObj)\r\n  var preparedMeasure = prepareMeasureForLine(cm, lineObj)\r\n  var widgetHeight = widgetTopHeight(lineObj)\r\n  var begin = 0, end = lineObj.text.length, ltr = true\r\n\r\n  var order = getOrder(lineObj, cm.doc.direction)\r\n  if (order) {\r\n    var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\r\n                 (cm, lineObj, lineNo, preparedMeasure, order, x, y)\r\n    ltr = part.level != 1\r\n    begin = ltr ? part.from : part.to - 1\r\n    end = ltr ? part.to : part.from - 1\r\n  }\r\n\r\n  var chAround = null, boxAround = null\r\n  var ch = findFirst(function (ch) {\r\n    var box = measureCharPrepared(cm, preparedMeasure, ch)\r\n    box.top += widgetHeight; box.bottom += widgetHeight\r\n    if (!boxIsAfter(box, x, y, false)) { return false }\r\n    if (box.top <= y && box.left <= x) {\r\n      chAround = ch\r\n      boxAround = box\r\n    }\r\n    return true\r\n  }, begin, end)\r\n\r\n  var baseX, sticky, outside = false\r\n  if (boxAround) {\r\n    var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr\r\n    ch = chAround + (atStart ? 0 : 1)\r\n    sticky = atStart ? \"after\" : \"before\"\r\n    baseX = atLeft ? boxAround.left : boxAround.right\r\n  } else {\r\n    if (!ltr && (ch == end || ch == begin)) { ch++ }\r\n    sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" :\r\n      (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight <= y) == ltr ?\r\n      \"after\" : \"before\"\r\n    var coords = cursorCoords(cm, Pos(lineNo, ch, sticky), \"line\", lineObj, preparedMeasure)\r\n    baseX = coords.left\r\n    outside = y < coords.top || y >= coords.bottom\r\n  }\r\n\r\n  ch = skipExtendingChars(lineObj.text, ch, 1)\r\n  return PosWithInfo(lineNo, ch, sticky, outside, x - baseX)\r\n}\r\n\r\nfunction coordsBidiPart(cm, lineObj, lineNo, preparedMeasure, order, x, y) {\r\n  var index = findFirst(function (i) {\r\n    var part = order[i], ltr = part.level != 1\r\n    return boxIsAfter(cursorCoords(cm, Pos(lineNo, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"),\r\n                                   \"line\", lineObj, preparedMeasure), x, y, true)\r\n  }, 0, order.length - 1)\r\n  var part = order[index]\r\n  if (index > 0) {\r\n    var ltr = part.level != 1\r\n    var start = cursorCoords(cm, Pos(lineNo, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"),\r\n                             \"line\", lineObj, preparedMeasure)\r\n    if (boxIsAfter(start, x, y, true) && start.top > y)\r\n      { part = order[index - 1] }\r\n  }\r\n  return part\r\n}\r\n\r\nfunction coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\r\n  var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\r\n  var begin = ref.begin;\r\n  var end = ref.end;\r\n  if (/\\s/.test(lineObj.text.charAt(end - 1))) { end-- }\r\n  var part = null, closestDist = null\r\n  for (var i = 0; i < order.length; i++) {\r\n    var p = order[i]\r\n    if (p.from >= end || p.to <= begin) { continue }\r\n    var ltr = p.level != 1\r\n    var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right\r\n    var dist = endX < x ? x - endX + 1e9 : endX - x\r\n    if (!part || closestDist > dist) {\r\n      part = p\r\n      closestDist = dist\r\n    }\r\n  }\r\n  if (!part) { part = order[order.length - 1] }\r\n  if (part.from < begin) { part = {from: begin, to: part.to, level: part.level} }\r\n  if (part.to > end) { part = {from: part.from, to: end, level: part.level} }\r\n  return part\r\n}\r\n\r\nvar measureText\r\nfunction textHeight(display) {\r\n  if (display.cachedTextHeight != null) { return display.cachedTextHeight }\r\n  if (measureText == null) {\r\n    measureText = elt(\"pre\")\r\n    for (var i = 0; i < 49; ++i) {\r\n      measureText.appendChild(document.createTextNode(\"x\"))\r\n      measureText.appendChild(elt(\"br\"))\r\n    }\r\n    measureText.appendChild(document.createTextNode(\"x\"))\r\n  }\r\n  removeChildrenAndAdd(display.measure, measureText)\r\n  var height = measureText.offsetHeight / 50\r\n  if (height > 3) { display.cachedTextHeight = height }\r\n  removeChildren(display.measure)\r\n  return height || 1\r\n}\r\n\r\nfunction charWidth(display) {\r\n  if (display.cachedCharWidth != null) { return display.cachedCharWidth }\r\n  var anchor = elt(\"span\", \"xxxxxxxxxx\")\r\n  var pre = elt(\"pre\", [anchor])\r\n  removeChildrenAndAdd(display.measure, pre)\r\n  var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10\r\n  if (width > 2) { display.cachedCharWidth = width }\r\n  return width || 10\r\n}\r\n\r\nfunction getDimensions(cm) {\r\n  var d = cm.display, left = {}, width = {}\r\n  var gutterLeft = d.gutters.clientLeft\r\n  for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\r\n    left[cm.options.gutters[i]] = n.offsetLeft + n.clientLeft + gutterLeft\r\n    width[cm.options.gutters[i]] = n.clientWidth\r\n  }\r\n  return {fixedPos: compensateForHScroll(d),\r\n          gutterTotalWidth: d.gutters.offsetWidth,\r\n          gutterLeft: left,\r\n          gutterWidth: width,\r\n          wrapperWidth: d.wrapper.clientWidth}\r\n}\r\n\r\nfunction compensateForHScroll(display) {\r\n  return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\r\n}\r\n\r\nfunction estimateHeight(cm) {\r\n  var th = textHeight(cm.display), wrapping = cm.options.lineWrapping\r\n  var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3)\r\n  return function (line) {\r\n    if (lineIsHidden(cm.doc, line)) { return 0 }\r\n\r\n    var widgetsHeight = 0\r\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\r\n      if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height }\r\n    } }\r\n\r\n    if (wrapping)\r\n      { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\r\n    else\r\n      { return widgetsHeight + th }\r\n  }\r\n}\r\n\r\nfunction estimateLineHeights(cm) {\r\n  var doc = cm.doc, est = estimateHeight(cm)\r\n  doc.iter(function (line) {\r\n    var estHeight = est(line)\r\n    if (estHeight != line.height) { updateLineHeight(line, estHeight) }\r\n  })\r\n}\r\n\r\nfunction posFromMouse(cm, e, liberal, forRect) {\r\n  var display = cm.display\r\n  if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\r\n\r\n  var x, y, space = display.lineSpace.getBoundingClientRect()\r\n  try { x = e.clientX - space.left; y = e.clientY - space.top }\r\n  catch (e) { return null }\r\n  var coords = coordsChar(cm, x, y), line\r\n  if (forRect && coords.xRel == 1 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\r\n    var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length\r\n    coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff))\r\n  }\r\n  return coords\r\n}\r\n\r\nfunction findViewIndex(cm, n) {\r\n  if (n >= cm.display.viewTo) { return null }\r\n  n -= cm.display.viewFrom\r\n  if (n < 0) { return null }\r\n  var view = cm.display.view\r\n  for (var i = 0; i < view.length; i++) {\r\n    n -= view[i].size\r\n    if (n < 0) { return i }\r\n  }\r\n}\r\n\r\nfunction updateSelection(cm) {\r\n  cm.display.input.showSelection(cm.display.input.prepareSelection())\r\n}\r\n\r\nfunction prepareSelection(cm, primary) {\r\n  if ( primary === void 0 ) primary = true;\r\n\r\n  var doc = cm.doc, result = {}\r\n  var curFragment = result.cursors = document.createDocumentFragment()\r\n  var selFragment = result.selection = document.createDocumentFragment()\r\n\r\n  for (var i = 0; i < doc.sel.ranges.length; i++) {\r\n    if (!primary && i == doc.sel.primIndex) { continue }\r\n    var range = doc.sel.ranges[i]\r\n    if (range.from().line >= cm.display.viewTo || range.to().line < cm.display.viewFrom) { continue }\r\n    var collapsed = range.empty()\r\n    if (collapsed || cm.options.showCursorWhenSelecting)\r\n      { drawSelectionCursor(cm, range.head, curFragment) }\r\n    if (!collapsed)\r\n      { drawSelectionRange(cm, range, selFragment) }\r\n  }\r\n  return result\r\n}\r\n\r\nfunction drawSelectionCursor(cm, head, output) {\r\n  var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine)\r\n\r\n  var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"))\r\n  cursor.style.left = pos.left + \"px\"\r\n  cursor.style.top = pos.top + \"px\"\r\n  cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\"\r\n\r\n  if (pos.other) {\r\n    var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"))\r\n    otherCursor.style.display = \"\"\r\n    otherCursor.style.left = pos.other.left + \"px\"\r\n    otherCursor.style.top = pos.other.top + \"px\"\r\n    otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\"\r\n  }\r\n}\r\n\r\nfunction cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\r\n\r\nfunction drawSelectionRange(cm, range, output) {\r\n  var display = cm.display, doc = cm.doc\r\n  var fragment = document.createDocumentFragment()\r\n  var padding = paddingH(cm.display), leftSide = padding.left\r\n  var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right\r\n  var docLTR = doc.direction == \"ltr\"\r\n\r\n  function add(left, top, width, bottom) {\r\n    if (top < 0) { top = 0 }\r\n    top = Math.round(top)\r\n    bottom = Math.round(bottom)\r\n    fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")))\r\n  }\r\n\r\n  function drawForLine(line, fromArg, toArg) {\r\n    var lineObj = getLine(doc, line)\r\n    var lineLen = lineObj.text.length\r\n    var start, end\r\n    function coords(ch, bias) {\r\n      return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\r\n    }\r\n\r\n    function wrapX(pos, dir, side) {\r\n      var extent = wrappedLineExtentChar(cm, lineObj, null, pos)\r\n      var prop = (dir == \"ltr\") == (side == \"after\") ? \"left\" : \"right\"\r\n      var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1)\r\n      return coords(ch, prop)[prop]\r\n    }\r\n\r\n    var order = getOrder(lineObj, doc.direction)\r\n    iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\r\n      var ltr = dir == \"ltr\"\r\n      var fromPos = coords(from, ltr ? \"left\" : \"right\")\r\n      var toPos = coords(to - 1, ltr ? \"right\" : \"left\")\r\n\r\n      var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen\r\n      var first = i == 0, last = !order || i == order.length - 1\r\n      if (toPos.top - fromPos.top <= 3) { \r\n        var openLeft = (docLTR ? openStart : openEnd) && first\r\n        var openRight = (docLTR ? openEnd : openStart) && last\r\n        var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left\r\n        var right = openRight ? rightSide : (ltr ? toPos : fromPos).right\r\n        add(left, fromPos.top, right - left, fromPos.bottom)\r\n      } else { \r\n        var topLeft, topRight, botLeft, botRight\r\n        if (ltr) {\r\n          topLeft = docLTR && openStart && first ? leftSide : fromPos.left\r\n          topRight = docLTR ? rightSide : wrapX(from, dir, \"before\")\r\n          botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\")\r\n          botRight = docLTR && openEnd && last ? rightSide : toPos.right\r\n        } else {\r\n          topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\")\r\n          topRight = !docLTR && openStart && first ? rightSide : fromPos.right\r\n          botLeft = !docLTR && openEnd && last ? leftSide : toPos.left\r\n          botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\")\r\n        }\r\n        add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom)\r\n        if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top) }\r\n        add(botLeft, toPos.top, botRight - botLeft, toPos.bottom)\r\n      }\r\n\r\n      if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos }\r\n      if (cmpCoords(toPos, start) < 0) { start = toPos }\r\n      if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos }\r\n      if (cmpCoords(toPos, end) < 0) { end = toPos }\r\n    })\r\n    return {start: start, end: end}\r\n  }\r\n\r\n  var sFrom = range.from(), sTo = range.to()\r\n  if (sFrom.line == sTo.line) {\r\n    drawForLine(sFrom.line, sFrom.ch, sTo.ch)\r\n  } else {\r\n    var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line)\r\n    var singleVLine = visualLine(fromLine) == visualLine(toLine)\r\n    var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end\r\n    var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start\r\n    if (singleVLine) {\r\n      if (leftEnd.top < rightStart.top - 2) {\r\n        add(leftEnd.right, leftEnd.top, null, leftEnd.bottom)\r\n        add(leftSide, rightStart.top, rightStart.left, rightStart.bottom)\r\n      } else {\r\n        add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom)\r\n      }\r\n    }\r\n    if (leftEnd.bottom < rightStart.top)\r\n      { add(leftSide, leftEnd.bottom, null, rightStart.top) }\r\n  }\r\n\r\n  output.appendChild(fragment)\r\n}\r\n\r\nfunction restartBlink(cm) {\r\n  if (!cm.state.focused) { return }\r\n  var display = cm.display\r\n  clearInterval(display.blinker)\r\n  var on = true\r\n  display.cursorDiv.style.visibility = \"\"\r\n  if (cm.options.cursorBlinkRate > 0)\r\n    { display.blinker = setInterval(function () { return display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\"; },\r\n      cm.options.cursorBlinkRate) }\r\n  else if (cm.options.cursorBlinkRate < 0)\r\n    { display.cursorDiv.style.visibility = \"hidden\" }\r\n}\r\n\r\nfunction ensureFocus(cm) {\r\n  if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm) }\r\n}\r\n\r\nfunction delayBlurEvent(cm) {\r\n  cm.state.delayingBlurEvent = true\r\n  setTimeout(function () { if (cm.state.delayingBlurEvent) {\r\n    cm.state.delayingBlurEvent = false\r\n    onBlur(cm)\r\n  } }, 100)\r\n}\r\n\r\nfunction onFocus(cm, e) {\r\n  if (cm.state.delayingBlurEvent) { cm.state.delayingBlurEvent = false }\r\n\r\n  if (cm.options.readOnly == \"nocursor\") { return }\r\n  if (!cm.state.focused) {\r\n    signal(cm, \"focus\", cm, e)\r\n    cm.state.focused = true\r\n    addClass(cm.display.wrapper, \"CodeMirror-focused\")\r\n    if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\r\n      cm.display.input.reset()\r\n      if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20) } \r\n    }\r\n    cm.display.input.receivedFocus()\r\n  }\r\n  restartBlink(cm)\r\n}\r\nfunction onBlur(cm, e) {\r\n  if (cm.state.delayingBlurEvent) { return }\r\n\r\n  if (cm.state.focused) {\r\n    signal(cm, \"blur\", cm, e)\r\n    cm.state.focused = false\r\n    rmClass(cm.display.wrapper, \"CodeMirror-focused\")\r\n  }\r\n  clearInterval(cm.display.blinker)\r\n  setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false } }, 150)\r\n}\r\n\r\nfunction updateHeightsInViewport(cm) {\r\n  var display = cm.display\r\n  var prevBottom = display.lineDiv.offsetTop\r\n  for (var i = 0; i < display.view.length; i++) {\r\n    var cur = display.view[i], height = (void 0)\r\n    if (cur.hidden) { continue }\r\n    if (ie && ie_version < 8) {\r\n      var bot = cur.node.offsetTop + cur.node.offsetHeight\r\n      height = bot - prevBottom\r\n      prevBottom = bot\r\n    } else {\r\n      var box = cur.node.getBoundingClientRect()\r\n      height = box.bottom - box.top\r\n    }\r\n    var diff = cur.line.height - height\r\n    if (height < 2) { height = textHeight(display) }\r\n    if (diff > .005 || diff < -.005) {\r\n      updateLineHeight(cur.line, height)\r\n      updateWidgetHeight(cur.line)\r\n      if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\r\n        { updateWidgetHeight(cur.rest[j]) } }\r\n    }\r\n  }\r\n}\r\n\r\nfunction updateWidgetHeight(line) {\r\n  if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i)\r\n    { line.widgets[i].height = line.widgets[i].node.parentNode.offsetHeight } }\r\n}\r\n\r\nfunction visibleLines(display, doc, viewport) {\r\n  var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop\r\n  top = Math.floor(top - paddingTop(display))\r\n  var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight\r\n\r\n  var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom)\r\n  if (viewport && viewport.ensure) {\r\n    var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line\r\n    if (ensureFrom < from) {\r\n      from = ensureFrom\r\n      to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight)\r\n    } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\r\n      from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight)\r\n      to = ensureTo\r\n    }\r\n  }\r\n  return {from: from, to: Math.max(to, from + 1)}\r\n}\r\n\r\nfunction alignHorizontally(cm) {\r\n  var display = cm.display, view = display.view\r\n  if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\r\n  var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft\r\n  var gutterW = display.gutters.offsetWidth, left = comp + \"px\"\r\n  for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\r\n    if (cm.options.fixedGutter) {\r\n      if (view[i].gutter)\r\n        { view[i].gutter.style.left = left }\r\n      if (view[i].gutterBackground)\r\n        { view[i].gutterBackground.style.left = left }\r\n    }\r\n    var align = view[i].alignable\r\n    if (align) { for (var j = 0; j < align.length; j++)\r\n      { align[j].style.left = left } }\r\n  } }\r\n  if (cm.options.fixedGutter)\r\n    { display.gutters.style.left = (comp + gutterW) + \"px\" }\r\n}\r\n\r\nfunction maybeUpdateLineNumberWidth(cm) {\r\n  if (!cm.options.lineNumbers) { return false }\r\n  var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display\r\n  if (last.length != display.lineNumChars) {\r\n    var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\r\n                                               \"CodeMirror-linenumber CodeMirror-gutter-elt\"))\r\n    var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW\r\n    display.lineGutter.style.width = \"\"\r\n    display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1\r\n    display.lineNumWidth = display.lineNumInnerWidth + padding\r\n    display.lineNumChars = display.lineNumInnerWidth ? last.length : -1\r\n    display.lineGutter.style.width = display.lineNumWidth + \"px\"\r\n    updateGutterSpace(cm)\r\n    return true\r\n  }\r\n  return false\r\n}\r\n\r\n\r\nfunction maybeScrollWindow(cm, rect) {\r\n  if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\r\n\r\n  var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null\r\n  if (rect.top + box.top < 0) { doScroll = true }\r\n  else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false }\r\n  if (doScroll != null && !phantom) {\r\n    var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"))\r\n    cm.display.lineSpace.appendChild(scrollNode)\r\n    scrollNode.scrollIntoView(doScroll)\r\n    cm.display.lineSpace.removeChild(scrollNode)\r\n  }\r\n}\r\n\r\nfunction scrollPosIntoView(cm, pos, end, margin) {\r\n  if (margin == null) { margin = 0 }\r\n  var rect\r\n  if (!cm.options.lineWrapping && pos == end) {\r\n    pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos\r\n    end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos\r\n  }\r\n  for (var limit = 0; limit < 5; limit++) {\r\n    var changed = false\r\n    var coords = cursorCoords(cm, pos)\r\n    var endCoords = !end || end == pos ? coords : cursorCoords(cm, end)\r\n    rect = {left: Math.min(coords.left, endCoords.left),\r\n            top: Math.min(coords.top, endCoords.top) - margin,\r\n            right: Math.max(coords.left, endCoords.left),\r\n            bottom: Math.max(coords.bottom, endCoords.bottom) + margin}\r\n    var scrollPos = calculateScrollPos(cm, rect)\r\n    var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft\r\n    if (scrollPos.scrollTop != null) {\r\n      updateScrollTop(cm, scrollPos.scrollTop)\r\n      if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true }\r\n    }\r\n    if (scrollPos.scrollLeft != null) {\r\n      setScrollLeft(cm, scrollPos.scrollLeft)\r\n      if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true }\r\n    }\r\n    if (!changed) { break }\r\n  }\r\n  return rect\r\n}\r\n\r\nfunction scrollIntoView(cm, rect) {\r\n  var scrollPos = calculateScrollPos(cm, rect)\r\n  if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop) }\r\n  if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft) }\r\n}\r\n\r\nfunction calculateScrollPos(cm, rect) {\r\n  var display = cm.display, snapMargin = textHeight(cm.display)\r\n  if (rect.top < 0) { rect.top = 0 }\r\n  var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop\r\n  var screen = displayHeight(cm), result = {}\r\n  if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen }\r\n  var docBottom = cm.doc.height + paddingVert(display)\r\n  var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin\r\n  if (rect.top < screentop) {\r\n    result.scrollTop = atTop ? 0 : rect.top\r\n  } else if (rect.bottom > screentop + screen) {\r\n    var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen)\r\n    if (newTop != screentop) { result.scrollTop = newTop }\r\n  }\r\n\r\n  var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft\r\n  var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0)\r\n  var tooWide = rect.right - rect.left > screenw\r\n  if (tooWide) { rect.right = rect.left + screenw }\r\n  if (rect.left < 10)\r\n    { result.scrollLeft = 0 }\r\n  else if (rect.left < screenleft)\r\n    { result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10)) }\r\n  else if (rect.right > screenw + screenleft - 3)\r\n    { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw }\r\n  return result\r\n}\r\n\r\nfunction addToScrollTop(cm, top) {\r\n  if (top == null) { return }\r\n  resolveScrollToPos(cm)\r\n  cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top\r\n}\r\n\r\nfunction ensureCursorVisible(cm) {\r\n  resolveScrollToPos(cm)\r\n  var cur = cm.getCursor()\r\n  cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin}\r\n}\r\n\r\nfunction scrollToCoords(cm, x, y) {\r\n  if (x != null || y != null) { resolveScrollToPos(cm) }\r\n  if (x != null) { cm.curOp.scrollLeft = x }\r\n  if (y != null) { cm.curOp.scrollTop = y }\r\n}\r\n\r\nfunction scrollToRange(cm, range) {\r\n  resolveScrollToPos(cm)\r\n  cm.curOp.scrollToPos = range\r\n}\r\n\r\nfunction resolveScrollToPos(cm) {\r\n  var range = cm.curOp.scrollToPos\r\n  if (range) {\r\n    cm.curOp.scrollToPos = null\r\n    var from = estimateCoords(cm, range.from), to = estimateCoords(cm, range.to)\r\n    scrollToCoordsRange(cm, from, to, range.margin)\r\n  }\r\n}\r\n\r\nfunction scrollToCoordsRange(cm, from, to, margin) {\r\n  var sPos = calculateScrollPos(cm, {\r\n    left: Math.min(from.left, to.left),\r\n    top: Math.min(from.top, to.top) - margin,\r\n    right: Math.max(from.right, to.right),\r\n    bottom: Math.max(from.bottom, to.bottom) + margin\r\n  })\r\n  scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop)\r\n}\r\n\r\nfunction updateScrollTop(cm, val) {\r\n  if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\r\n  if (!gecko) { updateDisplaySimple(cm, {top: val}) }\r\n  setScrollTop(cm, val, true)\r\n  if (gecko) { updateDisplaySimple(cm) }\r\n  startWorker(cm, 100)\r\n}\r\n\r\nfunction setScrollTop(cm, val, forceScroll) {\r\n  val = Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val)\r\n  if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\r\n  cm.doc.scrollTop = val\r\n  cm.display.scrollbars.setScrollTop(val)\r\n  if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val }\r\n}\r\n\r\nfunction setScrollLeft(cm, val, isScroller, forceScroll) {\r\n  val = Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth)\r\n  if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\r\n  cm.doc.scrollLeft = val\r\n  alignHorizontally(cm)\r\n  if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val }\r\n  cm.display.scrollbars.setScrollLeft(val)\r\n}\r\n\r\n\r\nfunction measureForScrollbars(cm) {\r\n  var d = cm.display, gutterW = d.gutters.offsetWidth\r\n  var docH = Math.round(cm.doc.height + paddingVert(cm.display))\r\n  return {\r\n    clientHeight: d.scroller.clientHeight,\r\n    viewHeight: d.wrapper.clientHeight,\r\n    scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\r\n    viewWidth: d.wrapper.clientWidth,\r\n    barLeft: cm.options.fixedGutter ? gutterW : 0,\r\n    docHeight: docH,\r\n    scrollHeight: docH + scrollGap(cm) + d.barHeight,\r\n    nativeBarWidth: d.nativeBarWidth,\r\n    gutterWidth: gutterW\r\n  }\r\n}\r\n\r\nvar NativeScrollbars = function(place, scroll, cm) {\r\n  this.cm = cm\r\n  var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\")\r\n  var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\")\r\n  place(vert); place(horiz)\r\n\r\n  on(vert, \"scroll\", function () {\r\n    if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\") }\r\n  })\r\n  on(horiz, \"scroll\", function () {\r\n    if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\") }\r\n  })\r\n\r\n  this.checkedZeroWidth = false\r\n  if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\" }\r\n};\r\n\r\nNativeScrollbars.prototype.update = function (measure) {\r\n  var needsH = measure.scrollWidth > measure.clientWidth + 1\r\n  var needsV = measure.scrollHeight > measure.clientHeight + 1\r\n  var sWidth = measure.nativeBarWidth\r\n\r\n  if (needsV) {\r\n    this.vert.style.display = \"block\"\r\n    this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\"\r\n    var totalHeight = measure.viewHeight - (needsH ? sWidth : 0)\r\n    this.vert.firstChild.style.height =\r\n      Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\"\r\n  } else {\r\n    this.vert.style.display = \"\"\r\n    this.vert.firstChild.style.height = \"0\"\r\n  }\r\n\r\n  if (needsH) {\r\n    this.horiz.style.display = \"block\"\r\n    this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\"\r\n    this.horiz.style.left = measure.barLeft + \"px\"\r\n    var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0)\r\n    this.horiz.firstChild.style.width =\r\n      Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\"\r\n  } else {\r\n    this.horiz.style.display = \"\"\r\n    this.horiz.firstChild.style.width = \"0\"\r\n  }\r\n\r\n  if (!this.checkedZeroWidth && measure.clientHeight > 0) {\r\n    if (sWidth == 0) { this.zeroWidthHack() }\r\n    this.checkedZeroWidth = true\r\n  }\r\n\r\n  return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\r\n};\r\n\r\nNativeScrollbars.prototype.setScrollLeft = function (pos) {\r\n  if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos }\r\n  if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\") }\r\n};\r\n\r\nNativeScrollbars.prototype.setScrollTop = function (pos) {\r\n  if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos }\r\n  if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\") }\r\n};\r\n\r\nNativeScrollbars.prototype.zeroWidthHack = function () {\r\n  var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\"\r\n  this.horiz.style.height = this.vert.style.width = w\r\n  this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\"\r\n  this.disableHoriz = new Delayed\r\n  this.disableVert = new Delayed\r\n};\r\n\r\nNativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\r\n  bar.style.pointerEvents = \"auto\"\r\n  function maybeDisable() {\r\n    var box = bar.getBoundingClientRect()\r\n    var elt = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\r\n        : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1)\r\n    if (elt != bar) { bar.style.pointerEvents = \"none\" }\r\n    else { delay.set(1000, maybeDisable) }\r\n  }\r\n  delay.set(1000, maybeDisable)\r\n};\r\n\r\nNativeScrollbars.prototype.clear = function () {\r\n  var parent = this.horiz.parentNode\r\n  parent.removeChild(this.horiz)\r\n  parent.removeChild(this.vert)\r\n};\r\n\r\nvar NullScrollbars = function () {};\r\n\r\nNullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\r\nNullScrollbars.prototype.setScrollLeft = function () {};\r\nNullScrollbars.prototype.setScrollTop = function () {};\r\nNullScrollbars.prototype.clear = function () {};\r\n\r\nfunction updateScrollbars(cm, measure) {\r\n  if (!measure) { measure = measureForScrollbars(cm) }\r\n  var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight\r\n  updateScrollbarsInner(cm, measure)\r\n  for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\r\n    if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\r\n      { updateHeightsInViewport(cm) }\r\n    updateScrollbarsInner(cm, measureForScrollbars(cm))\r\n    startWidth = cm.display.barWidth; startHeight = cm.display.barHeight\r\n  }\r\n}\r\n\r\nfunction updateScrollbarsInner(cm, measure) {\r\n  var d = cm.display\r\n  var sizes = d.scrollbars.update(measure)\r\n\r\n  d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\"\r\n  d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\"\r\n  d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\"\r\n\r\n  if (sizes.right && sizes.bottom) {\r\n    d.scrollbarFiller.style.display = \"block\"\r\n    d.scrollbarFiller.style.height = sizes.bottom + \"px\"\r\n    d.scrollbarFiller.style.width = sizes.right + \"px\"\r\n  } else { d.scrollbarFiller.style.display = \"\" }\r\n  if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\r\n    d.gutterFiller.style.display = \"block\"\r\n    d.gutterFiller.style.height = sizes.bottom + \"px\"\r\n    d.gutterFiller.style.width = measure.gutterWidth + \"px\"\r\n  } else { d.gutterFiller.style.display = \"\" }\r\n}\r\n\r\nvar scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars}\r\n\r\nfunction initScrollbars(cm) {\r\n  if (cm.display.scrollbars) {\r\n    cm.display.scrollbars.clear()\r\n    if (cm.display.scrollbars.addClass)\r\n      { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass) }\r\n  }\r\n\r\n  cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\r\n    cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller)\r\n    on(node, \"mousedown\", function () {\r\n      if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0) }\r\n    })\r\n    node.setAttribute(\"cm-not-content\", \"true\")\r\n  }, function (pos, axis) {\r\n    if (axis == \"horizontal\") { setScrollLeft(cm, pos) }\r\n    else { updateScrollTop(cm, pos) }\r\n  }, cm)\r\n  if (cm.display.scrollbars.addClass)\r\n    { addClass(cm.display.wrapper, cm.display.scrollbars.addClass) }\r\n}\r\n\r\n\r\nvar nextOpId = 0\r\nfunction startOperation(cm) {\r\n  cm.curOp = {\r\n    cm: cm,\r\n    viewChanged: false,      \r\n    startHeight: cm.doc.height, \r\n    forceUpdate: false,      \r\n    updateInput: null,       \r\n    typing: false,           \r\n    changeObjs: null,        \r\n    cursorActivityHandlers: null, \r\n    cursorActivityCalled: 0, \r\n    selectionChanged: false, \r\n    updateMaxLine: false,    \r\n    scrollLeft: null, scrollTop: null, \r\n    scrollToPos: null,       \r\n    focus: false,\r\n    id: ++nextOpId           \r\n  }\r\n  pushOperation(cm.curOp)\r\n}\r\n\r\nfunction endOperation(cm) {\r\n  var op = cm.curOp\r\n  finishOperation(op, function (group) {\r\n    for (var i = 0; i < group.ops.length; i++)\r\n      { group.ops[i].cm.curOp = null }\r\n    endOperations(group)\r\n  })\r\n}\r\n\r\nfunction endOperations(group) {\r\n  var ops = group.ops\r\n  for (var i = 0; i < ops.length; i++) \r\n    { endOperation_R1(ops[i]) }\r\n  for (var i$1 = 0; i$1 < ops.length; i$1++) \r\n    { endOperation_W1(ops[i$1]) }\r\n  for (var i$2 = 0; i$2 < ops.length; i$2++) \r\n    { endOperation_R2(ops[i$2]) }\r\n  for (var i$3 = 0; i$3 < ops.length; i$3++) \r\n    { endOperation_W2(ops[i$3]) }\r\n  for (var i$4 = 0; i$4 < ops.length; i$4++) \r\n    { endOperation_finish(ops[i$4]) }\r\n}\r\n\r\nfunction endOperation_R1(op) {\r\n  var cm = op.cm, display = cm.display\r\n  maybeClipScrollbars(cm)\r\n  if (op.updateMaxLine) { findMaxLine(cm) }\r\n\r\n  op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\r\n    op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\r\n                       op.scrollToPos.to.line >= display.viewTo) ||\r\n    display.maxLineChanged && cm.options.lineWrapping\r\n  op.update = op.mustUpdate &&\r\n    new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate)\r\n}\r\n\r\nfunction endOperation_W1(op) {\r\n  op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update)\r\n}\r\n\r\nfunction endOperation_R2(op) {\r\n  var cm = op.cm, display = cm.display\r\n  if (op.updatedDisplay) { updateHeightsInViewport(cm) }\r\n\r\n  op.barMeasure = measureForScrollbars(cm)\r\n\r\n  if (display.maxLineChanged && !cm.options.lineWrapping) {\r\n    op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3\r\n    cm.display.sizerWidth = op.adjustWidthTo\r\n    op.barMeasure.scrollWidth =\r\n      Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth)\r\n    op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm))\r\n  }\r\n\r\n  if (op.updatedDisplay || op.selectionChanged)\r\n    { op.preparedSelection = display.input.prepareSelection() }\r\n}\r\n\r\nfunction endOperation_W2(op) {\r\n  var cm = op.cm\r\n\r\n  if (op.adjustWidthTo != null) {\r\n    cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\"\r\n    if (op.maxScrollLeft < cm.doc.scrollLeft)\r\n      { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true) }\r\n    cm.display.maxLineChanged = false\r\n  }\r\n\r\n  var takeFocus = op.focus && op.focus == activeElt()\r\n  if (op.preparedSelection)\r\n    { cm.display.input.showSelection(op.preparedSelection, takeFocus) }\r\n  if (op.updatedDisplay || op.startHeight != cm.doc.height)\r\n    { updateScrollbars(cm, op.barMeasure) }\r\n  if (op.updatedDisplay)\r\n    { setDocumentHeight(cm, op.barMeasure) }\r\n\r\n  if (op.selectionChanged) { restartBlink(cm) }\r\n\r\n  if (cm.state.focused && op.updateInput)\r\n    { cm.display.input.reset(op.typing) }\r\n  if (takeFocus) { ensureFocus(op.cm) }\r\n}\r\n\r\nfunction endOperation_finish(op) {\r\n  var cm = op.cm, display = cm.display, doc = cm.doc\r\n\r\n  if (op.updatedDisplay) { postUpdateDisplay(cm, op.update) }\r\n\r\n  if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\r\n    { display.wheelStartX = display.wheelStartY = null }\r\n\r\n  if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll) }\r\n\r\n  if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true) }\r\n  if (op.scrollToPos) {\r\n    var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\r\n                                 clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin)\r\n    maybeScrollWindow(cm, rect)\r\n  }\r\n\r\n  var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers\r\n  if (hidden) { for (var i = 0; i < hidden.length; ++i)\r\n    { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\") } } }\r\n  if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\r\n    { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\") } } }\r\n\r\n  if (display.wrapper.offsetHeight)\r\n    { doc.scrollTop = cm.display.scroller.scrollTop }\r\n\r\n  if (op.changeObjs)\r\n    { signal(cm, \"changes\", cm, op.changeObjs) }\r\n  if (op.update)\r\n    { op.update.finish() }\r\n}\r\n\r\nfunction runInOp(cm, f) {\r\n  if (cm.curOp) { return f() }\r\n  startOperation(cm)\r\n  try { return f() }\r\n  finally { endOperation(cm) }\r\n}\r\nfunction operation(cm, f) {\r\n  return function() {\r\n    if (cm.curOp) { return f.apply(cm, arguments) }\r\n    startOperation(cm)\r\n    try { return f.apply(cm, arguments) }\r\n    finally { endOperation(cm) }\r\n  }\r\n}\r\nfunction methodOp(f) {\r\n  return function() {\r\n    if (this.curOp) { return f.apply(this, arguments) }\r\n    startOperation(this)\r\n    try { return f.apply(this, arguments) }\r\n    finally { endOperation(this) }\r\n  }\r\n}\r\nfunction docMethodOp(f) {\r\n  return function() {\r\n    var cm = this.cm\r\n    if (!cm || cm.curOp) { return f.apply(this, arguments) }\r\n    startOperation(cm)\r\n    try { return f.apply(this, arguments) }\r\n    finally { endOperation(cm) }\r\n  }\r\n}\r\n\r\nfunction regChange(cm, from, to, lendiff) {\r\n  if (from == null) { from = cm.doc.first }\r\n  if (to == null) { to = cm.doc.first + cm.doc.size }\r\n  if (!lendiff) { lendiff = 0 }\r\n\r\n  var display = cm.display\r\n  if (lendiff && to < display.viewTo &&\r\n      (display.updateLineNumbers == null || display.updateLineNumbers > from))\r\n    { display.updateLineNumbers = from }\r\n\r\n  cm.curOp.viewChanged = true\r\n\r\n  if (from >= display.viewTo) { \r\n    if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\r\n      { resetView(cm) }\r\n  } else if (to <= display.viewFrom) { \r\n    if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\r\n      resetView(cm)\r\n    } else {\r\n      display.viewFrom += lendiff\r\n      display.viewTo += lendiff\r\n    }\r\n  } else if (from <= display.viewFrom && to >= display.viewTo) { \r\n    resetView(cm)\r\n  } else if (from <= display.viewFrom) { \r\n    var cut = viewCuttingPoint(cm, to, to + lendiff, 1)\r\n    if (cut) {\r\n      display.view = display.view.slice(cut.index)\r\n      display.viewFrom = cut.lineN\r\n      display.viewTo += lendiff\r\n    } else {\r\n      resetView(cm)\r\n    }\r\n  } else if (to >= display.viewTo) { \r\n    var cut$1 = viewCuttingPoint(cm, from, from, -1)\r\n    if (cut$1) {\r\n      display.view = display.view.slice(0, cut$1.index)\r\n      display.viewTo = cut$1.lineN\r\n    } else {\r\n      resetView(cm)\r\n    }\r\n  } else { \r\n    var cutTop = viewCuttingPoint(cm, from, from, -1)\r\n    var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1)\r\n    if (cutTop && cutBot) {\r\n      display.view = display.view.slice(0, cutTop.index)\r\n        .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\r\n        .concat(display.view.slice(cutBot.index))\r\n      display.viewTo += lendiff\r\n    } else {\r\n      resetView(cm)\r\n    }\r\n  }\r\n\r\n  var ext = display.externalMeasured\r\n  if (ext) {\r\n    if (to < ext.lineN)\r\n      { ext.lineN += lendiff }\r\n    else if (from < ext.lineN + ext.size)\r\n      { display.externalMeasured = null }\r\n  }\r\n}\r\n\r\nfunction regLineChange(cm, line, type) {\r\n  cm.curOp.viewChanged = true\r\n  var display = cm.display, ext = cm.display.externalMeasured\r\n  if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\r\n    { display.externalMeasured = null }\r\n\r\n  if (line < display.viewFrom || line >= display.viewTo) { return }\r\n  var lineView = display.view[findViewIndex(cm, line)]\r\n  if (lineView.node == null) { return }\r\n  var arr = lineView.changes || (lineView.changes = [])\r\n  if (indexOf(arr, type) == -1) { arr.push(type) }\r\n}\r\n\r\nfunction resetView(cm) {\r\n  cm.display.viewFrom = cm.display.viewTo = cm.doc.first\r\n  cm.display.view = []\r\n  cm.display.viewOffset = 0\r\n}\r\n\r\nfunction viewCuttingPoint(cm, oldN, newN, dir) {\r\n  var index = findViewIndex(cm, oldN), diff, view = cm.display.view\r\n  if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\r\n    { return {index: index, lineN: newN} }\r\n  var n = cm.display.viewFrom\r\n  for (var i = 0; i < index; i++)\r\n    { n += view[i].size }\r\n  if (n != oldN) {\r\n    if (dir > 0) {\r\n      if (index == view.length - 1) { return null }\r\n      diff = (n + view[index].size) - oldN\r\n      index++\r\n    } else {\r\n      diff = n - oldN\r\n    }\r\n    oldN += diff; newN += diff\r\n  }\r\n  while (visualLineNo(cm.doc, newN) != newN) {\r\n    if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\r\n    newN += dir * view[index - (dir < 0 ? 1 : 0)].size\r\n    index += dir\r\n  }\r\n  return {index: index, lineN: newN}\r\n}\r\n\r\nfunction adjustView(cm, from, to) {\r\n  var display = cm.display, view = display.view\r\n  if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\r\n    display.view = buildViewArray(cm, from, to)\r\n    display.viewFrom = from\r\n  } else {\r\n    if (display.viewFrom > from)\r\n      { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view) }\r\n    else if (display.viewFrom < from)\r\n      { display.view = display.view.slice(findViewIndex(cm, from)) }\r\n    display.viewFrom = from\r\n    if (display.viewTo < to)\r\n      { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)) }\r\n    else if (display.viewTo > to)\r\n      { display.view = display.view.slice(0, findViewIndex(cm, to)) }\r\n  }\r\n  display.viewTo = to\r\n}\r\n\r\nfunction countDirtyView(cm) {\r\n  var view = cm.display.view, dirty = 0\r\n  for (var i = 0; i < view.length; i++) {\r\n    var lineView = view[i]\r\n    if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty }\r\n  }\r\n  return dirty\r\n}\r\n\r\n\r\nfunction startWorker(cm, time) {\r\n  if (cm.doc.highlightFrontier < cm.display.viewTo)\r\n    { cm.state.highlight.set(time, bind(highlightWorker, cm)) }\r\n}\r\n\r\nfunction highlightWorker(cm) {\r\n  var doc = cm.doc\r\n  if (doc.highlightFrontier >= cm.display.viewTo) { return }\r\n  var end = +new Date + cm.options.workTime\r\n  var context = getContextBefore(cm, doc.highlightFrontier)\r\n  var changedLines = []\r\n\r\n  doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\r\n    if (context.line >= cm.display.viewFrom) { \r\n      var oldStyles = line.styles\r\n      var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null\r\n      var highlighted = highlightLine(cm, line, context, true)\r\n      if (resetState) { context.state = resetState }\r\n      line.styles = highlighted.styles\r\n      var oldCls = line.styleClasses, newCls = highlighted.classes\r\n      if (newCls) { line.styleClasses = newCls }\r\n      else if (oldCls) { line.styleClasses = null }\r\n      var ischange = !oldStyles || oldStyles.length != line.styles.length ||\r\n        oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass)\r\n      for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i] }\r\n      if (ischange) { changedLines.push(context.line) }\r\n      line.stateAfter = context.save()\r\n      context.nextLine()\r\n    } else {\r\n      if (line.text.length <= cm.options.maxHighlightLength)\r\n        { processLine(cm, line.text, context) }\r\n      line.stateAfter = context.line % 5 == 0 ? context.save() : null\r\n      context.nextLine()\r\n    }\r\n    if (+new Date > end) {\r\n      startWorker(cm, cm.options.workDelay)\r\n      return true\r\n    }\r\n  })\r\n  doc.highlightFrontier = context.line\r\n  doc.modeFrontier = Math.max(doc.modeFrontier, context.line)\r\n  if (changedLines.length) { runInOp(cm, function () {\r\n    for (var i = 0; i < changedLines.length; i++)\r\n      { regLineChange(cm, changedLines[i], \"text\") }\r\n  }) }\r\n}\r\n\r\n\r\nvar DisplayUpdate = function(cm, viewport, force) {\r\n  var display = cm.display\r\n\r\n  this.viewport = viewport\r\n  this.visible = visibleLines(display, cm.doc, viewport)\r\n  this.editorIsHidden = !display.wrapper.offsetWidth\r\n  this.wrapperHeight = display.wrapper.clientHeight\r\n  this.wrapperWidth = display.wrapper.clientWidth\r\n  this.oldDisplayWidth = displayWidth(cm)\r\n  this.force = force\r\n  this.dims = getDimensions(cm)\r\n  this.events = []\r\n};\r\n\r\nDisplayUpdate.prototype.signal = function (emitter, type) {\r\n  if (hasHandler(emitter, type))\r\n    { this.events.push(arguments) }\r\n};\r\nDisplayUpdate.prototype.finish = function () {\r\n    var this$1 = this;\r\n\r\n  for (var i = 0; i < this.events.length; i++)\r\n    { signal.apply(null, this$1.events[i]) }\r\n};\r\n\r\nfunction maybeClipScrollbars(cm) {\r\n  var display = cm.display\r\n  if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\r\n    display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth\r\n    display.heightForcer.style.height = scrollGap(cm) + \"px\"\r\n    display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\"\r\n    display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\"\r\n    display.scrollbarsClipped = true\r\n  }\r\n}\r\n\r\nfunction selectionSnapshot(cm) {\r\n  if (cm.hasFocus()) { return null }\r\n  var active = activeElt()\r\n  if (!active || !contains(cm.display.lineDiv, active)) { return null }\r\n  var result = {activeElt: active}\r\n  if (window.getSelection) {\r\n    var sel = window.getSelection()\r\n    if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\r\n      result.anchorNode = sel.anchorNode\r\n      result.anchorOffset = sel.anchorOffset\r\n      result.focusNode = sel.focusNode\r\n      result.focusOffset = sel.focusOffset\r\n    }\r\n  }\r\n  return result\r\n}\r\n\r\nfunction restoreSelection(snapshot) {\r\n  if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\r\n  snapshot.activeElt.focus()\r\n  if (snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\r\n    var sel = window.getSelection(), range = document.createRange()\r\n    range.setEnd(snapshot.anchorNode, snapshot.anchorOffset)\r\n    range.collapse(false)\r\n    sel.removeAllRanges()\r\n    sel.addRange(range)\r\n    sel.extend(snapshot.focusNode, snapshot.focusOffset)\r\n  }\r\n}\r\n\r\nfunction updateDisplayIfNeeded(cm, update) {\r\n  var display = cm.display, doc = cm.doc\r\n\r\n  if (update.editorIsHidden) {\r\n    resetView(cm)\r\n    return false\r\n  }\r\n\r\n  if (!update.force &&\r\n      update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\r\n      (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\r\n      display.renderedView == display.view && countDirtyView(cm) == 0)\r\n    { return false }\r\n\r\n  if (maybeUpdateLineNumberWidth(cm)) {\r\n    resetView(cm)\r\n    update.dims = getDimensions(cm)\r\n  }\r\n\r\n  var end = doc.first + doc.size\r\n  var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first)\r\n  var to = Math.min(end, update.visible.to + cm.options.viewportMargin)\r\n  if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom) }\r\n  if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo) }\r\n  if (sawCollapsedSpans) {\r\n    from = visualLineNo(cm.doc, from)\r\n    to = visualLineEndNo(cm.doc, to)\r\n  }\r\n\r\n  var different = from != display.viewFrom || to != display.viewTo ||\r\n    display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth\r\n  adjustView(cm, from, to)\r\n\r\n  display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom))\r\n  cm.display.mover.style.top = display.viewOffset + \"px\"\r\n\r\n  var toUpdate = countDirtyView(cm)\r\n  if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\r\n      (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\r\n    { return false }\r\n\r\n  var selSnapshot = selectionSnapshot(cm)\r\n  if (toUpdate > 4) { display.lineDiv.style.display = \"none\" }\r\n  patchDisplay(cm, display.updateLineNumbers, update.dims)\r\n  if (toUpdate > 4) { display.lineDiv.style.display = \"\" }\r\n  display.renderedView = display.view\r\n  restoreSelection(selSnapshot)\r\n\r\n  removeChildren(display.cursorDiv)\r\n  removeChildren(display.selectionDiv)\r\n  display.gutters.style.height = display.sizer.style.minHeight = 0\r\n\r\n  if (different) {\r\n    display.lastWrapHeight = update.wrapperHeight\r\n    display.lastWrapWidth = update.wrapperWidth\r\n    startWorker(cm, 400)\r\n  }\r\n\r\n  display.updateLineNumbers = null\r\n\r\n  return true\r\n}\r\n\r\nfunction postUpdateDisplay(cm, update) {\r\n  var viewport = update.viewport\r\n\r\n  for (var first = true;; first = false) {\r\n    if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\r\n      if (viewport && viewport.top != null)\r\n        { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)} }\r\n      update.visible = visibleLines(cm.display, cm.doc, viewport)\r\n      if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\r\n        { break }\r\n    }\r\n    if (!updateDisplayIfNeeded(cm, update)) { break }\r\n    updateHeightsInViewport(cm)\r\n    var barMeasure = measureForScrollbars(cm)\r\n    updateSelection(cm)\r\n    updateScrollbars(cm, barMeasure)\r\n    setDocumentHeight(cm, barMeasure)\r\n    update.force = false\r\n  }\r\n\r\n  update.signal(cm, \"update\", cm)\r\n  if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\r\n    update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo)\r\n    cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo\r\n  }\r\n}\r\n\r\nfunction updateDisplaySimple(cm, viewport) {\r\n  var update = new DisplayUpdate(cm, viewport)\r\n  if (updateDisplayIfNeeded(cm, update)) {\r\n    updateHeightsInViewport(cm)\r\n    postUpdateDisplay(cm, update)\r\n    var barMeasure = measureForScrollbars(cm)\r\n    updateSelection(cm)\r\n    updateScrollbars(cm, barMeasure)\r\n    setDocumentHeight(cm, barMeasure)\r\n    update.finish()\r\n  }\r\n}\r\n\r\nfunction patchDisplay(cm, updateNumbersFrom, dims) {\r\n  var display = cm.display, lineNumbers = cm.options.lineNumbers\r\n  var container = display.lineDiv, cur = container.firstChild\r\n\r\n  function rm(node) {\r\n    var next = node.nextSibling\r\n    if (webkit && mac && cm.display.currentWheelTarget == node)\r\n      { node.style.display = \"none\" }\r\n    else\r\n      { node.parentNode.removeChild(node) }\r\n    return next\r\n  }\r\n\r\n  var view = display.view, lineN = display.viewFrom\r\n  for (var i = 0; i < view.length; i++) {\r\n    var lineView = view[i]\r\n    if (lineView.hidden) {\r\n    } else if (!lineView.node || lineView.node.parentNode != container) { \r\n      var node = buildLineElement(cm, lineView, lineN, dims)\r\n      container.insertBefore(node, cur)\r\n    } else { \r\n      while (cur != lineView.node) { cur = rm(cur) }\r\n      var updateNumber = lineNumbers && updateNumbersFrom != null &&\r\n        updateNumbersFrom <= lineN && lineView.lineNumber\r\n      if (lineView.changes) {\r\n        if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false }\r\n        updateLineForChanges(cm, lineView, lineN, dims)\r\n      }\r\n      if (updateNumber) {\r\n        removeChildren(lineView.lineNumber)\r\n        lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)))\r\n      }\r\n      cur = lineView.node.nextSibling\r\n    }\r\n    lineN += lineView.size\r\n  }\r\n  while (cur) { cur = rm(cur) }\r\n}\r\n\r\nfunction updateGutterSpace(cm) {\r\n  var width = cm.display.gutters.offsetWidth\r\n  cm.display.sizer.style.marginLeft = width + \"px\"\r\n}\r\n\r\nfunction setDocumentHeight(cm, measure) {\r\n  cm.display.sizer.style.minHeight = measure.docHeight + \"px\"\r\n  cm.display.heightForcer.style.top = measure.docHeight + \"px\"\r\n  cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\"\r\n}\r\n\r\nfunction updateGutters(cm) {\r\n  var gutters = cm.display.gutters, specs = cm.options.gutters\r\n  removeChildren(gutters)\r\n  var i = 0\r\n  for (; i < specs.length; ++i) {\r\n    var gutterClass = specs[i]\r\n    var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + gutterClass))\r\n    if (gutterClass == \"CodeMirror-linenumbers\") {\r\n      cm.display.lineGutter = gElt\r\n      gElt.style.width = (cm.display.lineNumWidth || 1) + \"px\"\r\n    }\r\n  }\r\n  gutters.style.display = i ? \"\" : \"none\"\r\n  updateGutterSpace(cm)\r\n}\r\n\r\nfunction setGuttersForLineNumbers(options) {\r\n  var found = indexOf(options.gutters, \"CodeMirror-linenumbers\")\r\n  if (found == -1 && options.lineNumbers) {\r\n    options.gutters = options.gutters.concat([\"CodeMirror-linenumbers\"])\r\n  } else if (found > -1 && !options.lineNumbers) {\r\n    options.gutters = options.gutters.slice(0)\r\n    options.gutters.splice(found, 1)\r\n  }\r\n}\r\n\r\nvar wheelSamples = 0;\r\nvar wheelPixelsPerUnit = null;\r\nif (ie) { wheelPixelsPerUnit = -.53 }\r\nelse if (gecko) { wheelPixelsPerUnit = 15 }\r\nelse if (chrome) { wheelPixelsPerUnit = -.7 }\r\nelse if (safari) { wheelPixelsPerUnit = -1/3 }\r\n\r\nfunction wheelEventDelta(e) {\r\n  var dx = e.wheelDeltaX, dy = e.wheelDeltaY\r\n  if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail }\r\n  if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail }\r\n  else if (dy == null) { dy = e.wheelDelta }\r\n  return {x: dx, y: dy}\r\n}\r\nfunction wheelEventPixels(e) {\r\n  var delta = wheelEventDelta(e)\r\n  delta.x *= wheelPixelsPerUnit\r\n  delta.y *= wheelPixelsPerUnit\r\n  return delta\r\n}\r\n\r\nfunction onScrollWheel(cm, e) {\r\n  var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y\r\n\r\n  var display = cm.display, scroll = display.scroller\r\n  var canScrollX = scroll.scrollWidth > scroll.clientWidth\r\n  var canScrollY = scroll.scrollHeight > scroll.clientHeight\r\n  if (!(dx && canScrollX || dy && canScrollY)) { return }\r\n\r\n  if (dy && mac && webkit) {\r\n    outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\r\n      for (var i = 0; i < view.length; i++) {\r\n        if (view[i].node == cur) {\r\n          cm.display.currentWheelTarget = cur\r\n          break outer\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\r\n    if (dy && canScrollY)\r\n      { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)) }\r\n    setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit))\r\n    if (!dy || (dy && canScrollY))\r\n      { e_preventDefault(e) }\r\n    display.wheelStartX = null \r\n    return\r\n  }\r\n\r\n  if (dy && wheelPixelsPerUnit != null) {\r\n    var pixels = dy * wheelPixelsPerUnit\r\n    var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight\r\n    if (pixels < 0) { top = Math.max(0, top + pixels - 50) }\r\n    else { bot = Math.min(cm.doc.height, bot + pixels + 50) }\r\n    updateDisplaySimple(cm, {top: top, bottom: bot})\r\n  }\r\n\r\n  if (wheelSamples < 20) {\r\n    if (display.wheelStartX == null) {\r\n      display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop\r\n      display.wheelDX = dx; display.wheelDY = dy\r\n      setTimeout(function () {\r\n        if (display.wheelStartX == null) { return }\r\n        var movedX = scroll.scrollLeft - display.wheelStartX\r\n        var movedY = scroll.scrollTop - display.wheelStartY\r\n        var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\r\n          (movedX && display.wheelDX && movedX / display.wheelDX)\r\n        display.wheelStartX = display.wheelStartY = null\r\n        if (!sample) { return }\r\n        wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1)\r\n        ++wheelSamples\r\n      }, 200)\r\n    } else {\r\n      display.wheelDX += dx; display.wheelDY += dy\r\n    }\r\n  }\r\n}\r\n\r\nvar Selection = function(ranges, primIndex) {\r\n  this.ranges = ranges\r\n  this.primIndex = primIndex\r\n};\r\n\r\nSelection.prototype.primary = function () { return this.ranges[this.primIndex] };\r\n\r\nSelection.prototype.equals = function (other) {\r\n    var this$1 = this;\r\n\r\n  if (other == this) { return true }\r\n  if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\r\n  for (var i = 0; i < this.ranges.length; i++) {\r\n    var here = this$1.ranges[i], there = other.ranges[i]\r\n    if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\r\n  }\r\n  return true\r\n};\r\n\r\nSelection.prototype.deepCopy = function () {\r\n    var this$1 = this;\r\n\r\n  var out = []\r\n  for (var i = 0; i < this.ranges.length; i++)\r\n    { out[i] = new Range(copyPos(this$1.ranges[i].anchor), copyPos(this$1.ranges[i].head)) }\r\n  return new Selection(out, this.primIndex)\r\n};\r\n\r\nSelection.prototype.somethingSelected = function () {\r\n    var this$1 = this;\r\n\r\n  for (var i = 0; i < this.ranges.length; i++)\r\n    { if (!this$1.ranges[i].empty()) { return true } }\r\n  return false\r\n};\r\n\r\nSelection.prototype.contains = function (pos, end) {\r\n    var this$1 = this;\r\n\r\n  if (!end) { end = pos }\r\n  for (var i = 0; i < this.ranges.length; i++) {\r\n    var range = this$1.ranges[i]\r\n    if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\r\n      { return i }\r\n  }\r\n  return -1\r\n};\r\n\r\nvar Range = function(anchor, head) {\r\n  this.anchor = anchor; this.head = head\r\n};\r\n\r\nRange.prototype.from = function () { return minPos(this.anchor, this.head) };\r\nRange.prototype.to = function () { return maxPos(this.anchor, this.head) };\r\nRange.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\r\n\r\nfunction normalizeSelection(ranges, primIndex) {\r\n  var prim = ranges[primIndex]\r\n  ranges.sort(function (a, b) { return cmp(a.from(), b.from()); })\r\n  primIndex = indexOf(ranges, prim)\r\n  for (var i = 1; i < ranges.length; i++) {\r\n    var cur = ranges[i], prev = ranges[i - 1]\r\n    if (cmp(prev.to(), cur.from()) >= 0) {\r\n      var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to())\r\n      var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head\r\n      if (i <= primIndex) { --primIndex }\r\n      ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to))\r\n    }\r\n  }\r\n  return new Selection(ranges, primIndex)\r\n}\r\n\r\nfunction simpleSelection(anchor, head) {\r\n  return new Selection([new Range(anchor, head || anchor)], 0)\r\n}\r\n\r\nfunction changeEnd(change) {\r\n  if (!change.text) { return change.to }\r\n  return Pos(change.from.line + change.text.length - 1,\r\n             lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\r\n}\r\n\r\nfunction adjustForChange(pos, change) {\r\n  if (cmp(pos, change.from) < 0) { return pos }\r\n  if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\r\n\r\n  var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch\r\n  if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch }\r\n  return Pos(line, ch)\r\n}\r\n\r\nfunction computeSelAfterChange(doc, change) {\r\n  var out = []\r\n  for (var i = 0; i < doc.sel.ranges.length; i++) {\r\n    var range = doc.sel.ranges[i]\r\n    out.push(new Range(adjustForChange(range.anchor, change),\r\n                       adjustForChange(range.head, change)))\r\n  }\r\n  return normalizeSelection(out, doc.sel.primIndex)\r\n}\r\n\r\nfunction offsetPos(pos, old, nw) {\r\n  if (pos.line == old.line)\r\n    { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\r\n  else\r\n    { return Pos(nw.line + (pos.line - old.line), pos.ch) }\r\n}\r\n\r\nfunction computeReplacedSel(doc, changes, hint) {\r\n  var out = []\r\n  var oldPrev = Pos(doc.first, 0), newPrev = oldPrev\r\n  for (var i = 0; i < changes.length; i++) {\r\n    var change = changes[i]\r\n    var from = offsetPos(change.from, oldPrev, newPrev)\r\n    var to = offsetPos(changeEnd(change), oldPrev, newPrev)\r\n    oldPrev = change.to\r\n    newPrev = to\r\n    if (hint == \"around\") {\r\n      var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0\r\n      out[i] = new Range(inv ? to : from, inv ? from : to)\r\n    } else {\r\n      out[i] = new Range(from, from)\r\n    }\r\n  }\r\n  return new Selection(out, doc.sel.primIndex)\r\n}\r\n\r\n\r\nfunction loadMode(cm) {\r\n  cm.doc.mode = getMode(cm.options, cm.doc.modeOption)\r\n  resetModeState(cm)\r\n}\r\n\r\nfunction resetModeState(cm) {\r\n  cm.doc.iter(function (line) {\r\n    if (line.stateAfter) { line.stateAfter = null }\r\n    if (line.styles) { line.styles = null }\r\n  })\r\n  cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first\r\n  startWorker(cm, 100)\r\n  cm.state.modeGen++\r\n  if (cm.curOp) { regChange(cm) }\r\n}\r\n\r\n\r\nfunction isWholeLineUpdate(doc, change) {\r\n  return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\r\n    (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\r\n}\r\n\r\nfunction updateDoc(doc, change, markedSpans, estimateHeight) {\r\n  function spansFor(n) {return markedSpans ? markedSpans[n] : null}\r\n  function update(line, text, spans) {\r\n    updateLine(line, text, spans, estimateHeight)\r\n    signalLater(line, \"change\", line, change)\r\n  }\r\n  function linesFor(start, end) {\r\n    var result = []\r\n    for (var i = start; i < end; ++i)\r\n      { result.push(new Line(text[i], spansFor(i), estimateHeight)) }\r\n    return result\r\n  }\r\n\r\n  var from = change.from, to = change.to, text = change.text\r\n  var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line)\r\n  var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line\r\n\r\n  if (change.full) {\r\n    doc.insert(0, linesFor(0, text.length))\r\n    doc.remove(text.length, doc.size - text.length)\r\n  } else if (isWholeLineUpdate(doc, change)) {\r\n    var added = linesFor(0, text.length - 1)\r\n    update(lastLine, lastLine.text, lastSpans)\r\n    if (nlines) { doc.remove(from.line, nlines) }\r\n    if (added.length) { doc.insert(from.line, added) }\r\n  } else if (firstLine == lastLine) {\r\n    if (text.length == 1) {\r\n      update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans)\r\n    } else {\r\n      var added$1 = linesFor(1, text.length - 1)\r\n      added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight))\r\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0))\r\n      doc.insert(from.line + 1, added$1)\r\n    }\r\n  } else if (text.length == 1) {\r\n    update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0))\r\n    doc.remove(from.line + 1, nlines)\r\n  } else {\r\n    update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0))\r\n    update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans)\r\n    var added$2 = linesFor(1, text.length - 1)\r\n    if (nlines > 1) { doc.remove(from.line + 1, nlines - 1) }\r\n    doc.insert(from.line + 1, added$2)\r\n  }\r\n\r\n  signalLater(doc, \"change\", doc, change)\r\n}\r\n\r\nfunction linkedDocs(doc, f, sharedHistOnly) {\r\n  function propagate(doc, skip, sharedHist) {\r\n    if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\r\n      var rel = doc.linked[i]\r\n      if (rel.doc == skip) { continue }\r\n      var shared = sharedHist && rel.sharedHist\r\n      if (sharedHistOnly && !shared) { continue }\r\n      f(rel.doc, shared)\r\n      propagate(rel.doc, doc, shared)\r\n    } }\r\n  }\r\n  propagate(doc, null, true)\r\n}\r\n\r\nfunction attachDoc(cm, doc) {\r\n  if (doc.cm) { throw new Error(\"This document is already in use.\") }\r\n  cm.doc = doc\r\n  doc.cm = cm\r\n  estimateLineHeights(cm)\r\n  loadMode(cm)\r\n  setDirectionClass(cm)\r\n  if (!cm.options.lineWrapping) { findMaxLine(cm) }\r\n  cm.options.mode = doc.modeOption\r\n  regChange(cm)\r\n}\r\n\r\nfunction setDirectionClass(cm) {\r\n  ;(cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\")\r\n}\r\n\r\nfunction directionChanged(cm) {\r\n  runInOp(cm, function () {\r\n    setDirectionClass(cm)\r\n    regChange(cm)\r\n  })\r\n}\r\n\r\nfunction History(startGen) {\r\n  this.done = []; this.undone = []\r\n  this.undoDepth = Infinity\r\n  this.lastModTime = this.lastSelTime = 0\r\n  this.lastOp = this.lastSelOp = null\r\n  this.lastOrigin = this.lastSelOrigin = null\r\n  this.generation = this.maxGeneration = startGen || 1\r\n}\r\n\r\nfunction historyChangeFromChange(doc, change) {\r\n  var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)}\r\n  attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1)\r\n  linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true)\r\n  return histChange\r\n}\r\n\r\nfunction clearSelectionEvents(array) {\r\n  while (array.length) {\r\n    var last = lst(array)\r\n    if (last.ranges) { array.pop() }\r\n    else { break }\r\n  }\r\n}\r\n\r\nfunction lastChangeEvent(hist, force) {\r\n  if (force) {\r\n    clearSelectionEvents(hist.done)\r\n    return lst(hist.done)\r\n  } else if (hist.done.length && !lst(hist.done).ranges) {\r\n    return lst(hist.done)\r\n  } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\r\n    hist.done.pop()\r\n    return lst(hist.done)\r\n  }\r\n}\r\n\r\nfunction addChangeToHistory(doc, change, selAfter, opId) {\r\n  var hist = doc.history\r\n  hist.undone.length = 0\r\n  var time = +new Date, cur\r\n  var last\r\n\r\n  if ((hist.lastOp == opId ||\r\n       hist.lastOrigin == change.origin && change.origin &&\r\n       ((change.origin.charAt(0) == \"+\" && doc.cm && hist.lastModTime > time - doc.cm.options.historyEventDelay) ||\r\n        change.origin.charAt(0) == \"*\")) &&\r\n      (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\r\n    last = lst(cur.changes)\r\n    if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\r\n      last.to = changeEnd(change)\r\n    } else {\r\n      cur.changes.push(historyChangeFromChange(doc, change))\r\n    }\r\n  } else {\r\n    var before = lst(hist.done)\r\n    if (!before || !before.ranges)\r\n      { pushSelectionToHistory(doc.sel, hist.done) }\r\n    cur = {changes: [historyChangeFromChange(doc, change)],\r\n           generation: hist.generation}\r\n    hist.done.push(cur)\r\n    while (hist.done.length > hist.undoDepth) {\r\n      hist.done.shift()\r\n      if (!hist.done[0].ranges) { hist.done.shift() }\r\n    }\r\n  }\r\n  hist.done.push(selAfter)\r\n  hist.generation = ++hist.maxGeneration\r\n  hist.lastModTime = hist.lastSelTime = time\r\n  hist.lastOp = hist.lastSelOp = opId\r\n  hist.lastOrigin = hist.lastSelOrigin = change.origin\r\n\r\n  if (!last) { signal(doc, \"historyAdded\") }\r\n}\r\n\r\nfunction selectionEventCanBeMerged(doc, origin, prev, sel) {\r\n  var ch = origin.charAt(0)\r\n  return ch == \"*\" ||\r\n    ch == \"+\" &&\r\n    prev.ranges.length == sel.ranges.length &&\r\n    prev.somethingSelected() == sel.somethingSelected() &&\r\n    new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\r\n}\r\n\r\nfunction addSelectionToHistory(doc, sel, opId, options) {\r\n  var hist = doc.history, origin = options && options.origin\r\n\r\n  if (opId == hist.lastSelOp ||\r\n      (origin && hist.lastSelOrigin == origin &&\r\n       (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\r\n        selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\r\n    { hist.done[hist.done.length - 1] = sel }\r\n  else\r\n    { pushSelectionToHistory(sel, hist.done) }\r\n\r\n  hist.lastSelTime = +new Date\r\n  hist.lastSelOrigin = origin\r\n  hist.lastSelOp = opId\r\n  if (options && options.clearRedo !== false)\r\n    { clearSelectionEvents(hist.undone) }\r\n}\r\n\r\nfunction pushSelectionToHistory(sel, dest) {\r\n  var top = lst(dest)\r\n  if (!(top && top.ranges && top.equals(sel)))\r\n    { dest.push(sel) }\r\n}\r\n\r\nfunction attachLocalSpans(doc, change, from, to) {\r\n  var existing = change[\"spans_\" + doc.id], n = 0\r\n  doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\r\n    if (line.markedSpans)\r\n      { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans }\r\n    ++n\r\n  })\r\n}\r\n\r\nfunction removeClearedSpans(spans) {\r\n  if (!spans) { return null }\r\n  var out\r\n  for (var i = 0; i < spans.length; ++i) {\r\n    if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i) } }\r\n    else if (out) { out.push(spans[i]) }\r\n  }\r\n  return !out ? spans : out.length ? out : null\r\n}\r\n\r\nfunction getOldSpans(doc, change) {\r\n  var found = change[\"spans_\" + doc.id]\r\n  if (!found) { return null }\r\n  var nw = []\r\n  for (var i = 0; i < change.text.length; ++i)\r\n    { nw.push(removeClearedSpans(found[i])) }\r\n  return nw\r\n}\r\n\r\nfunction mergeOldSpans(doc, change) {\r\n  var old = getOldSpans(doc, change)\r\n  var stretched = stretchSpansOverChange(doc, change)\r\n  if (!old) { return stretched }\r\n  if (!stretched) { return old }\r\n\r\n  for (var i = 0; i < old.length; ++i) {\r\n    var oldCur = old[i], stretchCur = stretched[i]\r\n    if (oldCur && stretchCur) {\r\n      spans: for (var j = 0; j < stretchCur.length; ++j) {\r\n        var span = stretchCur[j]\r\n        for (var k = 0; k < oldCur.length; ++k)\r\n          { if (oldCur[k].marker == span.marker) { continue spans } }\r\n        oldCur.push(span)\r\n      }\r\n    } else if (stretchCur) {\r\n      old[i] = stretchCur\r\n    }\r\n  }\r\n  return old\r\n}\r\n\r\nfunction copyHistoryArray(events, newGroup, instantiateSel) {\r\n  var copy = []\r\n  for (var i = 0; i < events.length; ++i) {\r\n    var event = events[i]\r\n    if (event.ranges) {\r\n      copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event)\r\n      continue\r\n    }\r\n    var changes = event.changes, newChanges = []\r\n    copy.push({changes: newChanges})\r\n    for (var j = 0; j < changes.length; ++j) {\r\n      var change = changes[j], m = (void 0)\r\n      newChanges.push({from: change.from, to: change.to, text: change.text})\r\n      if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\r\n        if (indexOf(newGroup, Number(m[1])) > -1) {\r\n          lst(newChanges)[prop] = change[prop]\r\n          delete change[prop]\r\n        }\r\n      } } }\r\n    }\r\n  }\r\n  return copy\r\n}\r\n\r\n\r\nfunction extendRange(range, head, other, extend) {\r\n  if (extend) {\r\n    var anchor = range.anchor\r\n    if (other) {\r\n      var posBefore = cmp(head, anchor) < 0\r\n      if (posBefore != (cmp(other, anchor) < 0)) {\r\n        anchor = head\r\n        head = other\r\n      } else if (posBefore != (cmp(head, other) < 0)) {\r\n        head = other\r\n      }\r\n    }\r\n    return new Range(anchor, head)\r\n  } else {\r\n    return new Range(other || head, head)\r\n  }\r\n}\r\n\r\nfunction extendSelection(doc, head, other, options, extend) {\r\n  if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend) }\r\n  setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options)\r\n}\r\n\r\nfunction extendSelections(doc, heads, options) {\r\n  var out = []\r\n  var extend = doc.cm && (doc.cm.display.shift || doc.extend)\r\n  for (var i = 0; i < doc.sel.ranges.length; i++)\r\n    { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend) }\r\n  var newSel = normalizeSelection(out, doc.sel.primIndex)\r\n  setSelection(doc, newSel, options)\r\n}\r\n\r\nfunction replaceOneSelection(doc, i, range, options) {\r\n  var ranges = doc.sel.ranges.slice(0)\r\n  ranges[i] = range\r\n  setSelection(doc, normalizeSelection(ranges, doc.sel.primIndex), options)\r\n}\r\n\r\nfunction setSimpleSelection(doc, anchor, head, options) {\r\n  setSelection(doc, simpleSelection(anchor, head), options)\r\n}\r\n\r\nfunction filterSelectionChange(doc, sel, options) {\r\n  var obj = {\r\n    ranges: sel.ranges,\r\n    update: function(ranges) {\r\n      var this$1 = this;\r\n\r\n      this.ranges = []\r\n      for (var i = 0; i < ranges.length; i++)\r\n        { this$1.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\r\n                                   clipPos(doc, ranges[i].head)) }\r\n    },\r\n    origin: options && options.origin\r\n  }\r\n  signal(doc, \"beforeSelectionChange\", doc, obj)\r\n  if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj) }\r\n  if (obj.ranges != sel.ranges) { return normalizeSelection(obj.ranges, obj.ranges.length - 1) }\r\n  else { return sel }\r\n}\r\n\r\nfunction setSelectionReplaceHistory(doc, sel, options) {\r\n  var done = doc.history.done, last = lst(done)\r\n  if (last && last.ranges) {\r\n    done[done.length - 1] = sel\r\n    setSelectionNoUndo(doc, sel, options)\r\n  } else {\r\n    setSelection(doc, sel, options)\r\n  }\r\n}\r\n\r\nfunction setSelection(doc, sel, options) {\r\n  setSelectionNoUndo(doc, sel, options)\r\n  addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options)\r\n}\r\n\r\nfunction setSelectionNoUndo(doc, sel, options) {\r\n  if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\r\n    { sel = filterSelectionChange(doc, sel, options) }\r\n\r\n  var bias = options && options.bias ||\r\n    (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1)\r\n  setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true))\r\n\r\n  if (!(options && options.scroll === false) && doc.cm)\r\n    { ensureCursorVisible(doc.cm) }\r\n}\r\n\r\nfunction setSelectionInner(doc, sel) {\r\n  if (sel.equals(doc.sel)) { return }\r\n\r\n  doc.sel = sel\r\n\r\n  if (doc.cm) {\r\n    doc.cm.curOp.updateInput = doc.cm.curOp.selectionChanged = true\r\n    signalCursorActivity(doc.cm)\r\n  }\r\n  signalLater(doc, \"cursorActivity\", doc)\r\n}\r\n\r\nfunction reCheckSelection(doc) {\r\n  setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false))\r\n}\r\n\r\nfunction skipAtomicInSelection(doc, sel, bias, mayClear) {\r\n  var out\r\n  for (var i = 0; i < sel.ranges.length; i++) {\r\n    var range = sel.ranges[i]\r\n    var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i]\r\n    var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear)\r\n    var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear)\r\n    if (out || newAnchor != range.anchor || newHead != range.head) {\r\n      if (!out) { out = sel.ranges.slice(0, i) }\r\n      out[i] = new Range(newAnchor, newHead)\r\n    }\r\n  }\r\n  return out ? normalizeSelection(out, sel.primIndex) : sel\r\n}\r\n\r\nfunction skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\r\n  var line = getLine(doc, pos.line)\r\n  if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\r\n    var sp = line.markedSpans[i], m = sp.marker\r\n    if ((sp.from == null || (m.inclusiveLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\r\n        (sp.to == null || (m.inclusiveRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\r\n      if (mayClear) {\r\n        signal(m, \"beforeCursorEnter\")\r\n        if (m.explicitlyCleared) {\r\n          if (!line.markedSpans) { break }\r\n          else {--i; continue}\r\n        }\r\n      }\r\n      if (!m.atomic) { continue }\r\n\r\n      if (oldPos) {\r\n        var near = m.find(dir < 0 ? 1 : -1), diff = (void 0)\r\n        if (dir < 0 ? m.inclusiveRight : m.inclusiveLeft)\r\n          { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null) }\r\n        if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\r\n          { return skipAtomicInner(doc, near, pos, dir, mayClear) }\r\n      }\r\n\r\n      var far = m.find(dir < 0 ? -1 : 1)\r\n      if (dir < 0 ? m.inclusiveLeft : m.inclusiveRight)\r\n        { far = movePos(doc, far, dir, far.line == pos.line ? line : null) }\r\n      return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\r\n    }\r\n  } }\r\n  return pos\r\n}\r\n\r\nfunction skipAtomic(doc, pos, oldPos, bias, mayClear) {\r\n  var dir = bias || 1\r\n  var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\r\n      (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\r\n      skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\r\n      (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true))\r\n  if (!found) {\r\n    doc.cantEdit = true\r\n    return Pos(doc.first, 0)\r\n  }\r\n  return found\r\n}\r\n\r\nfunction movePos(doc, pos, dir, line) {\r\n  if (dir < 0 && pos.ch == 0) {\r\n    if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\r\n    else { return null }\r\n  } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\r\n    if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\r\n    else { return null }\r\n  } else {\r\n    return new Pos(pos.line, pos.ch + dir)\r\n  }\r\n}\r\n\r\nfunction selectAll(cm) {\r\n  cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll)\r\n}\r\n\r\n\r\nfunction filterChange(doc, change, update) {\r\n  var obj = {\r\n    canceled: false,\r\n    from: change.from,\r\n    to: change.to,\r\n    text: change.text,\r\n    origin: change.origin,\r\n    cancel: function () { return obj.canceled = true; }\r\n  }\r\n  if (update) { obj.update = function (from, to, text, origin) {\r\n    if (from) { obj.from = clipPos(doc, from) }\r\n    if (to) { obj.to = clipPos(doc, to) }\r\n    if (text) { obj.text = text }\r\n    if (origin !== undefined) { obj.origin = origin }\r\n  } }\r\n  signal(doc, \"beforeChange\", doc, obj)\r\n  if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj) }\r\n\r\n  if (obj.canceled) { return null }\r\n  return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\r\n}\r\n\r\nfunction makeChange(doc, change, ignoreReadOnly) {\r\n  if (doc.cm) {\r\n    if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\r\n    if (doc.cm.state.suppressEdits) { return }\r\n  }\r\n\r\n  if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\r\n    change = filterChange(doc, change, true)\r\n    if (!change) { return }\r\n  }\r\n\r\n  var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to)\r\n  if (split) {\r\n    for (var i = split.length - 1; i >= 0; --i)\r\n      { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text, origin: change.origin}) }\r\n  } else {\r\n    makeChangeInner(doc, change)\r\n  }\r\n}\r\n\r\nfunction makeChangeInner(doc, change) {\r\n  if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\r\n  var selAfter = computeSelAfterChange(doc, change)\r\n  addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN)\r\n\r\n  makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change))\r\n  var rebased = []\r\n\r\n  linkedDocs(doc, function (doc, sharedHist) {\r\n    if (!sharedHist && indexOf(rebased, doc.history) == -1) {\r\n      rebaseHist(doc.history, change)\r\n      rebased.push(doc.history)\r\n    }\r\n    makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change))\r\n  })\r\n}\r\n\r\nfunction makeChangeFromHistory(doc, type, allowSelectionOnly) {\r\n  if (doc.cm && doc.cm.state.suppressEdits && !allowSelectionOnly) { return }\r\n\r\n  var hist = doc.history, event, selAfter = doc.sel\r\n  var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done\r\n\r\n  var i = 0\r\n  for (; i < source.length; i++) {\r\n    event = source[i]\r\n    if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\r\n      { break }\r\n  }\r\n  if (i == source.length) { return }\r\n  hist.lastOrigin = hist.lastSelOrigin = null\r\n\r\n  for (;;) {\r\n    event = source.pop()\r\n    if (event.ranges) {\r\n      pushSelectionToHistory(event, dest)\r\n      if (allowSelectionOnly && !event.equals(doc.sel)) {\r\n        setSelection(doc, event, {clearRedo: false})\r\n        return\r\n      }\r\n      selAfter = event\r\n    }\r\n    else { break }\r\n  }\r\n\r\n  var antiChanges = []\r\n  pushSelectionToHistory(selAfter, dest)\r\n  dest.push({changes: antiChanges, generation: hist.generation})\r\n  hist.generation = event.generation || ++hist.maxGeneration\r\n\r\n  var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")\r\n\r\n  var loop = function ( i ) {\r\n    var change = event.changes[i]\r\n    change.origin = type\r\n    if (filter && !filterChange(doc, change, false)) {\r\n      source.length = 0\r\n      return {}\r\n    }\r\n\r\n    antiChanges.push(historyChangeFromChange(doc, change))\r\n\r\n    var after = i ? computeSelAfterChange(doc, change) : lst(source)\r\n    makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change))\r\n    if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}) }\r\n    var rebased = []\r\n\r\n    linkedDocs(doc, function (doc, sharedHist) {\r\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\r\n        rebaseHist(doc.history, change)\r\n        rebased.push(doc.history)\r\n      }\r\n      makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change))\r\n    })\r\n  };\r\n\r\n  for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\r\n    var returned = loop( i$1 );\r\n\r\n    if ( returned ) return returned.v;\r\n  }\r\n}\r\n\r\nfunction shiftDoc(doc, distance) {\r\n  if (distance == 0) { return }\r\n  doc.first += distance\r\n  doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\r\n    Pos(range.anchor.line + distance, range.anchor.ch),\r\n    Pos(range.head.line + distance, range.head.ch)\r\n  ); }), doc.sel.primIndex)\r\n  if (doc.cm) {\r\n    regChange(doc.cm, doc.first, doc.first - distance, distance)\r\n    for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\r\n      { regLineChange(doc.cm, l, \"gutter\") }\r\n  }\r\n}\r\n\r\nfunction makeChangeSingleDoc(doc, change, selAfter, spans) {\r\n  if (doc.cm && !doc.cm.curOp)\r\n    { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\r\n\r\n  if (change.to.line < doc.first) {\r\n    shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line))\r\n    return\r\n  }\r\n  if (change.from.line > doc.lastLine()) { return }\r\n\r\n  if (change.from.line < doc.first) {\r\n    var shift = change.text.length - 1 - (doc.first - change.from.line)\r\n    shiftDoc(doc, shift)\r\n    change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\r\n              text: [lst(change.text)], origin: change.origin}\r\n  }\r\n  var last = doc.lastLine()\r\n  if (change.to.line > last) {\r\n    change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\r\n              text: [change.text[0]], origin: change.origin}\r\n  }\r\n\r\n  change.removed = getBetween(doc, change.from, change.to)\r\n\r\n  if (!selAfter) { selAfter = computeSelAfterChange(doc, change) }\r\n  if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans) }\r\n  else { updateDoc(doc, change, spans) }\r\n  setSelectionNoUndo(doc, selAfter, sel_dontScroll)\r\n}\r\n\r\nfunction makeChangeSingleDocInEditor(cm, change, spans) {\r\n  var doc = cm.doc, display = cm.display, from = change.from, to = change.to\r\n\r\n  var recomputeMaxLength = false, checkWidthStart = from.line\r\n  if (!cm.options.lineWrapping) {\r\n    checkWidthStart = lineNo(visualLine(getLine(doc, from.line)))\r\n    doc.iter(checkWidthStart, to.line + 1, function (line) {\r\n      if (line == display.maxLine) {\r\n        recomputeMaxLength = true\r\n        return true\r\n      }\r\n    })\r\n  }\r\n\r\n  if (doc.sel.contains(change.from, change.to) > -1)\r\n    { signalCursorActivity(cm) }\r\n\r\n  updateDoc(doc, change, spans, estimateHeight(cm))\r\n\r\n  if (!cm.options.lineWrapping) {\r\n    doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\r\n      var len = lineLength(line)\r\n      if (len > display.maxLineLength) {\r\n        display.maxLine = line\r\n        display.maxLineLength = len\r\n        display.maxLineChanged = true\r\n        recomputeMaxLength = false\r\n      }\r\n    })\r\n    if (recomputeMaxLength) { cm.curOp.updateMaxLine = true }\r\n  }\r\n\r\n  retreatFrontier(doc, from.line)\r\n  startWorker(cm, 400)\r\n\r\n  var lendiff = change.text.length - (to.line - from.line) - 1\r\n  if (change.full)\r\n    { regChange(cm) }\r\n  else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\r\n    { regLineChange(cm, from.line, \"text\") }\r\n  else\r\n    { regChange(cm, from.line, to.line + 1, lendiff) }\r\n\r\n  var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\")\r\n  if (changeHandler || changesHandler) {\r\n    var obj = {\r\n      from: from, to: to,\r\n      text: change.text,\r\n      removed: change.removed,\r\n      origin: change.origin\r\n    }\r\n    if (changeHandler) { signalLater(cm, \"change\", cm, obj) }\r\n    if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj) }\r\n  }\r\n  cm.display.selForContextMenu = null\r\n}\r\n\r\nfunction replaceRange(doc, code, from, to, origin) {\r\n  if (!to) { to = from }\r\n  if (cmp(to, from) < 0) { var assign;\r\n    (assign = [to, from], from = assign[0], to = assign[1], assign) }\r\n  if (typeof code == \"string\") { code = doc.splitLines(code) }\r\n  makeChange(doc, {from: from, to: to, text: code, origin: origin})\r\n}\r\n\r\n\r\nfunction rebaseHistSelSingle(pos, from, to, diff) {\r\n  if (to < pos.line) {\r\n    pos.line += diff\r\n  } else if (from < pos.line) {\r\n    pos.line = from\r\n    pos.ch = 0\r\n  }\r\n}\r\n\r\nfunction rebaseHistArray(array, from, to, diff) {\r\n  for (var i = 0; i < array.length; ++i) {\r\n    var sub = array[i], ok = true\r\n    if (sub.ranges) {\r\n      if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true }\r\n      for (var j = 0; j < sub.ranges.length; j++) {\r\n        rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff)\r\n        rebaseHistSelSingle(sub.ranges[j].head, from, to, diff)\r\n      }\r\n      continue\r\n    }\r\n    for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\r\n      var cur = sub.changes[j$1]\r\n      if (to < cur.from.line) {\r\n        cur.from = Pos(cur.from.line + diff, cur.from.ch)\r\n        cur.to = Pos(cur.to.line + diff, cur.to.ch)\r\n      } else if (from <= cur.to.line) {\r\n        ok = false\r\n        break\r\n      }\r\n    }\r\n    if (!ok) {\r\n      array.splice(0, i + 1)\r\n      i = 0\r\n    }\r\n  }\r\n}\r\n\r\nfunction rebaseHist(hist, change) {\r\n  var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1\r\n  rebaseHistArray(hist.done, from, to, diff)\r\n  rebaseHistArray(hist.undone, from, to, diff)\r\n}\r\n\r\nfunction changeLine(doc, handle, changeType, op) {\r\n  var no = handle, line = handle\r\n  if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)) }\r\n  else { no = lineNo(handle) }\r\n  if (no == null) { return null }\r\n  if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType) }\r\n  return line\r\n}\r\n\r\n\r\nfunction LeafChunk(lines) {\r\n  var this$1 = this;\r\n\r\n  this.lines = lines\r\n  this.parent = null\r\n  var height = 0\r\n  for (var i = 0; i < lines.length; ++i) {\r\n    lines[i].parent = this$1\r\n    height += lines[i].height\r\n  }\r\n  this.height = height\r\n}\r\n\r\nLeafChunk.prototype = {\r\n  chunkSize: function chunkSize() { return this.lines.length },\r\n\r\n  removeInner: function removeInner(at, n) {\r\n    var this$1 = this;\r\n\r\n    for (var i = at, e = at + n; i < e; ++i) {\r\n      var line = this$1.lines[i]\r\n      this$1.height -= line.height\r\n      cleanUpLine(line)\r\n      signalLater(line, \"delete\")\r\n    }\r\n    this.lines.splice(at, n)\r\n  },\r\n\r\n  collapse: function collapse(lines) {\r\n    lines.push.apply(lines, this.lines)\r\n  },\r\n\r\n  insertInner: function insertInner(at, lines, height) {\r\n    var this$1 = this;\r\n\r\n    this.height += height\r\n    this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at))\r\n    for (var i = 0; i < lines.length; ++i) { lines[i].parent = this$1 }\r\n  },\r\n\r\n  iterN: function iterN(at, n, op) {\r\n    var this$1 = this;\r\n\r\n    for (var e = at + n; at < e; ++at)\r\n      { if (op(this$1.lines[at])) { return true } }\r\n  }\r\n}\r\n\r\nfunction BranchChunk(children) {\r\n  var this$1 = this;\r\n\r\n  this.children = children\r\n  var size = 0, height = 0\r\n  for (var i = 0; i < children.length; ++i) {\r\n    var ch = children[i]\r\n    size += ch.chunkSize(); height += ch.height\r\n    ch.parent = this$1\r\n  }\r\n  this.size = size\r\n  this.height = height\r\n  this.parent = null\r\n}\r\n\r\nBranchChunk.prototype = {\r\n  chunkSize: function chunkSize() { return this.size },\r\n\r\n  removeInner: function removeInner(at, n) {\r\n    var this$1 = this;\r\n\r\n    this.size -= n\r\n    for (var i = 0; i < this.children.length; ++i) {\r\n      var child = this$1.children[i], sz = child.chunkSize()\r\n      if (at < sz) {\r\n        var rm = Math.min(n, sz - at), oldHeight = child.height\r\n        child.removeInner(at, rm)\r\n        this$1.height -= oldHeight - child.height\r\n        if (sz == rm) { this$1.children.splice(i--, 1); child.parent = null }\r\n        if ((n -= rm) == 0) { break }\r\n        at = 0\r\n      } else { at -= sz }\r\n    }\r\n    if (this.size - n < 25 &&\r\n        (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\r\n      var lines = []\r\n      this.collapse(lines)\r\n      this.children = [new LeafChunk(lines)]\r\n      this.children[0].parent = this\r\n    }\r\n  },\r\n\r\n  collapse: function collapse(lines) {\r\n    var this$1 = this;\r\n\r\n    for (var i = 0; i < this.children.length; ++i) { this$1.children[i].collapse(lines) }\r\n  },\r\n\r\n  insertInner: function insertInner(at, lines, height) {\r\n    var this$1 = this;\r\n\r\n    this.size += lines.length\r\n    this.height += height\r\n    for (var i = 0; i < this.children.length; ++i) {\r\n      var child = this$1.children[i], sz = child.chunkSize()\r\n      if (at <= sz) {\r\n        child.insertInner(at, lines, height)\r\n        if (child.lines && child.lines.length > 50) {\r\n          var remaining = child.lines.length % 25 + 25\r\n          for (var pos = remaining; pos < child.lines.length;) {\r\n            var leaf = new LeafChunk(child.lines.slice(pos, pos += 25))\r\n            child.height -= leaf.height\r\n            this$1.children.splice(++i, 0, leaf)\r\n            leaf.parent = this$1\r\n          }\r\n          child.lines = child.lines.slice(0, remaining)\r\n          this$1.maybeSpill()\r\n        }\r\n        break\r\n      }\r\n      at -= sz\r\n    }\r\n  },\r\n\r\n  maybeSpill: function maybeSpill() {\r\n    if (this.children.length <= 10) { return }\r\n    var me = this\r\n    do {\r\n      var spilled = me.children.splice(me.children.length - 5, 5)\r\n      var sibling = new BranchChunk(spilled)\r\n      if (!me.parent) { \r\n        var copy = new BranchChunk(me.children)\r\n        copy.parent = me\r\n        me.children = [copy, sibling]\r\n        me = copy\r\n     } else {\r\n        me.size -= sibling.size\r\n        me.height -= sibling.height\r\n        var myIndex = indexOf(me.parent.children, me)\r\n        me.parent.children.splice(myIndex + 1, 0, sibling)\r\n      }\r\n      sibling.parent = me.parent\r\n    } while (me.children.length > 10)\r\n    me.parent.maybeSpill()\r\n  },\r\n\r\n  iterN: function iterN(at, n, op) {\r\n    var this$1 = this;\r\n\r\n    for (var i = 0; i < this.children.length; ++i) {\r\n      var child = this$1.children[i], sz = child.chunkSize()\r\n      if (at < sz) {\r\n        var used = Math.min(n, sz - at)\r\n        if (child.iterN(at, used, op)) { return true }\r\n        if ((n -= used) == 0) { break }\r\n        at = 0\r\n      } else { at -= sz }\r\n    }\r\n  }\r\n}\r\n\r\n\r\nvar LineWidget = function(doc, node, options) {\r\n  var this$1 = this;\r\n\r\n  if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\r\n    { this$1[opt] = options[opt] } } }\r\n  this.doc = doc\r\n  this.node = node\r\n};\r\n\r\nLineWidget.prototype.clear = function () {\r\n    var this$1 = this;\r\n\r\n  var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line)\r\n  if (no == null || !ws) { return }\r\n  for (var i = 0; i < ws.length; ++i) { if (ws[i] == this$1) { ws.splice(i--, 1) } }\r\n  if (!ws.length) { line.widgets = null }\r\n  var height = widgetHeight(this)\r\n  updateLineHeight(line, Math.max(0, line.height - height))\r\n  if (cm) {\r\n    runInOp(cm, function () {\r\n      adjustScrollWhenAboveVisible(cm, line, -height)\r\n      regLineChange(cm, no, \"widget\")\r\n    })\r\n    signalLater(cm, \"lineWidgetCleared\", cm, this, no)\r\n  }\r\n};\r\n\r\nLineWidget.prototype.changed = function () {\r\n    var this$1 = this;\r\n\r\n  var oldH = this.height, cm = this.doc.cm, line = this.line\r\n  this.height = null\r\n  var diff = widgetHeight(this) - oldH\r\n  if (!diff) { return }\r\n  updateLineHeight(line, line.height + diff)\r\n  if (cm) {\r\n    runInOp(cm, function () {\r\n      cm.curOp.forceUpdate = true\r\n      adjustScrollWhenAboveVisible(cm, line, diff)\r\n      signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line))\r\n    })\r\n  }\r\n};\r\neventMixin(LineWidget)\r\n\r\nfunction adjustScrollWhenAboveVisible(cm, line, diff) {\r\n  if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\r\n    { addToScrollTop(cm, diff) }\r\n}\r\n\r\nfunction addLineWidget(doc, handle, node, options) {\r\n  var widget = new LineWidget(doc, node, options)\r\n  var cm = doc.cm\r\n  if (cm && widget.noHScroll) { cm.display.alignWidgets = true }\r\n  changeLine(doc, handle, \"widget\", function (line) {\r\n    var widgets = line.widgets || (line.widgets = [])\r\n    if (widget.insertAt == null) { widgets.push(widget) }\r\n    else { widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget) }\r\n    widget.line = line\r\n    if (cm && !lineIsHidden(doc, line)) {\r\n      var aboveVisible = heightAtLine(line) < doc.scrollTop\r\n      updateLineHeight(line, line.height + widgetHeight(widget))\r\n      if (aboveVisible) { addToScrollTop(cm, widget.height) }\r\n      cm.curOp.forceUpdate = true\r\n    }\r\n    return true\r\n  })\r\n  signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle))\r\n  return widget\r\n}\r\n\r\n\r\n\r\nvar nextMarkerId = 0\r\n\r\nvar TextMarker = function(doc, type) {\r\n  this.lines = []\r\n  this.type = type\r\n  this.doc = doc\r\n  this.id = ++nextMarkerId\r\n};\r\n\r\nTextMarker.prototype.clear = function () {\r\n    var this$1 = this;\r\n\r\n  if (this.explicitlyCleared) { return }\r\n  var cm = this.doc.cm, withOp = cm && !cm.curOp\r\n  if (withOp) { startOperation(cm) }\r\n  if (hasHandler(this, \"clear\")) {\r\n    var found = this.find()\r\n    if (found) { signalLater(this, \"clear\", found.from, found.to) }\r\n  }\r\n  var min = null, max = null\r\n  for (var i = 0; i < this.lines.length; ++i) {\r\n    var line = this$1.lines[i]\r\n    var span = getMarkedSpanFor(line.markedSpans, this$1)\r\n    if (cm && !this$1.collapsed) { regLineChange(cm, lineNo(line), \"text\") }\r\n    else if (cm) {\r\n      if (span.to != null) { max = lineNo(line) }\r\n      if (span.from != null) { min = lineNo(line) }\r\n    }\r\n    line.markedSpans = removeMarkedSpan(line.markedSpans, span)\r\n    if (span.from == null && this$1.collapsed && !lineIsHidden(this$1.doc, line) && cm)\r\n      { updateLineHeight(line, textHeight(cm.display)) }\r\n  }\r\n  if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\r\n    var visual = visualLine(this$1.lines[i$1]), len = lineLength(visual)\r\n    if (len > cm.display.maxLineLength) {\r\n      cm.display.maxLine = visual\r\n      cm.display.maxLineLength = len\r\n      cm.display.maxLineChanged = true\r\n    }\r\n  } }\r\n\r\n  if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1) }\r\n  this.lines.length = 0\r\n  this.explicitlyCleared = true\r\n  if (this.atomic && this.doc.cantEdit) {\r\n    this.doc.cantEdit = false\r\n    if (cm) { reCheckSelection(cm.doc) }\r\n  }\r\n  if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max) }\r\n  if (withOp) { endOperation(cm) }\r\n  if (this.parent) { this.parent.clear() }\r\n};\r\n\r\nTextMarker.prototype.find = function (side, lineObj) {\r\n    var this$1 = this;\r\n\r\n  if (side == null && this.type == \"bookmark\") { side = 1 }\r\n  var from, to\r\n  for (var i = 0; i < this.lines.length; ++i) {\r\n    var line = this$1.lines[i]\r\n    var span = getMarkedSpanFor(line.markedSpans, this$1)\r\n    if (span.from != null) {\r\n      from = Pos(lineObj ? line : lineNo(line), span.from)\r\n      if (side == -1) { return from }\r\n    }\r\n    if (span.to != null) {\r\n      to = Pos(lineObj ? line : lineNo(line), span.to)\r\n      if (side == 1) { return to }\r\n    }\r\n  }\r\n  return from && {from: from, to: to}\r\n};\r\n\r\nTextMarker.prototype.changed = function () {\r\n    var this$1 = this;\r\n\r\n  var pos = this.find(-1, true), widget = this, cm = this.doc.cm\r\n  if (!pos || !cm) { return }\r\n  runInOp(cm, function () {\r\n    var line = pos.line, lineN = lineNo(pos.line)\r\n    var view = findViewForLine(cm, lineN)\r\n    if (view) {\r\n      clearLineMeasurementCacheFor(view)\r\n      cm.curOp.selectionChanged = cm.curOp.forceUpdate = true\r\n    }\r\n    cm.curOp.updateMaxLine = true\r\n    if (!lineIsHidden(widget.doc, line) && widget.height != null) {\r\n      var oldHeight = widget.height\r\n      widget.height = null\r\n      var dHeight = widgetHeight(widget) - oldHeight\r\n      if (dHeight)\r\n        { updateLineHeight(line, line.height + dHeight) }\r\n    }\r\n    signalLater(cm, \"markerChanged\", cm, this$1)\r\n  })\r\n};\r\n\r\nTextMarker.prototype.attachLine = function (line) {\r\n  if (!this.lines.length && this.doc.cm) {\r\n    var op = this.doc.cm.curOp\r\n    if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\r\n      { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this) }\r\n  }\r\n  this.lines.push(line)\r\n};\r\n\r\nTextMarker.prototype.detachLine = function (line) {\r\n  this.lines.splice(indexOf(this.lines, line), 1)\r\n  if (!this.lines.length && this.doc.cm) {\r\n    var op = this.doc.cm.curOp\r\n    ;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this)\r\n  }\r\n};\r\neventMixin(TextMarker)\r\n\r\nfunction markText(doc, from, to, options, type) {\r\n  if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\r\n  if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\r\n\r\n  var marker = new TextMarker(doc, type), diff = cmp(from, to)\r\n  if (options) { copyObj(options, marker, false) }\r\n  if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\r\n    { return marker }\r\n  if (marker.replacedWith) {\r\n    marker.collapsed = true\r\n    marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\")\r\n    if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\") }\r\n    if (options.insertLeft) { marker.widgetNode.insertLeft = true }\r\n  }\r\n  if (marker.collapsed) {\r\n    if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\r\n        from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\r\n      { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\r\n    seeCollapsedSpans()\r\n  }\r\n\r\n  if (marker.addToHistory)\r\n    { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN) }\r\n\r\n  var curLine = from.line, cm = doc.cm, updateMaxLine\r\n  doc.iter(curLine, to.line + 1, function (line) {\r\n    if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\r\n      { updateMaxLine = true }\r\n    if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0) }\r\n    addMarkedSpan(line, new MarkedSpan(marker,\r\n                                       curLine == from.line ? from.ch : null,\r\n                                       curLine == to.line ? to.ch : null))\r\n    ++curLine\r\n  })\r\n  if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\r\n    if (lineIsHidden(doc, line)) { updateLineHeight(line, 0) }\r\n  }) }\r\n\r\n  if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }) }\r\n\r\n  if (marker.readOnly) {\r\n    seeReadOnlySpans()\r\n    if (doc.history.done.length || doc.history.undone.length)\r\n      { doc.clearHistory() }\r\n  }\r\n  if (marker.collapsed) {\r\n    marker.id = ++nextMarkerId\r\n    marker.atomic = true\r\n  }\r\n  if (cm) {\r\n    if (updateMaxLine) { cm.curOp.updateMaxLine = true }\r\n    if (marker.collapsed)\r\n      { regChange(cm, from.line, to.line + 1) }\r\n    else if (marker.className || marker.title || marker.startStyle || marker.endStyle || marker.css)\r\n      { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\") } }\r\n    if (marker.atomic) { reCheckSelection(cm.doc) }\r\n    signalLater(cm, \"markerAdded\", cm, marker)\r\n  }\r\n  return marker\r\n}\r\n\r\n\r\nvar SharedTextMarker = function(markers, primary) {\r\n  var this$1 = this;\r\n\r\n  this.markers = markers\r\n  this.primary = primary\r\n  for (var i = 0; i < markers.length; ++i)\r\n    { markers[i].parent = this$1 }\r\n};\r\n\r\nSharedTextMarker.prototype.clear = function () {\r\n    var this$1 = this;\r\n\r\n  if (this.explicitlyCleared) { return }\r\n  this.explicitlyCleared = true\r\n  for (var i = 0; i < this.markers.length; ++i)\r\n    { this$1.markers[i].clear() }\r\n  signalLater(this, \"clear\")\r\n};\r\n\r\nSharedTextMarker.prototype.find = function (side, lineObj) {\r\n  return this.primary.find(side, lineObj)\r\n};\r\neventMixin(SharedTextMarker)\r\n\r\nfunction markTextShared(doc, from, to, options, type) {\r\n  options = copyObj(options)\r\n  options.shared = false\r\n  var markers = [markText(doc, from, to, options, type)], primary = markers[0]\r\n  var widget = options.widgetNode\r\n  linkedDocs(doc, function (doc) {\r\n    if (widget) { options.widgetNode = widget.cloneNode(true) }\r\n    markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type))\r\n    for (var i = 0; i < doc.linked.length; ++i)\r\n      { if (doc.linked[i].isParent) { return } }\r\n    primary = lst(markers)\r\n  })\r\n  return new SharedTextMarker(markers, primary)\r\n}\r\n\r\nfunction findSharedMarkers(doc) {\r\n  return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\r\n}\r\n\r\nfunction copySharedMarkers(doc, markers) {\r\n  for (var i = 0; i < markers.length; i++) {\r\n    var marker = markers[i], pos = marker.find()\r\n    var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to)\r\n    if (cmp(mFrom, mTo)) {\r\n      var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type)\r\n      marker.markers.push(subMark)\r\n      subMark.parent = marker\r\n    }\r\n  }\r\n}\r\n\r\nfunction detachSharedMarkers(markers) {\r\n  var loop = function ( i ) {\r\n    var marker = markers[i], linked = [marker.primary.doc]\r\n    linkedDocs(marker.primary.doc, function (d) { return linked.push(d); })\r\n    for (var j = 0; j < marker.markers.length; j++) {\r\n      var subMarker = marker.markers[j]\r\n      if (indexOf(linked, subMarker.doc) == -1) {\r\n        subMarker.parent = null\r\n        marker.markers.splice(j--, 1)\r\n      }\r\n    }\r\n  };\r\n\r\n  for (var i = 0; i < markers.length; i++) loop( i );\r\n}\r\n\r\nvar nextDocId = 0\r\nvar Doc = function(text, mode, firstLine, lineSep, direction) {\r\n  if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\r\n  if (firstLine == null) { firstLine = 0 }\r\n\r\n  BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])])\r\n  this.first = firstLine\r\n  this.scrollTop = this.scrollLeft = 0\r\n  this.cantEdit = false\r\n  this.cleanGeneration = 1\r\n  this.modeFrontier = this.highlightFrontier = firstLine\r\n  var start = Pos(firstLine, 0)\r\n  this.sel = simpleSelection(start)\r\n  this.history = new History(null)\r\n  this.id = ++nextDocId\r\n  this.modeOption = mode\r\n  this.lineSep = lineSep\r\n  this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\"\r\n  this.extend = false\r\n\r\n  if (typeof text == \"string\") { text = this.splitLines(text) }\r\n  updateDoc(this, {from: start, to: start, text: text})\r\n  setSelection(this, simpleSelection(start), sel_dontScroll)\r\n}\r\n\r\nDoc.prototype = createObj(BranchChunk.prototype, {\r\n  constructor: Doc,\r\n  iter: function(from, to, op) {\r\n    if (op) { this.iterN(from - this.first, to - from, op) }\r\n    else { this.iterN(this.first, this.first + this.size, from) }\r\n  },\r\n\r\n  insert: function(at, lines) {\r\n    var height = 0\r\n    for (var i = 0; i < lines.length; ++i) { height += lines[i].height }\r\n    this.insertInner(at - this.first, lines, height)\r\n  },\r\n  remove: function(at, n) { this.removeInner(at - this.first, n) },\r\n\r\n\r\n  getValue: function(lineSep) {\r\n    var lines = getLines(this, this.first, this.first + this.size)\r\n    if (lineSep === false) { return lines }\r\n    return lines.join(lineSep || this.lineSeparator())\r\n  },\r\n  setValue: docMethodOp(function(code) {\r\n    var top = Pos(this.first, 0), last = this.first + this.size - 1\r\n    makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\r\n                      text: this.splitLines(code), origin: \"setValue\", full: true}, true)\r\n    if (this.cm) { scrollToCoords(this.cm, 0, 0) }\r\n    setSelection(this, simpleSelection(top), sel_dontScroll)\r\n  }),\r\n  replaceRange: function(code, from, to, origin) {\r\n    from = clipPos(this, from)\r\n    to = to ? clipPos(this, to) : from\r\n    replaceRange(this, code, from, to, origin)\r\n  },\r\n  getRange: function(from, to, lineSep) {\r\n    var lines = getBetween(this, clipPos(this, from), clipPos(this, to))\r\n    if (lineSep === false) { return lines }\r\n    return lines.join(lineSep || this.lineSeparator())\r\n  },\r\n\r\n  getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\r\n\r\n  getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\r\n  getLineNumber: function(line) {return lineNo(line)},\r\n\r\n  getLineHandleVisualStart: function(line) {\r\n    if (typeof line == \"number\") { line = getLine(this, line) }\r\n    return visualLine(line)\r\n  },\r\n\r\n  lineCount: function() {return this.size},\r\n  firstLine: function() {return this.first},\r\n  lastLine: function() {return this.first + this.size - 1},\r\n\r\n  clipPos: function(pos) {return clipPos(this, pos)},\r\n\r\n  getCursor: function(start) {\r\n    var range = this.sel.primary(), pos\r\n    if (start == null || start == \"head\") { pos = range.head }\r\n    else if (start == \"anchor\") { pos = range.anchor }\r\n    else if (start == \"end\" || start == \"to\" || start === false) { pos = range.to() }\r\n    else { pos = range.from() }\r\n    return pos\r\n  },\r\n  listSelections: function() { return this.sel.ranges },\r\n  somethingSelected: function() {return this.sel.somethingSelected()},\r\n\r\n  setCursor: docMethodOp(function(line, ch, options) {\r\n    setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options)\r\n  }),\r\n  setSelection: docMethodOp(function(anchor, head, options) {\r\n    setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options)\r\n  }),\r\n  extendSelection: docMethodOp(function(head, other, options) {\r\n    extendSelection(this, clipPos(this, head), other && clipPos(this, other), options)\r\n  }),\r\n  extendSelections: docMethodOp(function(heads, options) {\r\n    extendSelections(this, clipPosArray(this, heads), options)\r\n  }),\r\n  extendSelectionsBy: docMethodOp(function(f, options) {\r\n    var heads = map(this.sel.ranges, f)\r\n    extendSelections(this, clipPosArray(this, heads), options)\r\n  }),\r\n  setSelections: docMethodOp(function(ranges, primary, options) {\r\n    var this$1 = this;\r\n\r\n    if (!ranges.length) { return }\r\n    var out = []\r\n    for (var i = 0; i < ranges.length; i++)\r\n      { out[i] = new Range(clipPos(this$1, ranges[i].anchor),\r\n                         clipPos(this$1, ranges[i].head)) }\r\n    if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex) }\r\n    setSelection(this, normalizeSelection(out, primary), options)\r\n  }),\r\n  addSelection: docMethodOp(function(anchor, head, options) {\r\n    var ranges = this.sel.ranges.slice(0)\r\n    ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)))\r\n    setSelection(this, normalizeSelection(ranges, ranges.length - 1), options)\r\n  }),\r\n\r\n  getSelection: function(lineSep) {\r\n    var this$1 = this;\r\n\r\n    var ranges = this.sel.ranges, lines\r\n    for (var i = 0; i < ranges.length; i++) {\r\n      var sel = getBetween(this$1, ranges[i].from(), ranges[i].to())\r\n      lines = lines ? lines.concat(sel) : sel\r\n    }\r\n    if (lineSep === false) { return lines }\r\n    else { return lines.join(lineSep || this.lineSeparator()) }\r\n  },\r\n  getSelections: function(lineSep) {\r\n    var this$1 = this;\r\n\r\n    var parts = [], ranges = this.sel.ranges\r\n    for (var i = 0; i < ranges.length; i++) {\r\n      var sel = getBetween(this$1, ranges[i].from(), ranges[i].to())\r\n      if (lineSep !== false) { sel = sel.join(lineSep || this$1.lineSeparator()) }\r\n      parts[i] = sel\r\n    }\r\n    return parts\r\n  },\r\n  replaceSelection: function(code, collapse, origin) {\r\n    var dup = []\r\n    for (var i = 0; i < this.sel.ranges.length; i++)\r\n      { dup[i] = code }\r\n    this.replaceSelections(dup, collapse, origin || \"+input\")\r\n  },\r\n  replaceSelections: docMethodOp(function(code, collapse, origin) {\r\n    var this$1 = this;\r\n\r\n    var changes = [], sel = this.sel\r\n    for (var i = 0; i < sel.ranges.length; i++) {\r\n      var range = sel.ranges[i]\r\n      changes[i] = {from: range.from(), to: range.to(), text: this$1.splitLines(code[i]), origin: origin}\r\n    }\r\n    var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse)\r\n    for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\r\n      { makeChange(this$1, changes[i$1]) }\r\n    if (newSel) { setSelectionReplaceHistory(this, newSel) }\r\n    else if (this.cm) { ensureCursorVisible(this.cm) }\r\n  }),\r\n  undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\")}),\r\n  redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\")}),\r\n  undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true)}),\r\n  redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true)}),\r\n\r\n  setExtending: function(val) {this.extend = val},\r\n  getExtending: function() {return this.extend},\r\n\r\n  historySize: function() {\r\n    var hist = this.history, done = 0, undone = 0\r\n    for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done } }\r\n    for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone } }\r\n    return {undo: done, redo: undone}\r\n  },\r\n  clearHistory: function() {this.history = new History(this.history.maxGeneration)},\r\n\r\n  markClean: function() {\r\n    this.cleanGeneration = this.changeGeneration(true)\r\n  },\r\n  changeGeneration: function(forceSplit) {\r\n    if (forceSplit)\r\n      { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null }\r\n    return this.history.generation\r\n  },\r\n  isClean: function (gen) {\r\n    return this.history.generation == (gen || this.cleanGeneration)\r\n  },\r\n\r\n  getHistory: function() {\r\n    return {done: copyHistoryArray(this.history.done),\r\n            undone: copyHistoryArray(this.history.undone)}\r\n  },\r\n  setHistory: function(histData) {\r\n    var hist = this.history = new History(this.history.maxGeneration)\r\n    hist.done = copyHistoryArray(histData.done.slice(0), null, true)\r\n    hist.undone = copyHistoryArray(histData.undone.slice(0), null, true)\r\n  },\r\n\r\n  setGutterMarker: docMethodOp(function(line, gutterID, value) {\r\n    return changeLine(this, line, \"gutter\", function (line) {\r\n      var markers = line.gutterMarkers || (line.gutterMarkers = {})\r\n      markers[gutterID] = value\r\n      if (!value && isEmpty(markers)) { line.gutterMarkers = null }\r\n      return true\r\n    })\r\n  }),\r\n\r\n  clearGutter: docMethodOp(function(gutterID) {\r\n    var this$1 = this;\r\n\r\n    this.iter(function (line) {\r\n      if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\r\n        changeLine(this$1, line, \"gutter\", function () {\r\n          line.gutterMarkers[gutterID] = null\r\n          if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null }\r\n          return true\r\n        })\r\n      }\r\n    })\r\n  }),\r\n\r\n  lineInfo: function(line) {\r\n    var n\r\n    if (typeof line == \"number\") {\r\n      if (!isLine(this, line)) { return null }\r\n      n = line\r\n      line = getLine(this, line)\r\n      if (!line) { return null }\r\n    } else {\r\n      n = lineNo(line)\r\n      if (n == null) { return null }\r\n    }\r\n    return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\r\n            textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\r\n            widgets: line.widgets}\r\n  },\r\n\r\n  addLineClass: docMethodOp(function(handle, where, cls) {\r\n    return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\r\n      var prop = where == \"text\" ? \"textClass\"\r\n               : where == \"background\" ? \"bgClass\"\r\n               : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\"\r\n      if (!line[prop]) { line[prop] = cls }\r\n      else if (classTest(cls).test(line[prop])) { return false }\r\n      else { line[prop] += \" \" + cls }\r\n      return true\r\n    })\r\n  }),\r\n  removeLineClass: docMethodOp(function(handle, where, cls) {\r\n    return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\r\n      var prop = where == \"text\" ? \"textClass\"\r\n               : where == \"background\" ? \"bgClass\"\r\n               : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\"\r\n      var cur = line[prop]\r\n      if (!cur) { return false }\r\n      else if (cls == null) { line[prop] = null }\r\n      else {\r\n        var found = cur.match(classTest(cls))\r\n        if (!found) { return false }\r\n        var end = found.index + found[0].length\r\n        line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null\r\n      }\r\n      return true\r\n    })\r\n  }),\r\n\r\n  addLineWidget: docMethodOp(function(handle, node, options) {\r\n    return addLineWidget(this, handle, node, options)\r\n  }),\r\n  removeLineWidget: function(widget) { widget.clear() },\r\n\r\n  markText: function(from, to, options) {\r\n    return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\r\n  },\r\n  setBookmark: function(pos, options) {\r\n    var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\r\n                    insertLeft: options && options.insertLeft,\r\n                    clearWhenEmpty: false, shared: options && options.shared,\r\n                    handleMouseEvents: options && options.handleMouseEvents}\r\n    pos = clipPos(this, pos)\r\n    return markText(this, pos, pos, realOpts, \"bookmark\")\r\n  },\r\n  findMarksAt: function(pos) {\r\n    pos = clipPos(this, pos)\r\n    var markers = [], spans = getLine(this, pos.line).markedSpans\r\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\r\n      var span = spans[i]\r\n      if ((span.from == null || span.from <= pos.ch) &&\r\n          (span.to == null || span.to >= pos.ch))\r\n        { markers.push(span.marker.parent || span.marker) }\r\n    } }\r\n    return markers\r\n  },\r\n  findMarks: function(from, to, filter) {\r\n    from = clipPos(this, from); to = clipPos(this, to)\r\n    var found = [], lineNo = from.line\r\n    this.iter(from.line, to.line + 1, function (line) {\r\n      var spans = line.markedSpans\r\n      if (spans) { for (var i = 0; i < spans.length; i++) {\r\n        var span = spans[i]\r\n        if (!(span.to != null && lineNo == from.line && from.ch >= span.to ||\r\n              span.from == null && lineNo != from.line ||\r\n              span.from != null && lineNo == to.line && span.from >= to.ch) &&\r\n            (!filter || filter(span.marker)))\r\n          { found.push(span.marker.parent || span.marker) }\r\n      } }\r\n      ++lineNo\r\n    })\r\n    return found\r\n  },\r\n  getAllMarks: function() {\r\n    var markers = []\r\n    this.iter(function (line) {\r\n      var sps = line.markedSpans\r\n      if (sps) { for (var i = 0; i < sps.length; ++i)\r\n        { if (sps[i].from != null) { markers.push(sps[i].marker) } } }\r\n    })\r\n    return markers\r\n  },\r\n\r\n  posFromIndex: function(off) {\r\n    var ch, lineNo = this.first, sepSize = this.lineSeparator().length\r\n    this.iter(function (line) {\r\n      var sz = line.text.length + sepSize\r\n      if (sz > off) { ch = off; return true }\r\n      off -= sz\r\n      ++lineNo\r\n    })\r\n    return clipPos(this, Pos(lineNo, ch))\r\n  },\r\n  indexFromPos: function (coords) {\r\n    coords = clipPos(this, coords)\r\n    var index = coords.ch\r\n    if (coords.line < this.first || coords.ch < 0) { return 0 }\r\n    var sepSize = this.lineSeparator().length\r\n    this.iter(this.first, coords.line, function (line) { \r\n      index += line.text.length + sepSize\r\n    })\r\n    return index\r\n  },\r\n\r\n  copy: function(copyHistory) {\r\n    var doc = new Doc(getLines(this, this.first, this.first + this.size),\r\n                      this.modeOption, this.first, this.lineSep, this.direction)\r\n    doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft\r\n    doc.sel = this.sel\r\n    doc.extend = false\r\n    if (copyHistory) {\r\n      doc.history.undoDepth = this.history.undoDepth\r\n      doc.setHistory(this.getHistory())\r\n    }\r\n    return doc\r\n  },\r\n\r\n  linkedDoc: function(options) {\r\n    if (!options) { options = {} }\r\n    var from = this.first, to = this.first + this.size\r\n    if (options.from != null && options.from > from) { from = options.from }\r\n    if (options.to != null && options.to < to) { to = options.to }\r\n    var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction)\r\n    if (options.sharedHist) { copy.history = this.history\r\n    ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist})\r\n    copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}]\r\n    copySharedMarkers(copy, findSharedMarkers(this))\r\n    return copy\r\n  },\r\n  unlinkDoc: function(other) {\r\n    var this$1 = this;\r\n\r\n    if (other instanceof CodeMirror) { other = other.doc }\r\n    if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\r\n      var link = this$1.linked[i]\r\n      if (link.doc != other) { continue }\r\n      this$1.linked.splice(i, 1)\r\n      other.unlinkDoc(this$1)\r\n      detachSharedMarkers(findSharedMarkers(this$1))\r\n      break\r\n    } }\r\n    if (other.history == this.history) {\r\n      var splitIds = [other.id]\r\n      linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true)\r\n      other.history = new History(null)\r\n      other.history.done = copyHistoryArray(this.history.done, splitIds)\r\n      other.history.undone = copyHistoryArray(this.history.undone, splitIds)\r\n    }\r\n  },\r\n  iterLinkedDocs: function(f) {linkedDocs(this, f)},\r\n\r\n  getMode: function() {return this.mode},\r\n  getEditor: function() {return this.cm},\r\n\r\n  splitLines: function(str) {\r\n    if (this.lineSep) { return str.split(this.lineSep) }\r\n    return splitLinesAuto(str)\r\n  },\r\n  lineSeparator: function() { return this.lineSep || \"\\n\" },\r\n\r\n  setDirection: docMethodOp(function (dir) {\r\n    if (dir != \"rtl\") { dir = \"ltr\" }\r\n    if (dir == this.direction) { return }\r\n    this.direction = dir\r\n    this.iter(function (line) { return line.order = null; })\r\n    if (this.cm) { directionChanged(this.cm) }\r\n  })\r\n})\r\n\r\nDoc.prototype.eachLine = Doc.prototype.iter\r\n\r\nvar lastDrop = 0\r\n\r\nfunction onDrop(e) {\r\n  var cm = this\r\n  clearDragCursor(cm)\r\n  if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\r\n    { return }\r\n  e_preventDefault(e)\r\n  if (ie) { lastDrop = +new Date }\r\n  var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files\r\n  if (!pos || cm.isReadOnly()) { return }\r\n  if (files && files.length && window.FileReader && window.File) {\r\n    var n = files.length, text = Array(n), read = 0\r\n    var loadFile = function (file, i) {\r\n      if (cm.options.allowDropFileTypes &&\r\n          indexOf(cm.options.allowDropFileTypes, file.type) == -1)\r\n        { return }\r\n\r\n      var reader = new FileReader\r\n      reader.onload = operation(cm, function () {\r\n        var content = reader.result\r\n        if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) { content = \"\" }\r\n        text[i] = content\r\n        if (++read == n) {\r\n          pos = clipPos(cm.doc, pos)\r\n          var change = {from: pos, to: pos,\r\n                        text: cm.doc.splitLines(text.join(cm.doc.lineSeparator())),\r\n                        origin: \"paste\"}\r\n          makeChange(cm.doc, change)\r\n          setSelectionReplaceHistory(cm.doc, simpleSelection(pos, changeEnd(change)))\r\n        }\r\n      })\r\n      reader.readAsText(file)\r\n    }\r\n    for (var i = 0; i < n; ++i) { loadFile(files[i], i) }\r\n  } else { \r\n    if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\r\n      cm.state.draggingText(e)\r\n      setTimeout(function () { return cm.display.input.focus(); }, 20)\r\n      return\r\n    }\r\n    try {\r\n      var text$1 = e.dataTransfer.getData(\"Text\")\r\n      if (text$1) {\r\n        var selected\r\n        if (cm.state.draggingText && !cm.state.draggingText.copy)\r\n          { selected = cm.listSelections() }\r\n        setSelectionNoUndo(cm.doc, simpleSelection(pos, pos))\r\n        if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\r\n          { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\") } }\r\n        cm.replaceSelection(text$1, \"around\", \"paste\")\r\n        cm.display.input.focus()\r\n      }\r\n    }\r\n    catch(e){}\r\n  }\r\n}\r\n\r\nfunction onDragStart(cm, e) {\r\n  if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\r\n  if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\r\n\r\n  e.dataTransfer.setData(\"Text\", cm.getSelection())\r\n  e.dataTransfer.effectAllowed = \"copyMove\"\r\n\r\n  if (e.dataTransfer.setDragImage && !safari) {\r\n    var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\")\r\n    img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\"\r\n    if (presto) {\r\n      img.width = img.height = 1\r\n      cm.display.wrapper.appendChild(img)\r\n      img._top = img.offsetTop\r\n    }\r\n    e.dataTransfer.setDragImage(img, 0, 0)\r\n    if (presto) { img.parentNode.removeChild(img) }\r\n  }\r\n}\r\n\r\nfunction onDragOver(cm, e) {\r\n  var pos = posFromMouse(cm, e)\r\n  if (!pos) { return }\r\n  var frag = document.createDocumentFragment()\r\n  drawSelectionCursor(cm, pos, frag)\r\n  if (!cm.display.dragCursor) {\r\n    cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\")\r\n    cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv)\r\n  }\r\n  removeChildrenAndAdd(cm.display.dragCursor, frag)\r\n}\r\n\r\nfunction clearDragCursor(cm) {\r\n  if (cm.display.dragCursor) {\r\n    cm.display.lineSpace.removeChild(cm.display.dragCursor)\r\n    cm.display.dragCursor = null\r\n  }\r\n}\r\n\r\n\r\nfunction forEachCodeMirror(f) {\r\n  if (!document.getElementsByClassName) { return }\r\n  var byClass = document.getElementsByClassName(\"CodeMirror\")\r\n  for (var i = 0; i < byClass.length; i++) {\r\n    var cm = byClass[i].CodeMirror\r\n    if (cm) { f(cm) }\r\n  }\r\n}\r\n\r\nvar globalsRegistered = false\r\nfunction ensureGlobalHandlers() {\r\n  if (globalsRegistered) { return }\r\n  registerGlobalHandlers()\r\n  globalsRegistered = true\r\n}\r\nfunction registerGlobalHandlers() {\r\n  var resizeTimer\r\n  on(window, \"resize\", function () {\r\n    if (resizeTimer == null) { resizeTimer = setTimeout(function () {\r\n      resizeTimer = null\r\n      forEachCodeMirror(onResize)\r\n    }, 100) }\r\n  })\r\n  on(window, \"blur\", function () { return forEachCodeMirror(onBlur); })\r\n}\r\nfunction onResize(cm) {\r\n  var d = cm.display\r\n  if (d.lastWrapHeight == d.wrapper.clientHeight && d.lastWrapWidth == d.wrapper.clientWidth)\r\n    { return }\r\n  d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null\r\n  d.scrollbarsClipped = false\r\n  cm.setSize()\r\n}\r\n\r\nvar keyNames = {\r\n  3: \"Enter\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\r\n  19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\r\n  36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\r\n  46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\r\n  106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 127: \"Delete\",\r\n  173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\r\n  221: \"]\", 222: \"'\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\r\n  63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\r\n}\r\n\r\nfor (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i) }\r\nfor (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1) }\r\nfor (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2 }\r\n\r\nvar keyMap = {}\r\n\r\nkeyMap.basic = {\r\n  \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\r\n  \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\r\n  \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\r\n  \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\r\n  \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\r\n  \"Esc\": \"singleSelection\"\r\n}\r\nkeyMap.pcDefault = {\r\n  \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\r\n  \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\r\n  \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\r\n  \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\r\n  \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\r\n  \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\r\n  \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\r\n  fallthrough: \"basic\"\r\n}\r\nkeyMap.emacsy = {\r\n  \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\r\n  \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\r\n  \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\r\n  \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\",\r\n  \"Ctrl-O\": \"openLine\"\r\n}\r\nkeyMap.macDefault = {\r\n  \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\r\n  \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\r\n  \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\r\n  \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\r\n  \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\r\n  \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\r\n  \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\r\n  fallthrough: [\"basic\", \"emacsy\"]\r\n}\r\nkeyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault\r\n\r\n\r\nfunction normalizeKeyName(name) {\r\n  var parts = name.split(/-(?!$)/)\r\n  name = parts[parts.length - 1]\r\n  var alt, ctrl, shift, cmd\r\n  for (var i = 0; i < parts.length - 1; i++) {\r\n    var mod = parts[i]\r\n    if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true }\r\n    else if (/^a(lt)?$/i.test(mod)) { alt = true }\r\n    else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true }\r\n    else if (/^s(hift)?$/i.test(mod)) { shift = true }\r\n    else { throw new Error(\"Unrecognized modifier name: \" + mod) }\r\n  }\r\n  if (alt) { name = \"Alt-\" + name }\r\n  if (ctrl) { name = \"Ctrl-\" + name }\r\n  if (cmd) { name = \"Cmd-\" + name }\r\n  if (shift) { name = \"Shift-\" + name }\r\n  return name\r\n}\r\n\r\nfunction normalizeKeyMap(keymap) {\r\n  var copy = {}\r\n  for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\r\n    var value = keymap[keyname]\r\n    if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\r\n    if (value == \"...\") { delete keymap[keyname]; continue }\r\n\r\n    var keys = map(keyname.split(\" \"), normalizeKeyName)\r\n    for (var i = 0; i < keys.length; i++) {\r\n      var val = (void 0), name = (void 0)\r\n      if (i == keys.length - 1) {\r\n        name = keys.join(\" \")\r\n        val = value\r\n      } else {\r\n        name = keys.slice(0, i + 1).join(\" \")\r\n        val = \"...\"\r\n      }\r\n      var prev = copy[name]\r\n      if (!prev) { copy[name] = val }\r\n      else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\r\n    }\r\n    delete keymap[keyname]\r\n  } }\r\n  for (var prop in copy) { keymap[prop] = copy[prop] }\r\n  return keymap\r\n}\r\n\r\nfunction lookupKey(key, map, handle, context) {\r\n  map = getKeyMap(map)\r\n  var found = map.call ? map.call(key, context) : map[key]\r\n  if (found === false) { return \"nothing\" }\r\n  if (found === \"...\") { return \"multi\" }\r\n  if (found != null && handle(found)) { return \"handled\" }\r\n\r\n  if (map.fallthrough) {\r\n    if (Object.prototype.toString.call(map.fallthrough) != \"[object Array]\")\r\n      { return lookupKey(key, map.fallthrough, handle, context) }\r\n    for (var i = 0; i < map.fallthrough.length; i++) {\r\n      var result = lookupKey(key, map.fallthrough[i], handle, context)\r\n      if (result) { return result }\r\n    }\r\n  }\r\n}\r\n\r\nfunction isModifierKey(value) {\r\n  var name = typeof value == \"string\" ? value : keyNames[value.keyCode]\r\n  return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\r\n}\r\n\r\nfunction addModifierNames(name, event, noShift) {\r\n  var base = name\r\n  if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name }\r\n  if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name }\r\n  if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Cmd\") { name = \"Cmd-\" + name }\r\n  if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name }\r\n  return name\r\n}\r\n\r\nfunction keyName(event, noShift) {\r\n  if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\r\n  var name = keyNames[event.keyCode]\r\n  if (name == null || event.altGraphKey) { return false }\r\n  return addModifierNames(name, event, noShift)\r\n}\r\n\r\nfunction getKeyMap(val) {\r\n  return typeof val == \"string\" ? keyMap[val] : val\r\n}\r\n\r\nfunction deleteNearSelection(cm, compute) {\r\n  var ranges = cm.doc.sel.ranges, kill = []\r\n  for (var i = 0; i < ranges.length; i++) {\r\n    var toKill = compute(ranges[i])\r\n    while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\r\n      var replaced = kill.pop()\r\n      if (cmp(replaced.from, toKill.from) < 0) {\r\n        toKill.from = replaced.from\r\n        break\r\n      }\r\n    }\r\n    kill.push(toKill)\r\n  }\r\n  runInOp(cm, function () {\r\n    for (var i = kill.length - 1; i >= 0; i--)\r\n      { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\") }\r\n    ensureCursorVisible(cm)\r\n  })\r\n}\r\n\r\nfunction moveCharLogically(line, ch, dir) {\r\n  var target = skipExtendingChars(line.text, ch + dir, dir)\r\n  return target < 0 || target > line.text.length ? null : target\r\n}\r\n\r\nfunction moveLogically(line, start, dir) {\r\n  var ch = moveCharLogically(line, start.ch, dir)\r\n  return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\r\n}\r\n\r\nfunction endOfLine(visually, cm, lineObj, lineNo, dir) {\r\n  if (visually) {\r\n    var order = getOrder(lineObj, cm.doc.direction)\r\n    if (order) {\r\n      var part = dir < 0 ? lst(order) : order[0]\r\n      var moveInStorageOrder = (dir < 0) == (part.level == 1)\r\n      var sticky = moveInStorageOrder ? \"after\" : \"before\"\r\n      var ch\r\n      if (part.level > 0 || cm.doc.direction == \"rtl\") {\r\n        var prep = prepareMeasureForLine(cm, lineObj)\r\n        ch = dir < 0 ? lineObj.text.length - 1 : 0\r\n        var targetTop = measureCharPrepared(cm, prep, ch).top\r\n        ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch)\r\n        if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1) }\r\n      } else { ch = dir < 0 ? part.to : part.from }\r\n      return new Pos(lineNo, ch, sticky)\r\n    }\r\n  }\r\n  return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\r\n}\r\n\r\nfunction moveVisually(cm, line, start, dir) {\r\n  var bidi = getOrder(line, cm.doc.direction)\r\n  if (!bidi) { return moveLogically(line, start, dir) }\r\n  if (start.ch >= line.text.length) {\r\n    start.ch = line.text.length\r\n    start.sticky = \"before\"\r\n  } else if (start.ch <= 0) {\r\n    start.ch = 0\r\n    start.sticky = \"after\"\r\n  }\r\n  var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos]\r\n  if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\r\n    return moveLogically(line, start, dir)\r\n  }\r\n\r\n  var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); }\r\n  var prep\r\n  var getWrappedLineExtent = function (ch) {\r\n    if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\r\n    prep = prep || prepareMeasureForLine(cm, line)\r\n    return wrappedLineExtentChar(cm, line, prep, ch)\r\n  }\r\n  var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch)\r\n\r\n  if (cm.doc.direction == \"rtl\" || part.level == 1) {\r\n    var moveInStorageOrder = (part.level == 1) == (dir < 0)\r\n    var ch = mv(start, moveInStorageOrder ? 1 : -1)\r\n    if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\r\n      var sticky = moveInStorageOrder ? \"before\" : \"after\"\r\n      return new Pos(start.line, ch, sticky)\r\n    }\r\n  }\r\n\r\n\r\n  var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\r\n    var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\r\n      ? new Pos(start.line, mv(ch, 1), \"before\")\r\n      : new Pos(start.line, ch, \"after\"); }\r\n\r\n    for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\r\n      var part = bidi[partPos]\r\n      var moveInStorageOrder = (dir > 0) == (part.level != 1)\r\n      var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1)\r\n      if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\r\n      ch = moveInStorageOrder ? part.from : mv(part.to, -1)\r\n      if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\r\n    }\r\n  }\r\n\r\n  var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent)\r\n  if (res) { return res }\r\n\r\n  var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1)\r\n  if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\r\n    res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh))\r\n    if (res) { return res }\r\n  }\r\n\r\n  return null\r\n}\r\n\r\nvar commands = {\r\n  selectAll: selectAll,\r\n  singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\r\n  killLine: function (cm) { return deleteNearSelection(cm, function (range) {\r\n    if (range.empty()) {\r\n      var len = getLine(cm.doc, range.head.line).text.length\r\n      if (range.head.ch == len && range.head.line < cm.lastLine())\r\n        { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\r\n      else\r\n        { return {from: range.head, to: Pos(range.head.line, len)} }\r\n    } else {\r\n      return {from: range.from(), to: range.to()}\r\n    }\r\n  }); },\r\n  deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\r\n    from: Pos(range.from().line, 0),\r\n    to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\r\n  }); }); },\r\n  delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\r\n    from: Pos(range.from().line, 0), to: range.from()\r\n  }); }); },\r\n  delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\r\n    var top = cm.charCoords(range.head, \"div\").top + 5\r\n    var leftPos = cm.coordsChar({left: 0, top: top}, \"div\")\r\n    return {from: leftPos, to: range.from()}\r\n  }); },\r\n  delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\r\n    var top = cm.charCoords(range.head, \"div\").top + 5\r\n    var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\r\n    return {from: range.from(), to: rightPos }\r\n  }); },\r\n  undo: function (cm) { return cm.undo(); },\r\n  redo: function (cm) { return cm.redo(); },\r\n  undoSelection: function (cm) { return cm.undoSelection(); },\r\n  redoSelection: function (cm) { return cm.redoSelection(); },\r\n  goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\r\n  goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\r\n  goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\r\n    {origin: \"+move\", bias: 1}\r\n  ); },\r\n  goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\r\n    {origin: \"+move\", bias: 1}\r\n  ); },\r\n  goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\r\n    {origin: \"+move\", bias: -1}\r\n  ); },\r\n  goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\r\n    var top = cm.cursorCoords(range.head, \"div\").top + 5\r\n    return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\r\n  }, sel_move); },\r\n  goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\r\n    var top = cm.cursorCoords(range.head, \"div\").top + 5\r\n    return cm.coordsChar({left: 0, top: top}, \"div\")\r\n  }, sel_move); },\r\n  goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\r\n    var top = cm.cursorCoords(range.head, \"div\").top + 5\r\n    var pos = cm.coordsChar({left: 0, top: top}, \"div\")\r\n    if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\r\n    return pos\r\n  }, sel_move); },\r\n  goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\r\n  goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\r\n  goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\r\n  goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\r\n  goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\r\n  goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\r\n  goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\r\n  goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\r\n  goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\r\n  goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\r\n  goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\r\n  goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\r\n  delCharBefore: function (cm) { return cm.deleteH(-1, \"char\"); },\r\n  delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\r\n  delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\r\n  delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\r\n  delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\r\n  delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\r\n  indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\r\n  indentMore: function (cm) { return cm.indentSelection(\"add\"); },\r\n  indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\r\n  insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\r\n  insertSoftTab: function (cm) {\r\n    var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize\r\n    for (var i = 0; i < ranges.length; i++) {\r\n      var pos = ranges[i].from()\r\n      var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize)\r\n      spaces.push(spaceStr(tabSize - col % tabSize))\r\n    }\r\n    cm.replaceSelections(spaces)\r\n  },\r\n  defaultTab: function (cm) {\r\n    if (cm.somethingSelected()) { cm.indentSelection(\"add\") }\r\n    else { cm.execCommand(\"insertTab\") }\r\n  },\r\n  transposeChars: function (cm) { return runInOp(cm, function () {\r\n    var ranges = cm.listSelections(), newSel = []\r\n    for (var i = 0; i < ranges.length; i++) {\r\n      if (!ranges[i].empty()) { continue }\r\n      var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text\r\n      if (line) {\r\n        if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1) }\r\n        if (cur.ch > 0) {\r\n          cur = new Pos(cur.line, cur.ch + 1)\r\n          cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\r\n                          Pos(cur.line, cur.ch - 2), cur, \"+transpose\")\r\n        } else if (cur.line > cm.doc.first) {\r\n          var prev = getLine(cm.doc, cur.line - 1).text\r\n          if (prev) {\r\n            cur = new Pos(cur.line, 1)\r\n            cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\r\n                            prev.charAt(prev.length - 1),\r\n                            Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\")\r\n          }\r\n        }\r\n      }\r\n      newSel.push(new Range(cur, cur))\r\n    }\r\n    cm.setSelections(newSel)\r\n  }); },\r\n  newlineAndIndent: function (cm) { return runInOp(cm, function () {\r\n    var sels = cm.listSelections()\r\n    for (var i = sels.length - 1; i >= 0; i--)\r\n      { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\") }\r\n    sels = cm.listSelections()\r\n    for (var i$1 = 0; i$1 < sels.length; i$1++)\r\n      { cm.indentLine(sels[i$1].from().line, null, true) }\r\n    ensureCursorVisible(cm)\r\n  }); },\r\n  openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\r\n  toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\r\n}\r\n\r\n\r\nfunction lineStart(cm, lineN) {\r\n  var line = getLine(cm.doc, lineN)\r\n  var visual = visualLine(line)\r\n  if (visual != line) { lineN = lineNo(visual) }\r\n  return endOfLine(true, cm, visual, lineN, 1)\r\n}\r\nfunction lineEnd(cm, lineN) {\r\n  var line = getLine(cm.doc, lineN)\r\n  var visual = visualLineEnd(line)\r\n  if (visual != line) { lineN = lineNo(visual) }\r\n  return endOfLine(true, cm, line, lineN, -1)\r\n}\r\nfunction lineStartSmart(cm, pos) {\r\n  var start = lineStart(cm, pos.line)\r\n  var line = getLine(cm.doc, start.line)\r\n  var order = getOrder(line, cm.doc.direction)\r\n  if (!order || order[0].level == 0) {\r\n    var firstNonWS = Math.max(0, line.text.search(/\\S/))\r\n    var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch\r\n    return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\r\n  }\r\n  return start\r\n}\r\n\r\nfunction doHandleBinding(cm, bound, dropShift) {\r\n  if (typeof bound == \"string\") {\r\n    bound = commands[bound]\r\n    if (!bound) { return false }\r\n  }\r\n  cm.display.input.ensurePolled()\r\n  var prevShift = cm.display.shift, done = false\r\n  try {\r\n    if (cm.isReadOnly()) { cm.state.suppressEdits = true }\r\n    if (dropShift) { cm.display.shift = false }\r\n    done = bound(cm) != Pass\r\n  } finally {\r\n    cm.display.shift = prevShift\r\n    cm.state.suppressEdits = false\r\n  }\r\n  return done\r\n}\r\n\r\nfunction lookupKeyForEditor(cm, name, handle) {\r\n  for (var i = 0; i < cm.state.keyMaps.length; i++) {\r\n    var result = lookupKey(name, cm.state.keyMaps[i], handle, cm)\r\n    if (result) { return result }\r\n  }\r\n  return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\r\n    || lookupKey(name, cm.options.keyMap, handle, cm)\r\n}\r\n\r\n\r\nvar stopSeq = new Delayed\r\nfunction dispatchKey(cm, name, e, handle) {\r\n  var seq = cm.state.keySeq\r\n  if (seq) {\r\n    if (isModifierKey(name)) { return \"handled\" }\r\n    stopSeq.set(50, function () {\r\n      if (cm.state.keySeq == seq) {\r\n        cm.state.keySeq = null\r\n        cm.display.input.reset()\r\n      }\r\n    })\r\n    name = seq + \" \" + name\r\n  }\r\n  var result = lookupKeyForEditor(cm, name, handle)\r\n\r\n  if (result == \"multi\")\r\n    { cm.state.keySeq = name }\r\n  if (result == \"handled\")\r\n    { signalLater(cm, \"keyHandled\", cm, name, e) }\r\n\r\n  if (result == \"handled\" || result == \"multi\") {\r\n    e_preventDefault(e)\r\n    restartBlink(cm)\r\n  }\r\n\r\n  if (seq && !result && /\\'$/.test(name)) {\r\n    e_preventDefault(e)\r\n    return true\r\n  }\r\n  return !!result\r\n}\r\n\r\nfunction handleKeyBinding(cm, e) {\r\n  var name = keyName(e, true)\r\n  if (!name) { return false }\r\n\r\n  if (e.shiftKey && !cm.state.keySeq) {\r\n    return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\r\n        || dispatchKey(cm, name, e, function (b) {\r\n             if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\r\n               { return doHandleBinding(cm, b) }\r\n           })\r\n  } else {\r\n    return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\r\n  }\r\n}\r\n\r\nfunction handleCharBinding(cm, e, ch) {\r\n  return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\r\n}\r\n\r\nvar lastStoppedKey = null\r\nfunction onKeyDown(e) {\r\n  var cm = this\r\n  cm.curOp.focus = activeElt()\r\n  if (signalDOMEvent(cm, e)) { return }\r\n  if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false }\r\n  var code = e.keyCode\r\n  cm.display.shift = code == 16 || e.shiftKey\r\n  var handled = handleKeyBinding(cm, e)\r\n  if (presto) {\r\n    lastStoppedKey = handled ? code : null\r\n    if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\r\n      { cm.replaceSelection(\"\", null, \"cut\") }\r\n  }\r\n\r\n  if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\r\n    { showCrossHair(cm) }\r\n}\r\n\r\nfunction showCrossHair(cm) {\r\n  var lineDiv = cm.display.lineDiv\r\n  addClass(lineDiv, \"CodeMirror-crosshair\")\r\n\r\n  function up(e) {\r\n    if (e.keyCode == 18 || !e.altKey) {\r\n      rmClass(lineDiv, \"CodeMirror-crosshair\")\r\n      off(document, \"keyup\", up)\r\n      off(document, \"mouseover\", up)\r\n    }\r\n  }\r\n  on(document, \"keyup\", up)\r\n  on(document, \"mouseover\", up)\r\n}\r\n\r\nfunction onKeyUp(e) {\r\n  if (e.keyCode == 16) { this.doc.sel.shift = false }\r\n  signalDOMEvent(this, e)\r\n}\r\n\r\nfunction onKeyPress(e) {\r\n  var cm = this\r\n  if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\r\n  var keyCode = e.keyCode, charCode = e.charCode\r\n  if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\r\n  if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\r\n  var ch = String.fromCharCode(charCode == null ? keyCode : charCode)\r\n  if (ch == \"\\x08\") { return }\r\n  if (handleCharBinding(cm, e, ch)) { return }\r\n  cm.display.input.onKeyPress(e)\r\n}\r\n\r\nvar DOUBLECLICK_DELAY = 400\r\n\r\nvar PastClick = function(time, pos, button) {\r\n  this.time = time\r\n  this.pos = pos\r\n  this.button = button\r\n};\r\n\r\nPastClick.prototype.compare = function (time, pos, button) {\r\n  return this.time + DOUBLECLICK_DELAY > time &&\r\n    cmp(pos, this.pos) == 0 && button == this.button\r\n};\r\n\r\nvar lastClick;\r\nvar lastDoubleClick;\r\nfunction clickRepeat(pos, button) {\r\n  var now = +new Date\r\n  if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\r\n    lastClick = lastDoubleClick = null\r\n    return \"triple\"\r\n  } else if (lastClick && lastClick.compare(now, pos, button)) {\r\n    lastDoubleClick = new PastClick(now, pos, button)\r\n    lastClick = null\r\n    return \"double\"\r\n  } else {\r\n    lastClick = new PastClick(now, pos, button)\r\n    lastDoubleClick = null\r\n    return \"single\"\r\n  }\r\n}\r\n\r\nfunction onMouseDown(e) {\r\n  var cm = this, display = cm.display\r\n  if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\r\n  display.input.ensurePolled()\r\n  display.shift = e.shiftKey\r\n\r\n  if (eventInWidget(display, e)) {\r\n    if (!webkit) {\r\n      display.scroller.draggable = false\r\n      setTimeout(function () { return display.scroller.draggable = true; }, 100)\r\n    }\r\n    return\r\n  }\r\n  if (clickInGutter(cm, e)) { return }\r\n  var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : \"single\"\r\n  window.focus()\r\n\r\n  if (button == 1 && cm.state.selectingText)\r\n    { cm.state.selectingText(e) }\r\n\r\n  if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\r\n\r\n  if (button == 1) {\r\n    if (pos) { leftButtonDown(cm, pos, repeat, e) }\r\n    else if (e_target(e) == display.scroller) { e_preventDefault(e) }\r\n  } else if (button == 2) {\r\n    if (pos) { extendSelection(cm.doc, pos) }\r\n    setTimeout(function () { return display.input.focus(); }, 20)\r\n  } else if (button == 3) {\r\n    if (captureRightClick) { onContextMenu(cm, e) }\r\n    else { delayBlurEvent(cm) }\r\n  }\r\n}\r\n\r\nfunction handleMappedButton(cm, button, pos, repeat, event) {\r\n  var name = \"Click\"\r\n  if (repeat == \"double\") { name = \"Double\" + name }\r\n  else if (repeat == \"triple\") { name = \"Triple\" + name }\r\n  name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name\r\n\r\n  return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\r\n    if (typeof bound == \"string\") { bound = commands[bound] }\r\n    if (!bound) { return false }\r\n    var done = false\r\n    try {\r\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true }\r\n      done = bound(cm, pos) != Pass\r\n    } finally {\r\n      cm.state.suppressEdits = false\r\n    }\r\n    return done\r\n  })\r\n}\r\n\r\nfunction configureMouse(cm, repeat, event) {\r\n  var option = cm.getOption(\"configureMouse\")\r\n  var value = option ? option(cm, repeat, event) : {}\r\n  if (value.unit == null) {\r\n    var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey\r\n    value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\"\r\n  }\r\n  if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey }\r\n  if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey }\r\n  if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey) }\r\n  return value\r\n}\r\n\r\nfunction leftButtonDown(cm, pos, repeat, event) {\r\n  if (ie) { setTimeout(bind(ensureFocus, cm), 0) }\r\n  else { cm.curOp.focus = activeElt() }\r\n\r\n  var behavior = configureMouse(cm, repeat, event)\r\n\r\n  var sel = cm.doc.sel, contained\r\n  if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\r\n      repeat == \"single\" && (contained = sel.contains(pos)) > -1 &&\r\n      (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\r\n      (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\r\n    { leftButtonStartDrag(cm, event, pos, behavior) }\r\n  else\r\n    { leftButtonSelect(cm, event, pos, behavior) }\r\n}\r\n\r\nfunction leftButtonStartDrag(cm, event, pos, behavior) {\r\n  var display = cm.display, moved = false\r\n  var dragEnd = operation(cm, function (e) {\r\n    if (webkit) { display.scroller.draggable = false }\r\n    cm.state.draggingText = false\r\n    off(document, \"mouseup\", dragEnd)\r\n    off(document, \"mousemove\", mouseMove)\r\n    off(display.scroller, \"dragstart\", dragStart)\r\n    off(display.scroller, \"drop\", dragEnd)\r\n    if (!moved) {\r\n      e_preventDefault(e)\r\n      if (!behavior.addNew)\r\n        { extendSelection(cm.doc, pos, null, null, behavior.extend) }\r\n      if (webkit || ie && ie_version == 9)\r\n        { setTimeout(function () {document.body.focus(); display.input.focus()}, 20) }\r\n      else\r\n        { display.input.focus() }\r\n    }\r\n  })\r\n  var mouseMove = function(e2) {\r\n    moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10\r\n  }\r\n  var dragStart = function () { return moved = true; }\r\n  if (webkit) { display.scroller.draggable = true }\r\n  cm.state.draggingText = dragEnd\r\n  dragEnd.copy = !behavior.moveOnDrag\r\n  if (display.scroller.dragDrop) { display.scroller.dragDrop() }\r\n  on(document, \"mouseup\", dragEnd)\r\n  on(document, \"mousemove\", mouseMove)\r\n  on(display.scroller, \"dragstart\", dragStart)\r\n  on(display.scroller, \"drop\", dragEnd)\r\n\r\n  delayBlurEvent(cm)\r\n  setTimeout(function () { return display.input.focus(); }, 20)\r\n}\r\n\r\nfunction rangeForUnit(cm, pos, unit) {\r\n  if (unit == \"char\") { return new Range(pos, pos) }\r\n  if (unit == \"word\") { return cm.findWordAt(pos) }\r\n  if (unit == \"line\") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\r\n  var result = unit(cm, pos)\r\n  return new Range(result.from, result.to)\r\n}\r\n\r\nfunction leftButtonSelect(cm, event, start, behavior) {\r\n  var display = cm.display, doc = cm.doc\r\n  e_preventDefault(event)\r\n\r\n  var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges\r\n  if (behavior.addNew && !behavior.extend) {\r\n    ourIndex = doc.sel.contains(start)\r\n    if (ourIndex > -1)\r\n      { ourRange = ranges[ourIndex] }\r\n    else\r\n      { ourRange = new Range(start, start) }\r\n  } else {\r\n    ourRange = doc.sel.primary()\r\n    ourIndex = doc.sel.primIndex\r\n  }\r\n\r\n  if (behavior.unit == \"rectangle\") {\r\n    if (!behavior.addNew) { ourRange = new Range(start, start) }\r\n    start = posFromMouse(cm, event, true, true)\r\n    ourIndex = -1\r\n  } else {\r\n    var range = rangeForUnit(cm, start, behavior.unit)\r\n    if (behavior.extend)\r\n      { ourRange = extendRange(ourRange, range.anchor, range.head, behavior.extend) }\r\n    else\r\n      { ourRange = range }\r\n  }\r\n\r\n  if (!behavior.addNew) {\r\n    ourIndex = 0\r\n    setSelection(doc, new Selection([ourRange], 0), sel_mouse)\r\n    startSel = doc.sel\r\n  } else if (ourIndex == -1) {\r\n    ourIndex = ranges.length\r\n    setSelection(doc, normalizeSelection(ranges.concat([ourRange]), ourIndex),\r\n                 {scroll: false, origin: \"*mouse\"})\r\n  } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\r\n    setSelection(doc, normalizeSelection(ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\r\n                 {scroll: false, origin: \"*mouse\"})\r\n    startSel = doc.sel\r\n  } else {\r\n    replaceOneSelection(doc, ourIndex, ourRange, sel_mouse)\r\n  }\r\n\r\n  var lastPos = start\r\n  function extendTo(pos) {\r\n    if (cmp(lastPos, pos) == 0) { return }\r\n    lastPos = pos\r\n\r\n    if (behavior.unit == \"rectangle\") {\r\n      var ranges = [], tabSize = cm.options.tabSize\r\n      var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize)\r\n      var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize)\r\n      var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol)\r\n      for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\r\n           line <= end; line++) {\r\n        var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize)\r\n        if (left == right)\r\n          { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))) }\r\n        else if (text.length > leftPos)\r\n          { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))) }\r\n      }\r\n      if (!ranges.length) { ranges.push(new Range(start, start)) }\r\n      setSelection(doc, normalizeSelection(startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\r\n                   {origin: \"*mouse\", scroll: false})\r\n      cm.scrollIntoView(pos)\r\n    } else {\r\n      var oldRange = ourRange\r\n      var range = rangeForUnit(cm, pos, behavior.unit)\r\n      var anchor = oldRange.anchor, head\r\n      if (cmp(range.anchor, anchor) > 0) {\r\n        head = range.head\r\n        anchor = minPos(oldRange.from(), range.anchor)\r\n      } else {\r\n        head = range.anchor\r\n        anchor = maxPos(oldRange.to(), range.head)\r\n      }\r\n      var ranges$1 = startSel.ranges.slice(0)\r\n      ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head))\r\n      setSelection(doc, normalizeSelection(ranges$1, ourIndex), sel_mouse)\r\n    }\r\n  }\r\n\r\n  var editorSize = display.wrapper.getBoundingClientRect()\r\n  var counter = 0\r\n\r\n  function extend(e) {\r\n    var curCount = ++counter\r\n    var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\")\r\n    if (!cur) { return }\r\n    if (cmp(cur, lastPos) != 0) {\r\n      cm.curOp.focus = activeElt()\r\n      extendTo(cur)\r\n      var visible = visibleLines(display, doc)\r\n      if (cur.line >= visible.to || cur.line < visible.from)\r\n        { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e) }}), 150) }\r\n    } else {\r\n      var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0\r\n      if (outside) { setTimeout(operation(cm, function () {\r\n        if (counter != curCount) { return }\r\n        display.scroller.scrollTop += outside\r\n        extend(e)\r\n      }), 50) }\r\n    }\r\n  }\r\n\r\n  function done(e) {\r\n    cm.state.selectingText = false\r\n    counter = Infinity\r\n    e_preventDefault(e)\r\n    display.input.focus()\r\n    off(document, \"mousemove\", move)\r\n    off(document, \"mouseup\", up)\r\n    doc.history.lastSelOrigin = null\r\n  }\r\n\r\n  var move = operation(cm, function (e) {\r\n    if (!e_button(e)) { done(e) }\r\n    else { extend(e) }\r\n  })\r\n  var up = operation(cm, done)\r\n  cm.state.selectingText = up\r\n  on(document, \"mousemove\", move)\r\n  on(document, \"mouseup\", up)\r\n}\r\n\r\nfunction bidiSimplify(cm, range) {\r\n  var anchor = range.anchor;\r\n  var head = range.head;\r\n  var anchorLine = getLine(cm.doc, anchor.line)\r\n  if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range }\r\n  var order = getOrder(anchorLine)\r\n  if (!order) { return range }\r\n  var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index]\r\n  if (part.from != anchor.ch && part.to != anchor.ch) { return range }\r\n  var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1)\r\n  if (boundary == 0 || boundary == order.length) { return range }\r\n\r\n  var leftSide\r\n  if (head.line != anchor.line) {\r\n    leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0\r\n  } else {\r\n    var headIndex = getBidiPartAt(order, head.ch, head.sticky)\r\n    var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1)\r\n    if (headIndex == boundary - 1 || headIndex == boundary)\r\n      { leftSide = dir < 0 }\r\n    else\r\n      { leftSide = dir > 0 }\r\n  }\r\n\r\n  var usePart = order[boundary + (leftSide ? -1 : 0)]\r\n  var from = leftSide == (usePart.level == 1)\r\n  var ch = from ? usePart.from : usePart.to, sticky = from ? \"after\" : \"before\"\r\n  return anchor.ch == ch && anchor.sticky == sticky ? range : new Range(new Pos(anchor.line, ch, sticky), head)\r\n}\r\n\r\n\r\nfunction gutterEvent(cm, e, type, prevent) {\r\n  var mX, mY\r\n  if (e.touches) {\r\n    mX = e.touches[0].clientX\r\n    mY = e.touches[0].clientY\r\n  } else {\r\n    try { mX = e.clientX; mY = e.clientY }\r\n    catch(e) { return false }\r\n  }\r\n  if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\r\n  if (prevent) { e_preventDefault(e) }\r\n\r\n  var display = cm.display\r\n  var lineBox = display.lineDiv.getBoundingClientRect()\r\n\r\n  if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\r\n  mY -= lineBox.top - display.viewOffset\r\n\r\n  for (var i = 0; i < cm.options.gutters.length; ++i) {\r\n    var g = display.gutters.childNodes[i]\r\n    if (g && g.getBoundingClientRect().right >= mX) {\r\n      var line = lineAtHeight(cm.doc, mY)\r\n      var gutter = cm.options.gutters[i]\r\n      signal(cm, type, cm, line, gutter, e)\r\n      return e_defaultPrevented(e)\r\n    }\r\n  }\r\n}\r\n\r\nfunction clickInGutter(cm, e) {\r\n  return gutterEvent(cm, e, \"gutterClick\", true)\r\n}\r\n\r\n\r\nfunction onContextMenu(cm, e) {\r\n  if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\r\n  if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\r\n  cm.display.input.onContextMenu(e)\r\n}\r\n\r\nfunction contextMenuInGutter(cm, e) {\r\n  if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\r\n  return gutterEvent(cm, e, \"gutterContextMenu\", false)\r\n}\r\n\r\nfunction themeChanged(cm) {\r\n  cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\r\n    cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\")\r\n  clearCaches(cm)\r\n}\r\n\r\nvar Init = {toString: function(){return \"CodeMirror.Init\"}}\r\n\r\nvar defaults = {}\r\nvar optionHandlers = {}\r\n\r\nfunction defineOptions(CodeMirror) {\r\n  var optionHandlers = CodeMirror.optionHandlers\r\n\r\n  function option(name, deflt, handle, notOnInit) {\r\n    CodeMirror.defaults[name] = deflt\r\n    if (handle) { optionHandlers[name] =\r\n      notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old) }} : handle }\r\n  }\r\n\r\n  CodeMirror.defineOption = option\r\n\r\n  CodeMirror.Init = Init\r\n\r\n  option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true)\r\n  option(\"mode\", null, function (cm, val) {\r\n    cm.doc.modeOption = val\r\n    loadMode(cm)\r\n  }, true)\r\n\r\n  option(\"indentUnit\", 2, loadMode, true)\r\n  option(\"indentWithTabs\", false)\r\n  option(\"smartIndent\", true)\r\n  option(\"tabSize\", 4, function (cm) {\r\n    resetModeState(cm)\r\n    clearCaches(cm)\r\n    regChange(cm)\r\n  }, true)\r\n  option(\"lineSeparator\", null, function (cm, val) {\r\n    cm.doc.lineSep = val\r\n    if (!val) { return }\r\n    var newBreaks = [], lineNo = cm.doc.first\r\n    cm.doc.iter(function (line) {\r\n      for (var pos = 0;;) {\r\n        var found = line.text.indexOf(val, pos)\r\n        if (found == -1) { break }\r\n        pos = found + val.length\r\n        newBreaks.push(Pos(lineNo, found))\r\n      }\r\n      lineNo++\r\n    })\r\n    for (var i = newBreaks.length - 1; i >= 0; i--)\r\n      { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)) }\r\n  })\r\n  option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200f\\u2028\\u2029\\ufeff]/g, function (cm, val, old) {\r\n    cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\")\r\n    if (old != Init) { cm.refresh() }\r\n  })\r\n  option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true)\r\n  option(\"electricChars\", true)\r\n  option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\r\n    throw new Error(\"inputStyle can not (yet) be changed in a running editor\") \r\n  }, true)\r\n  option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true)\r\n  option(\"rtlMoveVisually\", !windows)\r\n  option(\"wholeLineUpdateBefore\", true)\r\n\r\n  option(\"theme\", \"default\", function (cm) {\r\n    themeChanged(cm)\r\n    guttersChanged(cm)\r\n  }, true)\r\n  option(\"keyMap\", \"default\", function (cm, val, old) {\r\n    var next = getKeyMap(val)\r\n    var prev = old != Init && getKeyMap(old)\r\n    if (prev && prev.detach) { prev.detach(cm, next) }\r\n    if (next.attach) { next.attach(cm, prev || null) }\r\n  })\r\n  option(\"extraKeys\", null)\r\n  option(\"configureMouse\", null)\r\n\r\n  option(\"lineWrapping\", false, wrappingChanged, true)\r\n  option(\"gutters\", [], function (cm) {\r\n    setGuttersForLineNumbers(cm.options)\r\n    guttersChanged(cm)\r\n  }, true)\r\n  option(\"fixedGutter\", true, function (cm, val) {\r\n    cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\"\r\n    cm.refresh()\r\n  }, true)\r\n  option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true)\r\n  option(\"scrollbarStyle\", \"native\", function (cm) {\r\n    initScrollbars(cm)\r\n    updateScrollbars(cm)\r\n    cm.display.scrollbars.setScrollTop(cm.doc.scrollTop)\r\n    cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft)\r\n  }, true)\r\n  option(\"lineNumbers\", false, function (cm) {\r\n    setGuttersForLineNumbers(cm.options)\r\n    guttersChanged(cm)\r\n  }, true)\r\n  option(\"firstLineNumber\", 1, guttersChanged, true)\r\n  option(\"lineNumberFormatter\", function (integer) { return integer; }, guttersChanged, true)\r\n  option(\"showCursorWhenSelecting\", false, updateSelection, true)\r\n\r\n  option(\"resetSelectionOnContextMenu\", true)\r\n  option(\"lineWiseCopyCut\", true)\r\n  option(\"pasteLinesPerSelection\", true)\r\n\r\n  option(\"readOnly\", false, function (cm, val) {\r\n    if (val == \"nocursor\") {\r\n      onBlur(cm)\r\n      cm.display.input.blur()\r\n    }\r\n    cm.display.input.readOnlyChanged(val)\r\n  })\r\n  option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset() }}, true)\r\n  option(\"dragDrop\", true, dragDropChanged)\r\n  option(\"allowDropFileTypes\", null)\r\n\r\n  option(\"cursorBlinkRate\", 530)\r\n  option(\"cursorScrollMargin\", 0)\r\n  option(\"cursorHeight\", 1, updateSelection, true)\r\n  option(\"singleCursorHeightPerLine\", true, updateSelection, true)\r\n  option(\"workTime\", 100)\r\n  option(\"workDelay\", 100)\r\n  option(\"flattenSpans\", true, resetModeState, true)\r\n  option(\"addModeClass\", false, resetModeState, true)\r\n  option(\"pollInterval\", 100)\r\n  option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; })\r\n  option(\"historyEventDelay\", 1250)\r\n  option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true)\r\n  option(\"maxHighlightLength\", 10000, resetModeState, true)\r\n  option(\"moveInputWithCursor\", true, function (cm, val) {\r\n    if (!val) { cm.display.input.resetPosition() }\r\n  })\r\n\r\n  option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; })\r\n  option(\"autofocus\", null)\r\n  option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true)\r\n}\r\n\r\nfunction guttersChanged(cm) {\r\n  updateGutters(cm)\r\n  regChange(cm)\r\n  alignHorizontally(cm)\r\n}\r\n\r\nfunction dragDropChanged(cm, value, old) {\r\n  var wasOn = old && old != Init\r\n  if (!value != !wasOn) {\r\n    var funcs = cm.display.dragFunctions\r\n    var toggle = value ? on : off\r\n    toggle(cm.display.scroller, \"dragstart\", funcs.start)\r\n    toggle(cm.display.scroller, \"dragenter\", funcs.enter)\r\n    toggle(cm.display.scroller, \"dragover\", funcs.over)\r\n    toggle(cm.display.scroller, \"dragleave\", funcs.leave)\r\n    toggle(cm.display.scroller, \"drop\", funcs.drop)\r\n  }\r\n}\r\n\r\nfunction wrappingChanged(cm) {\r\n  if (cm.options.lineWrapping) {\r\n    addClass(cm.display.wrapper, \"CodeMirror-wrap\")\r\n    cm.display.sizer.style.minWidth = \"\"\r\n    cm.display.sizerWidth = null\r\n  } else {\r\n    rmClass(cm.display.wrapper, \"CodeMirror-wrap\")\r\n    findMaxLine(cm)\r\n  }\r\n  estimateLineHeights(cm)\r\n  regChange(cm)\r\n  clearCaches(cm)\r\n  setTimeout(function () { return updateScrollbars(cm); }, 100)\r\n}\r\n\r\n\r\nfunction CodeMirror(place, options) {\r\n  var this$1 = this;\r\n\r\n  if (!(this instanceof CodeMirror)) { return new CodeMirror(place, options) }\r\n\r\n  this.options = options = options ? copyObj(options) : {}\r\n  copyObj(defaults, options, false)\r\n  setGuttersForLineNumbers(options)\r\n\r\n  var doc = options.value\r\n  if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction) }\r\n  this.doc = doc\r\n\r\n  var input = new CodeMirror.inputStyles[options.inputStyle](this)\r\n  var display = this.display = new Display(place, doc, input)\r\n  display.wrapper.CodeMirror = this\r\n  updateGutters(this)\r\n  themeChanged(this)\r\n  if (options.lineWrapping)\r\n    { this.display.wrapper.className += \" CodeMirror-wrap\" }\r\n  initScrollbars(this)\r\n\r\n  this.state = {\r\n    keyMaps: [],  \r\n    overlays: [], \r\n    modeGen: 0,   \r\n    overwrite: false,\r\n    delayingBlurEvent: false,\r\n    focused: false,\r\n    suppressEdits: false, \r\n    pasteIncoming: false, cutIncoming: false, \r\n    selectingText: false,\r\n    draggingText: false,\r\n    highlight: new Delayed(), \r\n    keySeq: null,  \r\n    specialChars: null\r\n  }\r\n\r\n  if (options.autofocus && !mobile) { display.input.focus() }\r\n\r\n  if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20) }\r\n\r\n  registerEventHandlers(this)\r\n  ensureGlobalHandlers()\r\n\r\n  startOperation(this)\r\n  this.curOp.forceUpdate = true\r\n  attachDoc(this, doc)\r\n\r\n  if ((options.autofocus && !mobile) || this.hasFocus())\r\n    { setTimeout(bind(onFocus, this), 20) }\r\n  else\r\n    { onBlur(this) }\r\n\r\n  for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\r\n    { optionHandlers[opt](this$1, options[opt], Init) } }\r\n  maybeUpdateLineNumberWidth(this)\r\n  if (options.finishInit) { options.finishInit(this) }\r\n  for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this$1) }\r\n  endOperation(this)\r\n  if (webkit && options.lineWrapping &&\r\n      getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\r\n    { display.lineDiv.style.textRendering = \"auto\" }\r\n}\r\n\r\nCodeMirror.defaults = defaults\r\nCodeMirror.optionHandlers = optionHandlers\r\n\r\nfunction registerEventHandlers(cm) {\r\n  var d = cm.display\r\n  on(d.scroller, \"mousedown\", operation(cm, onMouseDown))\r\n  if (ie && ie_version < 11)\r\n    { on(d.scroller, \"dblclick\", operation(cm, function (e) {\r\n      if (signalDOMEvent(cm, e)) { return }\r\n      var pos = posFromMouse(cm, e)\r\n      if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\r\n      e_preventDefault(e)\r\n      var word = cm.findWordAt(pos)\r\n      extendSelection(cm.doc, word.anchor, word.head)\r\n    })) }\r\n  else\r\n    { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }) }\r\n  if (!captureRightClick) { on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); }) }\r\n\r\n  var touchFinished, prevTouch = {end: 0}\r\n  function finishTouch() {\r\n    if (d.activeTouch) {\r\n      touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000)\r\n      prevTouch = d.activeTouch\r\n      prevTouch.end = +new Date\r\n    }\r\n  }\r\n  function isMouseLikeTouchEvent(e) {\r\n    if (e.touches.length != 1) { return false }\r\n    var touch = e.touches[0]\r\n    return touch.radiusX <= 1 && touch.radiusY <= 1\r\n  }\r\n  function farAway(touch, other) {\r\n    if (other.left == null) { return true }\r\n    var dx = other.left - touch.left, dy = other.top - touch.top\r\n    return dx * dx + dy * dy > 20 * 20\r\n  }\r\n  on(d.scroller, \"touchstart\", function (e) {\r\n    if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\r\n      d.input.ensurePolled()\r\n      clearTimeout(touchFinished)\r\n      var now = +new Date\r\n      d.activeTouch = {start: now, moved: false,\r\n                       prev: now - prevTouch.end <= 300 ? prevTouch : null}\r\n      if (e.touches.length == 1) {\r\n        d.activeTouch.left = e.touches[0].pageX\r\n        d.activeTouch.top = e.touches[0].pageY\r\n      }\r\n    }\r\n  })\r\n  on(d.scroller, \"touchmove\", function () {\r\n    if (d.activeTouch) { d.activeTouch.moved = true }\r\n  })\r\n  on(d.scroller, \"touchend\", function (e) {\r\n    var touch = d.activeTouch\r\n    if (touch && !eventInWidget(d, e) && touch.left != null &&\r\n        !touch.moved && new Date - touch.start < 300) {\r\n      var pos = cm.coordsChar(d.activeTouch, \"page\"), range\r\n      if (!touch.prev || farAway(touch, touch.prev)) \r\n        { range = new Range(pos, pos) }\r\n      else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) \r\n        { range = cm.findWordAt(pos) }\r\n      else \r\n        { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\r\n      cm.setSelection(range.anchor, range.head)\r\n      cm.focus()\r\n      e_preventDefault(e)\r\n    }\r\n    finishTouch()\r\n  })\r\n  on(d.scroller, \"touchcancel\", finishTouch)\r\n\r\n  on(d.scroller, \"scroll\", function () {\r\n    if (d.scroller.clientHeight) {\r\n      updateScrollTop(cm, d.scroller.scrollTop)\r\n      setScrollLeft(cm, d.scroller.scrollLeft, true)\r\n      signal(cm, \"scroll\", cm)\r\n    }\r\n  })\r\n\r\n  on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); })\r\n  on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); })\r\n\r\n  on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; })\r\n\r\n  d.dragFunctions = {\r\n    enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e) }},\r\n    over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e) }},\r\n    start: function (e) { return onDragStart(cm, e); },\r\n    drop: operation(cm, onDrop),\r\n    leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm) }}\r\n  }\r\n\r\n  var inp = d.input.getField()\r\n  on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); })\r\n  on(inp, \"keydown\", operation(cm, onKeyDown))\r\n  on(inp, \"keypress\", operation(cm, onKeyPress))\r\n  on(inp, \"focus\", function (e) { return onFocus(cm, e); })\r\n  on(inp, \"blur\", function (e) { return onBlur(cm, e); })\r\n}\r\n\r\nvar initHooks = []\r\nCodeMirror.defineInitHook = function (f) { return initHooks.push(f); }\r\n\r\nfunction indentLine(cm, n, how, aggressive) {\r\n  var doc = cm.doc, state\r\n  if (how == null) { how = \"add\" }\r\n  if (how == \"smart\") {\r\n    if (!doc.mode.indent) { how = \"prev\" }\r\n    else { state = getContextBefore(cm, n).state }\r\n  }\r\n\r\n  var tabSize = cm.options.tabSize\r\n  var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize)\r\n  if (line.stateAfter) { line.stateAfter = null }\r\n  var curSpaceString = line.text.match(/^\\s*/)[0], indentation\r\n  if (!aggressive && !/\\S/.test(line.text)) {\r\n    indentation = 0\r\n    how = \"not\"\r\n  } else if (how == \"smart\") {\r\n    indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text)\r\n    if (indentation == Pass || indentation > 150) {\r\n      if (!aggressive) { return }\r\n      how = \"prev\"\r\n    }\r\n  }\r\n  if (how == \"prev\") {\r\n    if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize) }\r\n    else { indentation = 0 }\r\n  } else if (how == \"add\") {\r\n    indentation = curSpace + cm.options.indentUnit\r\n  } else if (how == \"subtract\") {\r\n    indentation = curSpace - cm.options.indentUnit\r\n  } else if (typeof how == \"number\") {\r\n    indentation = curSpace + how\r\n  }\r\n  indentation = Math.max(0, indentation)\r\n\r\n  var indentString = \"\", pos = 0\r\n  if (cm.options.indentWithTabs)\r\n    { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\"} }\r\n  if (pos < indentation) { indentString += spaceStr(indentation - pos) }\r\n\r\n  if (indentString != curSpaceString) {\r\n    replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\")\r\n    line.stateAfter = null\r\n    return true\r\n  } else {\r\n    for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\r\n      var range = doc.sel.ranges[i$1]\r\n      if (range.head.line == n && range.head.ch < curSpaceString.length) {\r\n        var pos$1 = Pos(n, curSpaceString.length)\r\n        replaceOneSelection(doc, i$1, new Range(pos$1, pos$1))\r\n        break\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nvar lastCopied = null\r\n\r\nfunction setLastCopied(newLastCopied) {\r\n  lastCopied = newLastCopied\r\n}\r\n\r\nfunction applyTextInput(cm, inserted, deleted, sel, origin) {\r\n  var doc = cm.doc\r\n  cm.display.shift = false\r\n  if (!sel) { sel = doc.sel }\r\n\r\n  var paste = cm.state.pasteIncoming || origin == \"paste\"\r\n  var textLines = splitLinesAuto(inserted), multiPaste = null\r\n  if (paste && sel.ranges.length > 1) {\r\n    if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\r\n      if (sel.ranges.length % lastCopied.text.length == 0) {\r\n        multiPaste = []\r\n        for (var i = 0; i < lastCopied.text.length; i++)\r\n          { multiPaste.push(doc.splitLines(lastCopied.text[i])) }\r\n      }\r\n    } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\r\n      multiPaste = map(textLines, function (l) { return [l]; })\r\n    }\r\n  }\r\n\r\n  var updateInput\r\n  for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\r\n    var range = sel.ranges[i$1]\r\n    var from = range.from(), to = range.to()\r\n    if (range.empty()) {\r\n      if (deleted && deleted > 0) \r\n        { from = Pos(from.line, from.ch - deleted) }\r\n      else if (cm.state.overwrite && !paste) \r\n        { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)) }\r\n      else if (lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == inserted)\r\n        { from = to = Pos(from.line, 0) }\r\n    }\r\n    updateInput = cm.curOp.updateInput\r\n    var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\r\n                       origin: origin || (paste ? \"paste\" : cm.state.cutIncoming ? \"cut\" : \"+input\")}\r\n    makeChange(cm.doc, changeEvent)\r\n    signalLater(cm, \"inputRead\", cm, changeEvent)\r\n  }\r\n  if (inserted && !paste)\r\n    { triggerElectric(cm, inserted) }\r\n\r\n  ensureCursorVisible(cm)\r\n  cm.curOp.updateInput = updateInput\r\n  cm.curOp.typing = true\r\n  cm.state.pasteIncoming = cm.state.cutIncoming = false\r\n}\r\n\r\nfunction handlePaste(e, cm) {\r\n  var pasted = e.clipboardData && e.clipboardData.getData(\"Text\")\r\n  if (pasted) {\r\n    e.preventDefault()\r\n    if (!cm.isReadOnly() && !cm.options.disableInput)\r\n      { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }) }\r\n    return true\r\n  }\r\n}\r\n\r\nfunction triggerElectric(cm, inserted) {\r\n  if (!cm.options.electricChars || !cm.options.smartIndent) { return }\r\n  var sel = cm.doc.sel\r\n\r\n  for (var i = sel.ranges.length - 1; i >= 0; i--) {\r\n    var range = sel.ranges[i]\r\n    if (range.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range.head.line)) { continue }\r\n    var mode = cm.getModeAt(range.head)\r\n    var indented = false\r\n    if (mode.electricChars) {\r\n      for (var j = 0; j < mode.electricChars.length; j++)\r\n        { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\r\n          indented = indentLine(cm, range.head.line, \"smart\")\r\n          break\r\n        } }\r\n    } else if (mode.electricInput) {\r\n      if (mode.electricInput.test(getLine(cm.doc, range.head.line).text.slice(0, range.head.ch)))\r\n        { indented = indentLine(cm, range.head.line, \"smart\") }\r\n    }\r\n    if (indented) { signalLater(cm, \"electricInput\", cm, range.head.line) }\r\n  }\r\n}\r\n\r\nfunction copyableRanges(cm) {\r\n  var text = [], ranges = []\r\n  for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\r\n    var line = cm.doc.sel.ranges[i].head.line\r\n    var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)}\r\n    ranges.push(lineRange)\r\n    text.push(cm.getRange(lineRange.anchor, lineRange.head))\r\n  }\r\n  return {text: text, ranges: ranges}\r\n}\r\n\r\nfunction disableBrowserMagic(field, spellcheck) {\r\n  field.setAttribute(\"autocorrect\", \"off\")\r\n  field.setAttribute(\"autocapitalize\", \"off\")\r\n  field.setAttribute(\"spellcheck\", !!spellcheck)\r\n}\r\n\r\nfunction hiddenTextarea() {\r\n  var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\")\r\n  var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\")\r\n  if (webkit) { te.style.width = \"1000px\" }\r\n  else { te.setAttribute(\"wrap\", \"off\") }\r\n  if (ios) { te.style.border = \"1px solid black\" }\r\n  disableBrowserMagic(te)\r\n  return div\r\n}\r\n\r\n\r\n\r\nfunction addEditorMethods(CodeMirror) {\r\n  var optionHandlers = CodeMirror.optionHandlers\r\n\r\n  var helpers = CodeMirror.helpers = {}\r\n\r\n  CodeMirror.prototype = {\r\n    constructor: CodeMirror,\r\n    focus: function(){window.focus(); this.display.input.focus()},\r\n\r\n    setOption: function(option, value) {\r\n      var options = this.options, old = options[option]\r\n      if (options[option] == value && option != \"mode\") { return }\r\n      options[option] = value\r\n      if (optionHandlers.hasOwnProperty(option))\r\n        { operation(this, optionHandlers[option])(this, value, old) }\r\n      signal(this, \"optionChange\", this, option)\r\n    },\r\n\r\n    getOption: function(option) {return this.options[option]},\r\n    getDoc: function() {return this.doc},\r\n\r\n    addKeyMap: function(map, bottom) {\r\n      this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map))\r\n    },\r\n    removeKeyMap: function(map) {\r\n      var maps = this.state.keyMaps\r\n      for (var i = 0; i < maps.length; ++i)\r\n        { if (maps[i] == map || maps[i].name == map) {\r\n          maps.splice(i, 1)\r\n          return true\r\n        } }\r\n    },\r\n\r\n    addOverlay: methodOp(function(spec, options) {\r\n      var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec)\r\n      if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\r\n      insertSorted(this.state.overlays,\r\n                   {mode: mode, modeSpec: spec, opaque: options && options.opaque,\r\n                    priority: (options && options.priority) || 0},\r\n                   function (overlay) { return overlay.priority; })\r\n      this.state.modeGen++\r\n      regChange(this)\r\n    }),\r\n    removeOverlay: methodOp(function(spec) {\r\n      var this$1 = this;\r\n\r\n      var overlays = this.state.overlays\r\n      for (var i = 0; i < overlays.length; ++i) {\r\n        var cur = overlays[i].modeSpec\r\n        if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\r\n          overlays.splice(i, 1)\r\n          this$1.state.modeGen++\r\n          regChange(this$1)\r\n          return\r\n        }\r\n      }\r\n    }),\r\n\r\n    indentLine: methodOp(function(n, dir, aggressive) {\r\n      if (typeof dir != \"string\" && typeof dir != \"number\") {\r\n        if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\" }\r\n        else { dir = dir ? \"add\" : \"subtract\" }\r\n      }\r\n      if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive) }\r\n    }),\r\n    indentSelection: methodOp(function(how) {\r\n      var this$1 = this;\r\n\r\n      var ranges = this.doc.sel.ranges, end = -1\r\n      for (var i = 0; i < ranges.length; i++) {\r\n        var range = ranges[i]\r\n        if (!range.empty()) {\r\n          var from = range.from(), to = range.to()\r\n          var start = Math.max(end, from.line)\r\n          end = Math.min(this$1.lastLine(), to.line - (to.ch ? 0 : 1)) + 1\r\n          for (var j = start; j < end; ++j)\r\n            { indentLine(this$1, j, how) }\r\n          var newRanges = this$1.doc.sel.ranges\r\n          if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\r\n            { replaceOneSelection(this$1.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll) }\r\n        } else if (range.head.line > end) {\r\n          indentLine(this$1, range.head.line, how, true)\r\n          end = range.head.line\r\n          if (i == this$1.doc.sel.primIndex) { ensureCursorVisible(this$1) }\r\n        }\r\n      }\r\n    }),\r\n\r\n    getTokenAt: function(pos, precise) {\r\n      return takeToken(this, pos, precise)\r\n    },\r\n\r\n    getLineTokens: function(line, precise) {\r\n      return takeToken(this, Pos(line), precise, true)\r\n    },\r\n\r\n    getTokenTypeAt: function(pos) {\r\n      pos = clipPos(this.doc, pos)\r\n      var styles = getLineStyles(this, getLine(this.doc, pos.line))\r\n      var before = 0, after = (styles.length - 1) / 2, ch = pos.ch\r\n      var type\r\n      if (ch == 0) { type = styles[2] }\r\n      else { for (;;) {\r\n        var mid = (before + after) >> 1\r\n        if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid }\r\n        else if (styles[mid * 2 + 1] < ch) { before = mid + 1 }\r\n        else { type = styles[mid * 2 + 2]; break }\r\n      } }\r\n      var cut = type ? type.indexOf(\"overlay \") : -1\r\n      return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\r\n    },\r\n\r\n    getModeAt: function(pos) {\r\n      var mode = this.doc.mode\r\n      if (!mode.innerMode) { return mode }\r\n      return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\r\n    },\r\n\r\n    getHelper: function(pos, type) {\r\n      return this.getHelpers(pos, type)[0]\r\n    },\r\n\r\n    getHelpers: function(pos, type) {\r\n      var this$1 = this;\r\n\r\n      var found = []\r\n      if (!helpers.hasOwnProperty(type)) { return found }\r\n      var help = helpers[type], mode = this.getModeAt(pos)\r\n      if (typeof mode[type] == \"string\") {\r\n        if (help[mode[type]]) { found.push(help[mode[type]]) }\r\n      } else if (mode[type]) {\r\n        for (var i = 0; i < mode[type].length; i++) {\r\n          var val = help[mode[type][i]]\r\n          if (val) { found.push(val) }\r\n        }\r\n      } else if (mode.helperType && help[mode.helperType]) {\r\n        found.push(help[mode.helperType])\r\n      } else if (help[mode.name]) {\r\n        found.push(help[mode.name])\r\n      }\r\n      for (var i$1 = 0; i$1 < help._global.length; i$1++) {\r\n        var cur = help._global[i$1]\r\n        if (cur.pred(mode, this$1) && indexOf(found, cur.val) == -1)\r\n          { found.push(cur.val) }\r\n      }\r\n      return found\r\n    },\r\n\r\n    getStateAfter: function(line, precise) {\r\n      var doc = this.doc\r\n      line = clipLine(doc, line == null ? doc.first + doc.size - 1: line)\r\n      return getContextBefore(this, line + 1, precise).state\r\n    },\r\n\r\n    cursorCoords: function(start, mode) {\r\n      var pos, range = this.doc.sel.primary()\r\n      if (start == null) { pos = range.head }\r\n      else if (typeof start == \"object\") { pos = clipPos(this.doc, start) }\r\n      else { pos = start ? range.from() : range.to() }\r\n      return cursorCoords(this, pos, mode || \"page\")\r\n    },\r\n\r\n    charCoords: function(pos, mode) {\r\n      return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\r\n    },\r\n\r\n    coordsChar: function(coords, mode) {\r\n      coords = fromCoordSystem(this, coords, mode || \"page\")\r\n      return coordsChar(this, coords.left, coords.top)\r\n    },\r\n\r\n    lineAtHeight: function(height, mode) {\r\n      height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top\r\n      return lineAtHeight(this.doc, height + this.display.viewOffset)\r\n    },\r\n    heightAtLine: function(line, mode, includeWidgets) {\r\n      var end = false, lineObj\r\n      if (typeof line == \"number\") {\r\n        var last = this.doc.first + this.doc.size - 1\r\n        if (line < this.doc.first) { line = this.doc.first }\r\n        else if (line > last) { line = last; end = true }\r\n        lineObj = getLine(this.doc, line)\r\n      } else {\r\n        lineObj = line\r\n      }\r\n      return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\r\n        (end ? this.doc.height - heightAtLine(lineObj) : 0)\r\n    },\r\n\r\n    defaultTextHeight: function() { return textHeight(this.display) },\r\n    defaultCharWidth: function() { return charWidth(this.display) },\r\n\r\n    getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\r\n\r\n    addWidget: function(pos, node, scroll, vert, horiz) {\r\n      var display = this.display\r\n      pos = cursorCoords(this, clipPos(this.doc, pos))\r\n      var top = pos.bottom, left = pos.left\r\n      node.style.position = \"absolute\"\r\n      node.setAttribute(\"cm-ignore-events\", \"true\")\r\n      this.display.input.setUneditable(node)\r\n      display.sizer.appendChild(node)\r\n      if (vert == \"over\") {\r\n        top = pos.top\r\n      } else if (vert == \"above\" || vert == \"near\") {\r\n        var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\r\n        hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth)\r\n        if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\r\n          { top = pos.top - node.offsetHeight }\r\n        else if (pos.bottom + node.offsetHeight <= vspace)\r\n          { top = pos.bottom }\r\n        if (left + node.offsetWidth > hspace)\r\n          { left = hspace - node.offsetWidth }\r\n      }\r\n      node.style.top = top + \"px\"\r\n      node.style.left = node.style.right = \"\"\r\n      if (horiz == \"right\") {\r\n        left = display.sizer.clientWidth - node.offsetWidth\r\n        node.style.right = \"0px\"\r\n      } else {\r\n        if (horiz == \"left\") { left = 0 }\r\n        else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2 }\r\n        node.style.left = left + \"px\"\r\n      }\r\n      if (scroll)\r\n        { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}) }\r\n    },\r\n\r\n    triggerOnKeyDown: methodOp(onKeyDown),\r\n    triggerOnKeyPress: methodOp(onKeyPress),\r\n    triggerOnKeyUp: onKeyUp,\r\n    triggerOnMouseDown: methodOp(onMouseDown),\r\n\r\n    execCommand: function(cmd) {\r\n      if (commands.hasOwnProperty(cmd))\r\n        { return commands[cmd].call(null, this) }\r\n    },\r\n\r\n    triggerElectric: methodOp(function(text) { triggerElectric(this, text) }),\r\n\r\n    findPosH: function(from, amount, unit, visually) {\r\n      var this$1 = this;\r\n\r\n      var dir = 1\r\n      if (amount < 0) { dir = -1; amount = -amount }\r\n      var cur = clipPos(this.doc, from)\r\n      for (var i = 0; i < amount; ++i) {\r\n        cur = findPosH(this$1.doc, cur, dir, unit, visually)\r\n        if (cur.hitSide) { break }\r\n      }\r\n      return cur\r\n    },\r\n\r\n    moveH: methodOp(function(dir, unit) {\r\n      var this$1 = this;\r\n\r\n      this.extendSelectionsBy(function (range) {\r\n        if (this$1.display.shift || this$1.doc.extend || range.empty())\r\n          { return findPosH(this$1.doc, range.head, dir, unit, this$1.options.rtlMoveVisually) }\r\n        else\r\n          { return dir < 0 ? range.from() : range.to() }\r\n      }, sel_move)\r\n    }),\r\n\r\n    deleteH: methodOp(function(dir, unit) {\r\n      var sel = this.doc.sel, doc = this.doc\r\n      if (sel.somethingSelected())\r\n        { doc.replaceSelection(\"\", null, \"+delete\") }\r\n      else\r\n        { deleteNearSelection(this, function (range) {\r\n          var other = findPosH(doc, range.head, dir, unit, false)\r\n          return dir < 0 ? {from: other, to: range.head} : {from: range.head, to: other}\r\n        }) }\r\n    }),\r\n\r\n    findPosV: function(from, amount, unit, goalColumn) {\r\n      var this$1 = this;\r\n\r\n      var dir = 1, x = goalColumn\r\n      if (amount < 0) { dir = -1; amount = -amount }\r\n      var cur = clipPos(this.doc, from)\r\n      for (var i = 0; i < amount; ++i) {\r\n        var coords = cursorCoords(this$1, cur, \"div\")\r\n        if (x == null) { x = coords.left }\r\n        else { coords.left = x }\r\n        cur = findPosV(this$1, coords, dir, unit)\r\n        if (cur.hitSide) { break }\r\n      }\r\n      return cur\r\n    },\r\n\r\n    moveV: methodOp(function(dir, unit) {\r\n      var this$1 = this;\r\n\r\n      var doc = this.doc, goals = []\r\n      var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected()\r\n      doc.extendSelectionsBy(function (range) {\r\n        if (collapse)\r\n          { return dir < 0 ? range.from() : range.to() }\r\n        var headPos = cursorCoords(this$1, range.head, \"div\")\r\n        if (range.goalColumn != null) { headPos.left = range.goalColumn }\r\n        goals.push(headPos.left)\r\n        var pos = findPosV(this$1, headPos, dir, unit)\r\n        if (unit == \"page\" && range == doc.sel.primary())\r\n          { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top) }\r\n        return pos\r\n      }, sel_move)\r\n      if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\r\n        { doc.sel.ranges[i].goalColumn = goals[i] } }\r\n    }),\r\n\r\n    findWordAt: function(pos) {\r\n      var doc = this.doc, line = getLine(doc, pos.line).text\r\n      var start = pos.ch, end = pos.ch\r\n      if (line) {\r\n        var helper = this.getHelper(pos, \"wordChars\")\r\n        if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end }\r\n        var startChar = line.charAt(start)\r\n        var check = isWordChar(startChar, helper)\r\n          ? function (ch) { return isWordChar(ch, helper); }\r\n          : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\r\n          : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); }\r\n        while (start > 0 && check(line.charAt(start - 1))) { --start }\r\n        while (end < line.length && check(line.charAt(end))) { ++end }\r\n      }\r\n      return new Range(Pos(pos.line, start), Pos(pos.line, end))\r\n    },\r\n\r\n    toggleOverwrite: function(value) {\r\n      if (value != null && value == this.state.overwrite) { return }\r\n      if (this.state.overwrite = !this.state.overwrite)\r\n        { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\") }\r\n      else\r\n        { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\") }\r\n\r\n      signal(this, \"overwriteToggle\", this, this.state.overwrite)\r\n    },\r\n    hasFocus: function() { return this.display.input.getField() == activeElt() },\r\n    isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\r\n\r\n    scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y) }),\r\n    getScrollInfo: function() {\r\n      var scroller = this.display.scroller\r\n      return {left: scroller.scrollLeft, top: scroller.scrollTop,\r\n              height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\r\n              width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\r\n              clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\r\n    },\r\n\r\n    scrollIntoView: methodOp(function(range, margin) {\r\n      if (range == null) {\r\n        range = {from: this.doc.sel.primary().head, to: null}\r\n        if (margin == null) { margin = this.options.cursorScrollMargin }\r\n      } else if (typeof range == \"number\") {\r\n        range = {from: Pos(range, 0), to: null}\r\n      } else if (range.from == null) {\r\n        range = {from: range, to: null}\r\n      }\r\n      if (!range.to) { range.to = range.from }\r\n      range.margin = margin || 0\r\n\r\n      if (range.from.line != null) {\r\n        scrollToRange(this, range)\r\n      } else {\r\n        scrollToCoordsRange(this, range.from, range.to, range.margin)\r\n      }\r\n    }),\r\n\r\n    setSize: methodOp(function(width, height) {\r\n      var this$1 = this;\r\n\r\n      var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; }\r\n      if (width != null) { this.display.wrapper.style.width = interpret(width) }\r\n      if (height != null) { this.display.wrapper.style.height = interpret(height) }\r\n      if (this.options.lineWrapping) { clearLineMeasurementCache(this) }\r\n      var lineNo = this.display.viewFrom\r\n      this.doc.iter(lineNo, this.display.viewTo, function (line) {\r\n        if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\r\n          { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo, \"widget\"); break } } }\r\n        ++lineNo\r\n      })\r\n      this.curOp.forceUpdate = true\r\n      signal(this, \"refresh\", this)\r\n    }),\r\n\r\n    operation: function(f){return runInOp(this, f)},\r\n    startOperation: function(){return startOperation(this)},\r\n    endOperation: function(){return endOperation(this)},\r\n\r\n    refresh: methodOp(function() {\r\n      var oldHeight = this.display.cachedTextHeight\r\n      regChange(this)\r\n      this.curOp.forceUpdate = true\r\n      clearCaches(this)\r\n      scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop)\r\n      updateGutterSpace(this)\r\n      if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5)\r\n        { estimateLineHeights(this) }\r\n      signal(this, \"refresh\", this)\r\n    }),\r\n\r\n    swapDoc: methodOp(function(doc) {\r\n      var old = this.doc\r\n      old.cm = null\r\n      attachDoc(this, doc)\r\n      clearCaches(this)\r\n      this.display.input.reset()\r\n      scrollToCoords(this, doc.scrollLeft, doc.scrollTop)\r\n      this.curOp.forceScroll = true\r\n      signalLater(this, \"swapDoc\", this, old)\r\n      return old\r\n    }),\r\n\r\n    getInputField: function(){return this.display.input.getField()},\r\n    getWrapperElement: function(){return this.display.wrapper},\r\n    getScrollerElement: function(){return this.display.scroller},\r\n    getGutterElement: function(){return this.display.gutters}\r\n  }\r\n  eventMixin(CodeMirror)\r\n\r\n  CodeMirror.registerHelper = function(type, name, value) {\r\n    if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []} }\r\n    helpers[type][name] = value\r\n  }\r\n  CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\r\n    CodeMirror.registerHelper(type, name, value)\r\n    helpers[type]._global.push({pred: predicate, val: value})\r\n  }\r\n}\r\n\r\nfunction findPosH(doc, pos, dir, unit, visually) {\r\n  var oldPos = pos\r\n  var origDir = dir\r\n  var lineObj = getLine(doc, pos.line)\r\n  function findNextLine() {\r\n    var l = pos.line + dir\r\n    if (l < doc.first || l >= doc.first + doc.size) { return false }\r\n    pos = new Pos(l, pos.ch, pos.sticky)\r\n    return lineObj = getLine(doc, l)\r\n  }\r\n  function moveOnce(boundToLine) {\r\n    var next\r\n    if (visually) {\r\n      next = moveVisually(doc.cm, lineObj, pos, dir)\r\n    } else {\r\n      next = moveLogically(lineObj, pos, dir)\r\n    }\r\n    if (next == null) {\r\n      if (!boundToLine && findNextLine())\r\n        { pos = endOfLine(visually, doc.cm, lineObj, pos.line, dir) }\r\n      else\r\n        { return false }\r\n    } else {\r\n      pos = next\r\n    }\r\n    return true\r\n  }\r\n\r\n  if (unit == \"char\") {\r\n    moveOnce()\r\n  } else if (unit == \"column\") {\r\n    moveOnce(true)\r\n  } else if (unit == \"word\" || unit == \"group\") {\r\n    var sawType = null, group = unit == \"group\"\r\n    var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\")\r\n    for (var first = true;; first = false) {\r\n      if (dir < 0 && !moveOnce(!first)) { break }\r\n      var cur = lineObj.text.charAt(pos.ch) || \"\\n\"\r\n      var type = isWordChar(cur, helper) ? \"w\"\r\n        : group && cur == \"\\n\" ? \"n\"\r\n        : !group || /\\s/.test(cur) ? null\r\n        : \"p\"\r\n      if (group && !first && !type) { type = \"s\" }\r\n      if (sawType && sawType != type) {\r\n        if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\"}\r\n        break\r\n      }\r\n\r\n      if (type) { sawType = type }\r\n      if (dir > 0 && !moveOnce(!first)) { break }\r\n    }\r\n  }\r\n  var result = skipAtomic(doc, pos, oldPos, origDir, true)\r\n  if (equalCursorPos(oldPos, result)) { result.hitSide = true }\r\n  return result\r\n}\r\n\r\nfunction findPosV(cm, pos, dir, unit) {\r\n  var doc = cm.doc, x = pos.left, y\r\n  if (unit == \"page\") {\r\n    var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight)\r\n    var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3)\r\n    y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount\r\n\r\n  } else if (unit == \"line\") {\r\n    y = dir > 0 ? pos.bottom + 3 : pos.top - 3\r\n  }\r\n  var target\r\n  for (;;) {\r\n    target = coordsChar(cm, x, y)\r\n    if (!target.outside) { break }\r\n    if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\r\n    y += dir * 5\r\n  }\r\n  return target\r\n}\r\n\r\n\r\nvar ContentEditableInput = function(cm) {\r\n  this.cm = cm\r\n  this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null\r\n  this.polling = new Delayed()\r\n  this.composing = null\r\n  this.gracePeriod = false\r\n  this.readDOMTimeout = null\r\n};\r\n\r\nContentEditableInput.prototype.init = function (display) {\r\n    var this$1 = this;\r\n\r\n  var input = this, cm = input.cm\r\n  var div = input.div = display.lineDiv\r\n  disableBrowserMagic(div, cm.options.spellcheck)\r\n\r\n  on(div, \"paste\", function (e) {\r\n    if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\r\n    if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20) }\r\n  })\r\n\r\n  on(div, \"compositionstart\", function (e) {\r\n    this$1.composing = {data: e.data, done: false}\r\n  })\r\n  on(div, \"compositionupdate\", function (e) {\r\n    if (!this$1.composing) { this$1.composing = {data: e.data, done: false} }\r\n  })\r\n  on(div, \"compositionend\", function (e) {\r\n    if (this$1.composing) {\r\n      if (e.data != this$1.composing.data) { this$1.readFromDOMSoon() }\r\n      this$1.composing.done = true\r\n    }\r\n  })\r\n\r\n  on(div, \"touchstart\", function () { return input.forceCompositionEnd(); })\r\n\r\n  on(div, \"input\", function () {\r\n    if (!this$1.composing) { this$1.readFromDOMSoon() }\r\n  })\r\n\r\n  function onCopyCut(e) {\r\n    if (signalDOMEvent(cm, e)) { return }\r\n    if (cm.somethingSelected()) {\r\n      setLastCopied({lineWise: false, text: cm.getSelections()})\r\n      if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\") }\r\n    } else if (!cm.options.lineWiseCopyCut) {\r\n      return\r\n    } else {\r\n      var ranges = copyableRanges(cm)\r\n      setLastCopied({lineWise: true, text: ranges.text})\r\n      if (e.type == \"cut\") {\r\n        cm.operation(function () {\r\n          cm.setSelections(ranges.ranges, 0, sel_dontScroll)\r\n          cm.replaceSelection(\"\", null, \"cut\")\r\n        })\r\n      }\r\n    }\r\n    if (e.clipboardData) {\r\n      e.clipboardData.clearData()\r\n      var content = lastCopied.text.join(\"\\n\")\r\n      e.clipboardData.setData(\"Text\", content)\r\n      if (e.clipboardData.getData(\"Text\") == content) {\r\n        e.preventDefault()\r\n        return\r\n      }\r\n    }\r\n    var kludge = hiddenTextarea(), te = kludge.firstChild\r\n    cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild)\r\n    te.value = lastCopied.text.join(\"\\n\")\r\n    var hadFocus = document.activeElement\r\n    selectInput(te)\r\n    setTimeout(function () {\r\n      cm.display.lineSpace.removeChild(kludge)\r\n      hadFocus.focus()\r\n      if (hadFocus == div) { input.showPrimarySelection() }\r\n    }, 50)\r\n  }\r\n  on(div, \"copy\", onCopyCut)\r\n  on(div, \"cut\", onCopyCut)\r\n};\r\n\r\nContentEditableInput.prototype.prepareSelection = function () {\r\n  var result = prepareSelection(this.cm, false)\r\n  result.focus = this.cm.state.focused\r\n  return result\r\n};\r\n\r\nContentEditableInput.prototype.showSelection = function (info, takeFocus) {\r\n  if (!info || !this.cm.display.view.length) { return }\r\n  if (info.focus || takeFocus) { this.showPrimarySelection() }\r\n  this.showMultipleSelections(info)\r\n};\r\n\r\nContentEditableInput.prototype.showPrimarySelection = function () {\r\n  var sel = window.getSelection(), cm = this.cm, prim = cm.doc.sel.primary()\r\n  var from = prim.from(), to = prim.to()\r\n\r\n  if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\r\n    sel.removeAllRanges()\r\n    return\r\n  }\r\n\r\n  var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset)\r\n  var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset)\r\n  if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\r\n      cmp(minPos(curAnchor, curFocus), from) == 0 &&\r\n      cmp(maxPos(curAnchor, curFocus), to) == 0)\r\n    { return }\r\n\r\n  var view = cm.display.view\r\n  var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\r\n      {node: view[0].measure.map[2], offset: 0}\r\n  var end = to.line < cm.display.viewTo && posToDOM(cm, to)\r\n  if (!end) {\r\n    var measure = view[view.length - 1].measure\r\n    var map = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map\r\n    end = {node: map[map.length - 1], offset: map[map.length - 2] - map[map.length - 3]}\r\n  }\r\n\r\n  if (!start || !end) {\r\n    sel.removeAllRanges()\r\n    return\r\n  }\r\n\r\n  var old = sel.rangeCount && sel.getRangeAt(0), rng\r\n  try { rng = range(start.node, start.offset, end.offset, end.node) }\r\n  catch(e) {} \r\n  if (rng) {\r\n    if (!gecko && cm.state.focused) {\r\n      sel.collapse(start.node, start.offset)\r\n      if (!rng.collapsed) {\r\n        sel.removeAllRanges()\r\n        sel.addRange(rng)\r\n      }\r\n    } else {\r\n      sel.removeAllRanges()\r\n      sel.addRange(rng)\r\n    }\r\n    if (old && sel.anchorNode == null) { sel.addRange(old) }\r\n    else if (gecko) { this.startGracePeriod() }\r\n  }\r\n  this.rememberSelection()\r\n};\r\n\r\nContentEditableInput.prototype.startGracePeriod = function () {\r\n    var this$1 = this;\r\n\r\n  clearTimeout(this.gracePeriod)\r\n  this.gracePeriod = setTimeout(function () {\r\n    this$1.gracePeriod = false\r\n    if (this$1.selectionChanged())\r\n      { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }) }\r\n  }, 20)\r\n};\r\n\r\nContentEditableInput.prototype.showMultipleSelections = function (info) {\r\n  removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors)\r\n  removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection)\r\n};\r\n\r\nContentEditableInput.prototype.rememberSelection = function () {\r\n  var sel = window.getSelection()\r\n  this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset\r\n  this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset\r\n};\r\n\r\nContentEditableInput.prototype.selectionInEditor = function () {\r\n  var sel = window.getSelection()\r\n  if (!sel.rangeCount) { return false }\r\n  var node = sel.getRangeAt(0).commonAncestorContainer\r\n  return contains(this.div, node)\r\n};\r\n\r\nContentEditableInput.prototype.focus = function () {\r\n  if (this.cm.options.readOnly != \"nocursor\") {\r\n    if (!this.selectionInEditor())\r\n      { this.showSelection(this.prepareSelection(), true) }\r\n    this.div.focus()\r\n  }\r\n};\r\nContentEditableInput.prototype.blur = function () { this.div.blur() };\r\nContentEditableInput.prototype.getField = function () { return this.div };\r\n\r\nContentEditableInput.prototype.supportsTouch = function () { return true };\r\n\r\nContentEditableInput.prototype.receivedFocus = function () {\r\n  var input = this\r\n  if (this.selectionInEditor())\r\n    { this.pollSelection() }\r\n  else\r\n    { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }) }\r\n\r\n  function poll() {\r\n    if (input.cm.state.focused) {\r\n      input.pollSelection()\r\n      input.polling.set(input.cm.options.pollInterval, poll)\r\n    }\r\n  }\r\n  this.polling.set(this.cm.options.pollInterval, poll)\r\n};\r\n\r\nContentEditableInput.prototype.selectionChanged = function () {\r\n  var sel = window.getSelection()\r\n  return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\r\n    sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\r\n};\r\n\r\nContentEditableInput.prototype.pollSelection = function () {\r\n  if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\r\n  var sel = window.getSelection(), cm = this.cm\r\n  if (android && chrome && this.cm.options.gutters.length && isInGutter(sel.anchorNode)) {\r\n    this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs})\r\n    this.blur()\r\n    this.focus()\r\n    return\r\n  }\r\n  if (this.composing) { return }\r\n  this.rememberSelection()\r\n  var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset)\r\n  var head = domToPos(cm, sel.focusNode, sel.focusOffset)\r\n  if (anchor && head) { runInOp(cm, function () {\r\n    setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll)\r\n    if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true }\r\n  }) }\r\n};\r\n\r\nContentEditableInput.prototype.pollContent = function () {\r\n  if (this.readDOMTimeout != null) {\r\n    clearTimeout(this.readDOMTimeout)\r\n    this.readDOMTimeout = null\r\n  }\r\n\r\n  var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary()\r\n  var from = sel.from(), to = sel.to()\r\n  if (from.ch == 0 && from.line > cm.firstLine())\r\n    { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length) }\r\n  if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\r\n    { to = Pos(to.line + 1, 0) }\r\n  if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\r\n\r\n  var fromIndex, fromLine, fromNode\r\n  if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\r\n    fromLine = lineNo(display.view[0].line)\r\n    fromNode = display.view[0].node\r\n  } else {\r\n    fromLine = lineNo(display.view[fromIndex].line)\r\n    fromNode = display.view[fromIndex - 1].node.nextSibling\r\n  }\r\n  var toIndex = findViewIndex(cm, to.line)\r\n  var toLine, toNode\r\n  if (toIndex == display.view.length - 1) {\r\n    toLine = display.viewTo - 1\r\n    toNode = display.lineDiv.lastChild\r\n  } else {\r\n    toLine = lineNo(display.view[toIndex + 1].line) - 1\r\n    toNode = display.view[toIndex + 1].node.previousSibling\r\n  }\r\n\r\n  if (!fromNode) { return false }\r\n  var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine))\r\n  var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length))\r\n  while (newText.length > 1 && oldText.length > 1) {\r\n    if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine-- }\r\n    else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++ }\r\n    else { break }\r\n  }\r\n\r\n  var cutFront = 0, cutEnd = 0\r\n  var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length)\r\n  while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\r\n    { ++cutFront }\r\n  var newBot = lst(newText), oldBot = lst(oldText)\r\n  var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\r\n                           oldBot.length - (oldText.length == 1 ? cutFront : 0))\r\n  while (cutEnd < maxCutEnd &&\r\n         newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\r\n    { ++cutEnd }\r\n  if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\r\n    while (cutFront && cutFront > from.ch &&\r\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\r\n      cutFront--\r\n      cutEnd++\r\n    }\r\n  }\r\n\r\n  newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\")\r\n  newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\")\r\n\r\n  var chFrom = Pos(fromLine, cutFront)\r\n  var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0)\r\n  if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\r\n    replaceRange(cm.doc, newText, chFrom, chTo, \"+input\")\r\n    return true\r\n  }\r\n};\r\n\r\nContentEditableInput.prototype.ensurePolled = function () {\r\n  this.forceCompositionEnd()\r\n};\r\nContentEditableInput.prototype.reset = function () {\r\n  this.forceCompositionEnd()\r\n};\r\nContentEditableInput.prototype.forceCompositionEnd = function () {\r\n  if (!this.composing) { return }\r\n  clearTimeout(this.readDOMTimeout)\r\n  this.composing = null\r\n  this.updateFromDOM()\r\n  this.div.blur()\r\n  this.div.focus()\r\n};\r\nContentEditableInput.prototype.readFromDOMSoon = function () {\r\n    var this$1 = this;\r\n\r\n  if (this.readDOMTimeout != null) { return }\r\n  this.readDOMTimeout = setTimeout(function () {\r\n    this$1.readDOMTimeout = null\r\n    if (this$1.composing) {\r\n      if (this$1.composing.done) { this$1.composing = null }\r\n      else { return }\r\n    }\r\n    this$1.updateFromDOM()\r\n  }, 80)\r\n};\r\n\r\nContentEditableInput.prototype.updateFromDOM = function () {\r\n    var this$1 = this;\r\n\r\n  if (this.cm.isReadOnly() || !this.pollContent())\r\n    { runInOp(this.cm, function () { return regChange(this$1.cm); }) }\r\n};\r\n\r\nContentEditableInput.prototype.setUneditable = function (node) {\r\n  node.contentEditable = \"false\"\r\n};\r\n\r\nContentEditableInput.prototype.onKeyPress = function (e) {\r\n  if (e.charCode == 0) { return }\r\n  e.preventDefault()\r\n  if (!this.cm.isReadOnly())\r\n    { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0) }\r\n};\r\n\r\nContentEditableInput.prototype.readOnlyChanged = function (val) {\r\n  this.div.contentEditable = String(val != \"nocursor\")\r\n};\r\n\r\nContentEditableInput.prototype.onContextMenu = function () {};\r\nContentEditableInput.prototype.resetPosition = function () {};\r\n\r\nContentEditableInput.prototype.needsContentAttribute = true\r\n\r\nfunction posToDOM(cm, pos) {\r\n  var view = findViewForLine(cm, pos.line)\r\n  if (!view || view.hidden) { return null }\r\n  var line = getLine(cm.doc, pos.line)\r\n  var info = mapFromLineView(view, line, pos.line)\r\n\r\n  var order = getOrder(line, cm.doc.direction), side = \"left\"\r\n  if (order) {\r\n    var partPos = getBidiPartAt(order, pos.ch)\r\n    side = partPos % 2 ? \"right\" : \"left\"\r\n  }\r\n  var result = nodeAndOffsetInLineMap(info.map, pos.ch, side)\r\n  result.offset = result.collapse == \"right\" ? result.end : result.start\r\n  return result\r\n}\r\n\r\nfunction isInGutter(node) {\r\n  for (var scan = node; scan; scan = scan.parentNode)\r\n    { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\r\n  return false\r\n}\r\n\r\nfunction badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\r\n\r\nfunction domTextBetween(cm, from, to, fromLine, toLine) {\r\n  var text = \"\", closing = false, lineSep = cm.doc.lineSeparator()\r\n  function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\r\n  function close() {\r\n    if (closing) {\r\n      text += lineSep\r\n      closing = false\r\n    }\r\n  }\r\n  function addText(str) {\r\n    if (str) {\r\n      close()\r\n      text += str\r\n    }\r\n  }\r\n  function walk(node) {\r\n    if (node.nodeType == 1) {\r\n      var cmText = node.getAttribute(\"cm-text\")\r\n      if (cmText != null) {\r\n        addText(cmText || node.textContent.replace(/\\u200b/g, \"\"))\r\n        return\r\n      }\r\n      var markerID = node.getAttribute(\"cm-marker\"), range\r\n      if (markerID) {\r\n        var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID))\r\n        if (found.length && (range = found[0].find(0)))\r\n          { addText(getBetween(cm.doc, range.from, range.to).join(lineSep)) }\r\n        return\r\n      }\r\n      if (node.getAttribute(\"contenteditable\") == \"false\") { return }\r\n      var isBlock = /^(pre|div|p)$/i.test(node.nodeName)\r\n      if (isBlock) { close() }\r\n      for (var i = 0; i < node.childNodes.length; i++)\r\n        { walk(node.childNodes[i]) }\r\n      if (isBlock) { closing = true }\r\n    } else if (node.nodeType == 3) {\r\n      addText(node.nodeValue)\r\n    }\r\n  }\r\n  for (;;) {\r\n    walk(from)\r\n    if (from == to) { break }\r\n    from = from.nextSibling\r\n  }\r\n  return text\r\n}\r\n\r\nfunction domToPos(cm, node, offset) {\r\n  var lineNode\r\n  if (node == cm.display.lineDiv) {\r\n    lineNode = cm.display.lineDiv.childNodes[offset]\r\n    if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\r\n    node = null; offset = 0\r\n  } else {\r\n    for (lineNode = node;; lineNode = lineNode.parentNode) {\r\n      if (!lineNode || lineNode == cm.display.lineDiv) { return null }\r\n      if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\r\n    }\r\n  }\r\n  for (var i = 0; i < cm.display.view.length; i++) {\r\n    var lineView = cm.display.view[i]\r\n    if (lineView.node == lineNode)\r\n      { return locateNodeInLineView(lineView, node, offset) }\r\n  }\r\n}\r\n\r\nfunction locateNodeInLineView(lineView, node, offset) {\r\n  var wrapper = lineView.text.firstChild, bad = false\r\n  if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\r\n  if (node == wrapper) {\r\n    bad = true\r\n    node = wrapper.childNodes[offset]\r\n    offset = 0\r\n    if (!node) {\r\n      var line = lineView.rest ? lst(lineView.rest) : lineView.line\r\n      return badPos(Pos(lineNo(line), line.text.length), bad)\r\n    }\r\n  }\r\n\r\n  var textNode = node.nodeType == 3 ? node : null, topNode = node\r\n  if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\r\n    textNode = node.firstChild\r\n    if (offset) { offset = textNode.nodeValue.length }\r\n  }\r\n  while (topNode.parentNode != wrapper) { topNode = topNode.parentNode }\r\n  var measure = lineView.measure, maps = measure.maps\r\n\r\n  function find(textNode, topNode, offset) {\r\n    for (var i = -1; i < (maps ? maps.length : 0); i++) {\r\n      var map = i < 0 ? measure.map : maps[i]\r\n      for (var j = 0; j < map.length; j += 3) {\r\n        var curNode = map[j + 2]\r\n        if (curNode == textNode || curNode == topNode) {\r\n          var line = lineNo(i < 0 ? lineView.line : lineView.rest[i])\r\n          var ch = map[j] + offset\r\n          if (offset < 0 || curNode != textNode) { ch = map[j + (offset ? 1 : 0)] }\r\n          return Pos(line, ch)\r\n        }\r\n      }\r\n    }\r\n  }\r\n  var found = find(textNode, topNode, offset)\r\n  if (found) { return badPos(found, bad) }\r\n\r\n  for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\r\n    found = find(after, after.firstChild, 0)\r\n    if (found)\r\n      { return badPos(Pos(found.line, found.ch - dist), bad) }\r\n    else\r\n      { dist += after.textContent.length }\r\n  }\r\n  for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\r\n    found = find(before, before.firstChild, -1)\r\n    if (found)\r\n      { return badPos(Pos(found.line, found.ch + dist$1), bad) }\r\n    else\r\n      { dist$1 += before.textContent.length }\r\n  }\r\n}\r\n\r\n\r\nvar TextareaInput = function(cm) {\r\n  this.cm = cm\r\n  this.prevInput = \"\"\r\n\r\n  this.pollingFast = false\r\n  this.polling = new Delayed()\r\n  this.hasSelection = false\r\n  this.composing = null\r\n};\r\n\r\nTextareaInput.prototype.init = function (display) {\r\n    var this$1 = this;\r\n\r\n  var input = this, cm = this.cm\r\n\r\n  var div = this.wrapper = hiddenTextarea()\r\n  var te = this.textarea = div.firstChild\r\n  display.wrapper.insertBefore(div, display.wrapper.firstChild)\r\n\r\n  if (ios) { te.style.width = \"0px\" }\r\n\r\n  on(te, \"input\", function () {\r\n    if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null }\r\n    input.poll()\r\n  })\r\n\r\n  on(te, \"paste\", function (e) {\r\n    if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\r\n\r\n    cm.state.pasteIncoming = true\r\n    input.fastPoll()\r\n  })\r\n\r\n  function prepareCopyCut(e) {\r\n    if (signalDOMEvent(cm, e)) { return }\r\n    if (cm.somethingSelected()) {\r\n      setLastCopied({lineWise: false, text: cm.getSelections()})\r\n    } else if (!cm.options.lineWiseCopyCut) {\r\n      return\r\n    } else {\r\n      var ranges = copyableRanges(cm)\r\n      setLastCopied({lineWise: true, text: ranges.text})\r\n      if (e.type == \"cut\") {\r\n        cm.setSelections(ranges.ranges, null, sel_dontScroll)\r\n      } else {\r\n        input.prevInput = \"\"\r\n        te.value = ranges.text.join(\"\\n\")\r\n        selectInput(te)\r\n      }\r\n    }\r\n    if (e.type == \"cut\") { cm.state.cutIncoming = true }\r\n  }\r\n  on(te, \"cut\", prepareCopyCut)\r\n  on(te, \"copy\", prepareCopyCut)\r\n\r\n  on(display.scroller, \"paste\", function (e) {\r\n    if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\r\n    cm.state.pasteIncoming = true\r\n    input.focus()\r\n  })\r\n\r\n  on(display.lineSpace, \"selectstart\", function (e) {\r\n    if (!eventInWidget(display, e)) { e_preventDefault(e) }\r\n  })\r\n\r\n  on(te, \"compositionstart\", function () {\r\n    var start = cm.getCursor(\"from\")\r\n    if (input.composing) { input.composing.range.clear() }\r\n    input.composing = {\r\n      start: start,\r\n      range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\r\n    }\r\n  })\r\n  on(te, \"compositionend\", function () {\r\n    if (input.composing) {\r\n      input.poll()\r\n      input.composing.range.clear()\r\n      input.composing = null\r\n    }\r\n  })\r\n};\r\n\r\nTextareaInput.prototype.prepareSelection = function () {\r\n  var cm = this.cm, display = cm.display, doc = cm.doc\r\n  var result = prepareSelection(cm)\r\n\r\n  if (cm.options.moveInputWithCursor) {\r\n    var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\")\r\n    var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect()\r\n    result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\r\n                                        headPos.top + lineOff.top - wrapOff.top))\r\n    result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\r\n                                         headPos.left + lineOff.left - wrapOff.left))\r\n  }\r\n\r\n  return result\r\n};\r\n\r\nTextareaInput.prototype.showSelection = function (drawn) {\r\n  var cm = this.cm, display = cm.display\r\n  removeChildrenAndAdd(display.cursorDiv, drawn.cursors)\r\n  removeChildrenAndAdd(display.selectionDiv, drawn.selection)\r\n  if (drawn.teTop != null) {\r\n    this.wrapper.style.top = drawn.teTop + \"px\"\r\n    this.wrapper.style.left = drawn.teLeft + \"px\"\r\n  }\r\n};\r\n\r\nTextareaInput.prototype.reset = function (typing) {\r\n  if (this.contextMenuPending || this.composing) { return }\r\n  var cm = this.cm\r\n  if (cm.somethingSelected()) {\r\n    this.prevInput = \"\"\r\n    var content = cm.getSelection()\r\n    this.textarea.value = content\r\n    if (cm.state.focused) { selectInput(this.textarea) }\r\n    if (ie && ie_version >= 9) { this.hasSelection = content }\r\n  } else if (!typing) {\r\n    this.prevInput = this.textarea.value = \"\"\r\n    if (ie && ie_version >= 9) { this.hasSelection = null }\r\n  }\r\n};\r\n\r\nTextareaInput.prototype.getField = function () { return this.textarea };\r\n\r\nTextareaInput.prototype.supportsTouch = function () { return false };\r\n\r\nTextareaInput.prototype.focus = function () {\r\n  if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\r\n    try { this.textarea.focus() }\r\n    catch (e) {} \r\n  }\r\n};\r\n\r\nTextareaInput.prototype.blur = function () { this.textarea.blur() };\r\n\r\nTextareaInput.prototype.resetPosition = function () {\r\n  this.wrapper.style.top = this.wrapper.style.left = 0\r\n};\r\n\r\nTextareaInput.prototype.receivedFocus = function () { this.slowPoll() };\r\n\r\nTextareaInput.prototype.slowPoll = function () {\r\n    var this$1 = this;\r\n\r\n  if (this.pollingFast) { return }\r\n  this.polling.set(this.cm.options.pollInterval, function () {\r\n    this$1.poll()\r\n    if (this$1.cm.state.focused) { this$1.slowPoll() }\r\n  })\r\n};\r\n\r\nTextareaInput.prototype.fastPoll = function () {\r\n  var missed = false, input = this\r\n  input.pollingFast = true\r\n  function p() {\r\n    var changed = input.poll()\r\n    if (!changed && !missed) {missed = true; input.polling.set(60, p)}\r\n    else {input.pollingFast = false; input.slowPoll()}\r\n  }\r\n  input.polling.set(20, p)\r\n};\r\n\r\nTextareaInput.prototype.poll = function () {\r\n    var this$1 = this;\r\n\r\n  var cm = this.cm, input = this.textarea, prevInput = this.prevInput\r\n  if (this.contextMenuPending || !cm.state.focused ||\r\n      (hasSelection(input) && !prevInput && !this.composing) ||\r\n      cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\r\n    { return false }\r\n\r\n  var text = input.value\r\n  if (text == prevInput && !cm.somethingSelected()) { return false }\r\n  if (ie && ie_version >= 9 && this.hasSelection === text ||\r\n      mac && /[\\uf700-\\uf7ff]/.test(text)) {\r\n    cm.display.input.reset()\r\n    return false\r\n  }\r\n\r\n  if (cm.doc.sel == cm.display.selForContextMenu) {\r\n    var first = text.charCodeAt(0)\r\n    if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\" }\r\n    if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\r\n  }\r\n  var same = 0, l = Math.min(prevInput.length, text.length)\r\n  while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same }\r\n\r\n  runInOp(cm, function () {\r\n    applyTextInput(cm, text.slice(same), prevInput.length - same,\r\n                   null, this$1.composing ? \"*compose\" : null)\r\n\r\n    if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\" }\r\n    else { this$1.prevInput = text }\r\n\r\n    if (this$1.composing) {\r\n      this$1.composing.range.clear()\r\n      this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\r\n                                         {className: \"CodeMirror-composing\"})\r\n    }\r\n  })\r\n  return true\r\n};\r\n\r\nTextareaInput.prototype.ensurePolled = function () {\r\n  if (this.pollingFast && this.poll()) { this.pollingFast = false }\r\n};\r\n\r\nTextareaInput.prototype.onKeyPress = function () {\r\n  if (ie && ie_version >= 9) { this.hasSelection = null }\r\n  this.fastPoll()\r\n};\r\n\r\nTextareaInput.prototype.onContextMenu = function (e) {\r\n  var input = this, cm = input.cm, display = cm.display, te = input.textarea\r\n  var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop\r\n  if (!pos || presto) { return } \r\n\r\n  var reset = cm.options.resetSelectionOnContextMenu\r\n  if (reset && cm.doc.sel.contains(pos) == -1)\r\n    { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll) }\r\n\r\n  var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText\r\n  input.wrapper.style.cssText = \"position: absolute\"\r\n  var wrapperBox = input.wrapper.getBoundingClientRect()\r\n  te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\"\r\n  var oldScrollY\r\n  if (webkit) { oldScrollY = window.scrollY } \r\n  display.input.focus()\r\n  if (webkit) { window.scrollTo(null, oldScrollY) }\r\n  display.input.reset()\r\n  if (!cm.somethingSelected()) { te.value = input.prevInput = \" \" }\r\n  input.contextMenuPending = true\r\n  display.selForContextMenu = cm.doc.sel\r\n  clearTimeout(display.detectingSelectAll)\r\n\r\n  function prepareSelectAllHack() {\r\n    if (te.selectionStart != null) {\r\n      var selected = cm.somethingSelected()\r\n      var extval = \"\\u200b\" + (selected ? te.value : \"\")\r\n      te.value = \"\\u21da\" \r\n      te.value = extval\r\n      input.prevInput = selected ? \"\" : \"\\u200b\"\r\n      te.selectionStart = 1; te.selectionEnd = extval.length\r\n      display.selForContextMenu = cm.doc.sel\r\n    }\r\n  }\r\n  function rehide() {\r\n    input.contextMenuPending = false\r\n    input.wrapper.style.cssText = oldWrapperCSS\r\n    te.style.cssText = oldCSS\r\n    if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos) }\r\n\r\n    if (te.selectionStart != null) {\r\n      if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack() }\r\n      var i = 0, poll = function () {\r\n        if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\r\n            te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\r\n          operation(cm, selectAll)(cm)\r\n        } else if (i++ < 10) {\r\n          display.detectingSelectAll = setTimeout(poll, 500)\r\n        } else {\r\n          display.selForContextMenu = null\r\n          display.input.reset()\r\n        }\r\n      }\r\n      display.detectingSelectAll = setTimeout(poll, 200)\r\n    }\r\n  }\r\n\r\n  if (ie && ie_version >= 9) { prepareSelectAllHack() }\r\n  if (captureRightClick) {\r\n    e_stop(e)\r\n    var mouseup = function () {\r\n      off(window, \"mouseup\", mouseup)\r\n      setTimeout(rehide, 20)\r\n    }\r\n    on(window, \"mouseup\", mouseup)\r\n  } else {\r\n    setTimeout(rehide, 50)\r\n  }\r\n};\r\n\r\nTextareaInput.prototype.readOnlyChanged = function (val) {\r\n  if (!val) { this.reset() }\r\n  this.textarea.disabled = val == \"nocursor\"\r\n};\r\n\r\nTextareaInput.prototype.setUneditable = function () {};\r\n\r\nTextareaInput.prototype.needsContentAttribute = false\r\n\r\nfunction fromTextArea(textarea, options) {\r\n  options = options ? copyObj(options) : {}\r\n  options.value = textarea.value\r\n  if (!options.tabindex && textarea.tabIndex)\r\n    { options.tabindex = textarea.tabIndex }\r\n  if (!options.placeholder && textarea.placeholder)\r\n    { options.placeholder = textarea.placeholder }\r\n  if (options.autofocus == null) {\r\n    var hasFocus = activeElt()\r\n    options.autofocus = hasFocus == textarea ||\r\n      textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body\r\n  }\r\n\r\n  function save() {textarea.value = cm.getValue()}\r\n\r\n  var realSubmit\r\n  if (textarea.form) {\r\n    on(textarea.form, \"submit\", save)\r\n    if (!options.leaveSubmitMethodAlone) {\r\n      var form = textarea.form\r\n      realSubmit = form.submit\r\n      try {\r\n        var wrappedSubmit = form.submit = function () {\r\n          save()\r\n          form.submit = realSubmit\r\n          form.submit()\r\n          form.submit = wrappedSubmit\r\n        }\r\n      } catch(e) {}\r\n    }\r\n  }\r\n\r\n  options.finishInit = function (cm) {\r\n    cm.save = save\r\n    cm.getTextArea = function () { return textarea; }\r\n    cm.toTextArea = function () {\r\n      cm.toTextArea = isNaN \r\n      save()\r\n      textarea.parentNode.removeChild(cm.getWrapperElement())\r\n      textarea.style.display = \"\"\r\n      if (textarea.form) {\r\n        off(textarea.form, \"submit\", save)\r\n        if (typeof textarea.form.submit == \"function\")\r\n          { textarea.form.submit = realSubmit }\r\n      }\r\n    }\r\n  }\r\n\r\n  textarea.style.display = \"none\"\r\n  var cm = CodeMirror(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\r\n    options)\r\n  return cm\r\n}\r\n\r\nfunction addLegacyProps(CodeMirror) {\r\n  CodeMirror.off = off\r\n  CodeMirror.on = on\r\n  CodeMirror.wheelEventPixels = wheelEventPixels\r\n  CodeMirror.Doc = Doc\r\n  CodeMirror.splitLines = splitLinesAuto\r\n  CodeMirror.countColumn = countColumn\r\n  CodeMirror.findColumn = findColumn\r\n  CodeMirror.isWordChar = isWordCharBasic\r\n  CodeMirror.Pass = Pass\r\n  CodeMirror.signal = signal\r\n  CodeMirror.Line = Line\r\n  CodeMirror.changeEnd = changeEnd\r\n  CodeMirror.scrollbarModel = scrollbarModel\r\n  CodeMirror.Pos = Pos\r\n  CodeMirror.cmpPos = cmp\r\n  CodeMirror.modes = modes\r\n  CodeMirror.mimeModes = mimeModes\r\n  CodeMirror.resolveMode = resolveMode\r\n  CodeMirror.getMode = getMode\r\n  CodeMirror.modeExtensions = modeExtensions\r\n  CodeMirror.extendMode = extendMode\r\n  CodeMirror.copyState = copyState\r\n  CodeMirror.startState = startState\r\n  CodeMirror.innerMode = innerMode\r\n  CodeMirror.commands = commands\r\n  CodeMirror.keyMap = keyMap\r\n  CodeMirror.keyName = keyName\r\n  CodeMirror.isModifierKey = isModifierKey\r\n  CodeMirror.lookupKey = lookupKey\r\n  CodeMirror.normalizeKeyMap = normalizeKeyMap\r\n  CodeMirror.StringStream = StringStream\r\n  CodeMirror.SharedTextMarker = SharedTextMarker\r\n  CodeMirror.TextMarker = TextMarker\r\n  CodeMirror.LineWidget = LineWidget\r\n  CodeMirror.e_preventDefault = e_preventDefault\r\n  CodeMirror.e_stopPropagation = e_stopPropagation\r\n  CodeMirror.e_stop = e_stop\r\n  CodeMirror.addClass = addClass\r\n  CodeMirror.contains = contains\r\n  CodeMirror.rmClass = rmClass\r\n  CodeMirror.keyNames = keyNames\r\n}\r\n\r\n\r\ndefineOptions(CodeMirror)\r\n\r\naddEditorMethods(CodeMirror)\r\n\r\nvar dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \")\r\nfor (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\r\n  { CodeMirror.prototype[prop] = (function(method) {\r\n    return function() {return method.apply(this.doc, arguments)}\r\n  })(Doc.prototype[prop]) } }\r\n\r\neventMixin(Doc)\r\n\r\n\r\nCodeMirror.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput}\r\n\r\n\r\nCodeMirror.defineMode = function(name) {\r\n  if (!CodeMirror.defaults.mode && name != \"null\") { CodeMirror.defaults.mode = name }\r\n  defineMode.apply(this, arguments)\r\n}\r\n\r\nCodeMirror.defineMIME = defineMIME\r\n\r\nCodeMirror.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); })\r\nCodeMirror.defineMIME(\"text/plain\", \"null\")\r\n\r\n\r\nCodeMirror.defineExtension = function (name, func) {\r\n  CodeMirror.prototype[name] = func\r\n}\r\nCodeMirror.defineDocExtension = function (name, func) {\r\n  Doc.prototype[name] = func\r\n}\r\n\r\nCodeMirror.fromTextArea = fromTextArea\r\n\r\naddLegacyProps(CodeMirror)\r\n\r\nCodeMirror.version = \"5.31.0\"\r\n\r\nreturn CodeMirror;\r\n\r\n})));\n\r\n\r\n(function(mod) {\r\n  if (typeof exports == \"object\" && typeof module == \"object\") \r\n    mod(require(\"../../lib/codemirror\"))\r\n  else if (typeof define == \"function\" && define.amd) \r\n    define([\"../../lib/codemirror\"], mod)\r\n  else \r\n    mod(CodeMirror)\r\n})(function(CodeMirror) {\r\n  \"use strict\"\r\n  var Pos = CodeMirror.Pos\r\n\r\n  function regexpFlags(regexp) {\r\n    var flags = regexp.flags\r\n    return flags != null ? flags : (regexp.ignoreCase ? \"i\" : \"\")\r\n      + (regexp.global ? \"g\" : \"\")\r\n      + (regexp.multiline ? \"m\" : \"\")\r\n  }\r\n\r\n  function ensureGlobal(regexp) {\r\n    return regexp.global ? regexp : new RegExp(regexp.source, regexpFlags(regexp) + \"g\")\r\n  }\r\n\r\n  function maybeMultiline(regexp) {\r\n    return /\\\\s|\\\\n|\\n|\\\\W|\\\\D|\\[\\^/.test(regexp.source)\r\n  }\r\n\r\n  function searchRegexpForward(doc, regexp, start) {\r\n    regexp = ensureGlobal(regexp)\r\n    for (var line = start.line, ch = start.ch, last = doc.lastLine(); line <= last; line++, ch = 0) {\r\n      regexp.lastIndex = ch\r\n      var string = doc.getLine(line), match = regexp.exec(string)\r\n      if (match)\r\n        return {from: Pos(line, match.index),\r\n                to: Pos(line, match.index + match[0].length),\r\n                match: match}\r\n    }\r\n  }\r\n\r\n  function searchRegexpForwardMultiline(doc, regexp, start) {\r\n    if (!maybeMultiline(regexp)) return searchRegexpForward(doc, regexp, start)\r\n\r\n    regexp = ensureGlobal(regexp)\r\n    var string, chunk = 1\r\n    for (var line = start.line, last = doc.lastLine(); line <= last;) {\r\n      for (var i = 0; i < chunk; i++) {\r\n        var curLine = doc.getLine(line++)\r\n        string = string == null ? curLine : string + \"\\n\" + curLine\r\n      }\r\n      chunk = chunk * 2\r\n      regexp.lastIndex = start.ch\r\n      var match = regexp.exec(string)\r\n      if (match) {\r\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\r\n        var startLine = start.line + before.length - 1, startCh = before[before.length - 1].length\r\n        return {from: Pos(startLine, startCh),\r\n                to: Pos(startLine + inside.length - 1,\r\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\r\n                match: match}\r\n      }\r\n    }\r\n  }\r\n\r\n  function lastMatchIn(string, regexp) {\r\n    var cutOff = 0, match\r\n    for (;;) {\r\n      regexp.lastIndex = cutOff\r\n      var newMatch = regexp.exec(string)\r\n      if (!newMatch) return match\r\n      match = newMatch\r\n      cutOff = match.index + (match[0].length || 1)\r\n      if (cutOff == string.length) return match\r\n    }\r\n  }\r\n\r\n  function searchRegexpBackward(doc, regexp, start) {\r\n    regexp = ensureGlobal(regexp)\r\n    for (var line = start.line, ch = start.ch, first = doc.firstLine(); line >= first; line--, ch = -1) {\r\n      var string = doc.getLine(line)\r\n      if (ch > -1) string = string.slice(0, ch)\r\n      var match = lastMatchIn(string, regexp)\r\n      if (match)\r\n        return {from: Pos(line, match.index),\r\n                to: Pos(line, match.index + match[0].length),\r\n                match: match}\r\n    }\r\n  }\r\n\r\n  function searchRegexpBackwardMultiline(doc, regexp, start) {\r\n    regexp = ensureGlobal(regexp)\r\n    var string, chunk = 1\r\n    for (var line = start.line, first = doc.firstLine(); line >= first;) {\r\n      for (var i = 0; i < chunk; i++) {\r\n        var curLine = doc.getLine(line--)\r\n        string = string == null ? curLine.slice(0, start.ch) : curLine + \"\\n\" + string\r\n      }\r\n      chunk *= 2\r\n\r\n      var match = lastMatchIn(string, regexp)\r\n      if (match) {\r\n        var before = string.slice(0, match.index).split(\"\\n\"), inside = match[0].split(\"\\n\")\r\n        var startLine = line + before.length, startCh = before[before.length - 1].length\r\n        return {from: Pos(startLine, startCh),\r\n                to: Pos(startLine + inside.length - 1,\r\n                        inside.length == 1 ? startCh + inside[0].length : inside[inside.length - 1].length),\r\n                match: match}\r\n      }\r\n    }\r\n  }\r\n\r\n  var doFold, noFold\r\n  if (String.prototype.normalize) {\r\n    doFold = function(str) { return str.normalize(\"NFD\").toLowerCase() }\r\n    noFold = function(str) { return str.normalize(\"NFD\") }\r\n  } else {\r\n    doFold = function(str) { return str.toLowerCase() }\r\n    noFold = function(str) { return str }\r\n  }\r\n\r\n  function adjustPos(orig, folded, pos, foldFunc) {\r\n    if (orig.length == folded.length) return pos\r\n    for (var min = 0, max = pos + Math.max(0, orig.length - folded.length);;) {\r\n      if (min == max) return min\r\n      var mid = (min + max) >> 1\r\n      var len = foldFunc(orig.slice(0, mid)).length\r\n      if (len == pos) return mid\r\n      else if (len > pos) max = mid\r\n      else min = mid + 1\r\n    }\r\n  }\r\n\r\n  function searchStringForward(doc, query, start, caseFold) {\r\n    if (!query.length) return null\r\n    var fold = caseFold ? doFold : noFold\r\n    var lines = fold(query).split(/\\r|\\n\\r?/)\r\n\r\n    search: for (var line = start.line, ch = start.ch, last = doc.lastLine() + 1 - lines.length; line <= last; line++, ch = 0) {\r\n      var orig = doc.getLine(line).slice(ch), string = fold(orig)\r\n      if (lines.length == 1) {\r\n        var found = string.indexOf(lines[0])\r\n        if (found == -1) continue search\r\n        var start = adjustPos(orig, string, found, fold) + ch\r\n        return {from: Pos(line, adjustPos(orig, string, found, fold) + ch),\r\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold) + ch)}\r\n      } else {\r\n        var cutFrom = string.length - lines[0].length\r\n        if (string.slice(cutFrom) != lines[0]) continue search\r\n        for (var i = 1; i < lines.length - 1; i++)\r\n          if (fold(doc.getLine(line + i)) != lines[i]) continue search\r\n        var end = doc.getLine(line + lines.length - 1), endString = fold(end), lastLine = lines[lines.length - 1]\r\n        if (end.slice(0, lastLine.length) != lastLine) continue search\r\n        return {from: Pos(line, adjustPos(orig, string, cutFrom, fold) + ch),\r\n                to: Pos(line + lines.length - 1, adjustPos(end, endString, lastLine.length, fold))}\r\n      }\r\n    }\r\n  }\r\n\r\n  function searchStringBackward(doc, query, start, caseFold) {\r\n    if (!query.length) return null\r\n    var fold = caseFold ? doFold : noFold\r\n    var lines = fold(query).split(/\\r|\\n\\r?/)\r\n\r\n    search: for (var line = start.line, ch = start.ch, first = doc.firstLine() - 1 + lines.length; line >= first; line--, ch = -1) {\r\n      var orig = doc.getLine(line)\r\n      if (ch > -1) orig = orig.slice(0, ch)\r\n      var string = fold(orig)\r\n      if (lines.length == 1) {\r\n        var found = string.lastIndexOf(lines[0])\r\n        if (found == -1) continue search\r\n        return {from: Pos(line, adjustPos(orig, string, found, fold)),\r\n                to: Pos(line, adjustPos(orig, string, found + lines[0].length, fold))}\r\n      } else {\r\n        var lastLine = lines[lines.length - 1]\r\n        if (string.slice(0, lastLine.length) != lastLine) continue search\r\n        for (var i = 1, start = line - lines.length + 1; i < lines.length - 1; i++)\r\n          if (fold(doc.getLine(start + i)) != lines[i]) continue search\r\n        var top = doc.getLine(line + 1 - lines.length), topString = fold(top)\r\n        if (topString.slice(topString.length - lines[0].length) != lines[0]) continue search\r\n        return {from: Pos(line + 1 - lines.length, adjustPos(top, topString, top.length - lines[0].length, fold)),\r\n                to: Pos(line, adjustPos(orig, string, lastLine.length, fold))}\r\n      }\r\n    }\r\n  }\r\n\r\n  function SearchCursor(doc, query, pos, options) {\r\n    this.atOccurrence = false\r\n    this.doc = doc\r\n    pos = pos ? doc.clipPos(pos) : Pos(0, 0)\r\n    this.pos = {from: pos, to: pos}\r\n\r\n    var caseFold\r\n    if (typeof options == \"object\") {\r\n      caseFold = options.caseFold\r\n    } else { \r\n      caseFold = options\r\n      options = null\r\n    }\r\n\r\n    if (typeof query == \"string\") {\r\n      if (caseFold == null) caseFold = false\r\n      this.matches = function(reverse, pos) {\r\n        return (reverse ? searchStringBackward : searchStringForward)(doc, query, pos, caseFold)\r\n      }\r\n    } else {\r\n      query = ensureGlobal(query)\r\n      if (!options || options.multiline !== false)\r\n        this.matches = function(reverse, pos) {\r\n          return (reverse ? searchRegexpBackwardMultiline : searchRegexpForwardMultiline)(doc, query, pos)\r\n        }\r\n      else\r\n        this.matches = function(reverse, pos) {\r\n          return (reverse ? searchRegexpBackward : searchRegexpForward)(doc, query, pos)\r\n        }\r\n    }\r\n  }\r\n\r\n  SearchCursor.prototype = {\r\n    findNext: function() {return this.find(false)},\r\n    findPrevious: function() {return this.find(true)},\r\n\r\n    find: function(reverse) {\r\n      var result = this.matches(reverse, this.doc.clipPos(reverse ? this.pos.from : this.pos.to))\r\n\r\n      while (result && CodeMirror.cmpPos(result.from, result.to) == 0) {\r\n        if (reverse) {\r\n          if (result.from.ch) result.from = Pos(result.from.line, result.from.ch - 1)\r\n          else if (result.from.line == this.doc.firstLine()) result = null\r\n          else result = this.matches(reverse, this.doc.clipPos(Pos(result.from.line - 1)))\r\n        } else {\r\n          if (result.to.ch < this.doc.getLine(result.to.line).length) result.to = Pos(result.to.line, result.to.ch + 1)\r\n          else if (result.to.line == this.doc.lastLine()) result = null\r\n          else result = this.matches(reverse, Pos(result.to.line + 1, 0))\r\n        }\r\n      }\r\n\r\n      if (result) {\r\n        this.pos = result\r\n        this.atOccurrence = true\r\n        return this.pos.match || true\r\n      } else {\r\n        var end = Pos(reverse ? this.doc.firstLine() : this.doc.lastLine() + 1, 0)\r\n        this.pos = {from: end, to: end}\r\n        return this.atOccurrence = false\r\n      }\r\n    },\r\n\r\n    from: function() {if (this.atOccurrence) return this.pos.from},\r\n    to: function() {if (this.atOccurrence) return this.pos.to},\r\n\r\n    replace: function(newText, origin) {\r\n      if (!this.atOccurrence) return\r\n      var lines = CodeMirror.splitLines(newText)\r\n      this.doc.replaceRange(lines, this.pos.from, this.pos.to, origin)\r\n      this.pos.to = Pos(this.pos.from.line + lines.length - 1,\r\n                        lines[lines.length - 1].length + (lines.length == 1 ? this.pos.from.ch : 0))\r\n    }\r\n  }\r\n\r\n  CodeMirror.defineExtension(\"getSearchCursor\", function(query, pos, caseFold) {\r\n    return new SearchCursor(this.doc, query, pos, caseFold)\r\n  })\r\n  CodeMirror.defineDocExtension(\"getSearchCursor\", function(query, pos, caseFold) {\r\n    return new SearchCursor(this, query, pos, caseFold)\r\n  })\r\n\r\n  CodeMirror.defineExtension(\"selectMatches\", function(query, caseFold) {\r\n    var ranges = []\r\n    var cur = this.getSearchCursor(query, this.getCursor(\"from\"), caseFold)\r\n    while (cur.findNext()) {\r\n      if (CodeMirror.cmpPos(cur.to(), this.getCursor(\"to\")) > 0) break\r\n      ranges.push({anchor: cur.from(), head: cur.to()})\r\n    }\r\n    if (ranges.length)\r\n      this.setSelections(ranges, 0)\r\n  })\r\n});\r\n\n\r\n\r\n\r\n(function(mod) {\r\n  if (typeof exports == \"object\" && typeof module == \"object\") \r\n    mod(require(\"../../lib/codemirror\"), require(\"./searchcursor\"), require(\"../dialog/dialog\"));\r\n  else if (typeof define == \"function\" && define.amd) \r\n    define([\"../../lib/codemirror\", \"./searchcursor\", \"../dialog/dialog\"], mod);\r\n  else \r\n    mod(CodeMirror);\r\n})(function(CodeMirror) {\r\n  \"use strict\";\r\n\r\n  function searchOverlay(query, caseInsensitive) {\r\n    if (typeof query == \"string\")\r\n      query = new RegExp(query.replace(/[\\-\\[\\]\\/\\{\\}\\(\\)\\*\\+\\?\\.\\\\\\^\\$\\|]/g, \"\\\\$&\"), caseInsensitive ? \"gi\" : \"g\");\r\n    else if (!query.global)\r\n      query = new RegExp(query.source, query.ignoreCase ? \"gi\" : \"g\");\r\n\r\n    return {token: function(stream) {\r\n      query.lastIndex = stream.pos;\r\n      var match = query.exec(stream.string);\r\n      if (match && match.index == stream.pos) {\r\n        stream.pos += match[0].length || 1;\r\n        return \"searching\";\r\n      } else if (match) {\r\n        stream.pos = match.index;\r\n      } else {\r\n        stream.skipToEnd();\r\n      }\r\n    }};\r\n  }\r\n\r\n  function SearchState() {\r\n    this.posFrom = this.posTo = this.lastQuery = this.query = null;\r\n    this.overlay = null;\r\n  }\r\n\r\n  function getSearchState(cm) {\r\n    return cm.state.search || (cm.state.search = new SearchState());\r\n  }\r\n\r\n  function queryCaseInsensitive(query) {\r\n    return typeof query == \"string\" && query == query.toLowerCase();\r\n  }\r\n\r\n  function getSearchCursor(cm, query, pos) {\r\n    return cm.getSearchCursor(query, pos, {caseFold: queryCaseInsensitive(query), multiline: true});\r\n  }\r\n\r\n  function persistentDialog(cm, text, deflt, onEnter, onKeyDown) {\r\n    cm.openDialog(text, onEnter, {\r\n      value: deflt,\r\n      selectValueOnOpen: true,\r\n      closeOnEnter: false,\r\n      onClose: function() { clearSearch(cm); },\r\n      onKeyDown: onKeyDown\r\n    });\r\n  }\r\n\r\n  function dialog(cm, text, shortText, deflt, f) {\r\n    if (cm.openDialog) cm.openDialog(text, f, {value: deflt, selectValueOnOpen: true});\r\n    else f(prompt(shortText, deflt));\r\n  }\r\n\r\n  function confirmDialog(cm, text, shortText, fs) {\r\n    if (cm.openConfirm) cm.openConfirm(text, fs);\r\n    else if (confirm(shortText)) fs[0]();\r\n  }\r\n\r\n  function parseString(string) {\r\n    return string.replace(/\\\\(.)/g, function(_, ch) {\r\n      if (ch == \"n\") return \"\\n\"\r\n      if (ch == \"r\") return \"\\r\"\r\n      return ch\r\n    })\r\n  }\r\n\r\n  function parseQuery(query) {\r\n    var isRE = query.match(/^\\/(.*)\\/([a-z]*)$/);\r\n    if (isRE) {\r\n      try { query = new RegExp(isRE[1], isRE[2].indexOf(\"i\") == -1 ? \"\" : \"i\"); }\r\n      catch(e) {} \r\n    } else {\r\n      query = parseString(query)\r\n    }\r\n    if (typeof query == \"string\" ? query == \"\" : query.test(\"\"))\r\n      query = /x^/;\r\n    return query;\r\n  }\r\n\r\n  var queryDialog =\r\n    '<span class=\"CodeMirror-search-label\">Search:</span> <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/> <span style=\"color: #888\" class=\"CodeMirror-search-hint\">(Use /re/ syntax for regexp search)</span>';\r\n\r\n  function startSearch(cm, state, query) {\r\n    state.queryText = query;\r\n    state.query = parseQuery(query);\r\n    cm.removeOverlay(state.overlay, queryCaseInsensitive(state.query));\r\n    state.overlay = searchOverlay(state.query, queryCaseInsensitive(state.query));\r\n    cm.addOverlay(state.overlay);\r\n    if (cm.showMatchesOnScrollbar) {\r\n      if (state.annotate) { state.annotate.clear(); state.annotate = null; }\r\n      state.annotate = cm.showMatchesOnScrollbar(state.query, queryCaseInsensitive(state.query));\r\n    }\r\n  }\r\n\r\n  function doSearch(cm, rev, persistent, immediate) {\r\n    var state = getSearchState(cm);\r\n    if (state.query) return findNext(cm, rev);\r\n    var q = cm.getSelection() || state.lastQuery;\r\n    if (q instanceof RegExp && q.source == \"x^\") q = null\r\n    if (persistent && cm.openDialog) {\r\n      var hiding = null\r\n      var searchNext = function(query, event) {\r\n        CodeMirror.e_stop(event);\r\n        if (!query) return;\r\n        if (query != state.queryText) {\r\n          startSearch(cm, state, query);\r\n          state.posFrom = state.posTo = cm.getCursor();\r\n        }\r\n        if (hiding) hiding.style.opacity = 1\r\n        findNext(cm, event.shiftKey, function(_, to) {\r\n          var dialog\r\n          if (to.line < 3 && document.querySelector &&\r\n              (dialog = cm.display.wrapper.querySelector(\".CodeMirror-dialog\")) &&\r\n              dialog.getBoundingClientRect().bottom - 4 > cm.cursorCoords(to, \"window\").top)\r\n            (hiding = dialog).style.opacity = .4\r\n        })\r\n      };\r\n      persistentDialog(cm, queryDialog, q, searchNext, function(event, query) {\r\n        var keyName = CodeMirror.keyName(event)\r\n        var extra = cm.getOption('extraKeys'), cmd = (extra && extra[keyName]) || CodeMirror.keyMap[cm.getOption(\"keyMap\")][keyName]\r\n        if (cmd == \"findNext\" || cmd == \"findPrev\" ||\r\n          cmd == \"findPersistentNext\" || cmd == \"findPersistentPrev\") {\r\n          CodeMirror.e_stop(event);\r\n          startSearch(cm, getSearchState(cm), query);\r\n          cm.execCommand(cmd);\r\n        } else if (cmd == \"find\" || cmd == \"findPersistent\") {\r\n          CodeMirror.e_stop(event);\r\n          searchNext(query, event);\r\n        }\r\n      });\r\n      if (immediate && q) {\r\n        startSearch(cm, state, q);\r\n        findNext(cm, rev);\r\n      }\r\n    } else {\r\n      dialog(cm, queryDialog, \"Search for:\", q, function(query) {\r\n        if (query && !state.query) cm.operation(function() {\r\n          startSearch(cm, state, query);\r\n          state.posFrom = state.posTo = cm.getCursor();\r\n          findNext(cm, rev);\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  function findNext(cm, rev, callback) {cm.operation(function() {\r\n    var state = getSearchState(cm);\r\n    var cursor = getSearchCursor(cm, state.query, rev ? state.posFrom : state.posTo);\r\n    if (!cursor.find(rev)) {\r\n      cursor = getSearchCursor(cm, state.query, rev ? CodeMirror.Pos(cm.lastLine()) : CodeMirror.Pos(cm.firstLine(), 0));\r\n      if (!cursor.find(rev)) return;\r\n    }\r\n    cm.setSelection(cursor.from(), cursor.to());\r\n    cm.scrollIntoView({from: cursor.from(), to: cursor.to()}, 20);\r\n    state.posFrom = cursor.from(); state.posTo = cursor.to();\r\n    if (callback) callback(cursor.from(), cursor.to())\r\n  });}\r\n\r\n  function clearSearch(cm) {cm.operation(function() {\r\n    var state = getSearchState(cm);\r\n    state.lastQuery = state.query;\r\n    if (!state.query) return;\r\n    state.query = state.queryText = null;\r\n    cm.removeOverlay(state.overlay);\r\n    if (state.annotate) { state.annotate.clear(); state.annotate = null; }\r\n  });}\r\n\r\n  var replaceQueryDialog =\r\n    ' <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/> <span style=\"color: #888\" class=\"CodeMirror-search-hint\">(Use /re/ syntax for regexp search)</span>';\r\n  var replacementQueryDialog = '<span class=\"CodeMirror-search-label\">With:</span> <input type=\"text\" style=\"width: 10em\" class=\"CodeMirror-search-field\"/>';\r\n  var doReplaceConfirm = '<span class=\"CodeMirror-search-label\">Replace?</span> <button>Yes</button> <button>No</button> <button>All</button> <button>Stop</button>';\r\n\r\n  function replaceAll(cm, query, text) {\r\n    cm.operation(function() {\r\n      for (var cursor = getSearchCursor(cm, query); cursor.findNext();) {\r\n        if (typeof query != \"string\") {\r\n          var match = cm.getRange(cursor.from(), cursor.to()).match(query);\r\n          cursor.replace(text.replace(/\\$(\\d)/g, function(_, i) {return match[i];}));\r\n        } else cursor.replace(text);\r\n      }\r\n    });\r\n  }\r\n\r\n  function replace(cm, all) {\r\n    if (cm.getOption(\"readOnly\")) return;\r\n    var query = cm.getSelection() || getSearchState(cm).lastQuery;\r\n    var dialogText = '<span class=\"CodeMirror-search-label\">' + (all ? 'Replace all:' : 'Replace:') + '</span>';\r\n    dialog(cm, dialogText + replaceQueryDialog, dialogText, query, function(query) {\r\n      if (!query) return;\r\n      query = parseQuery(query);\r\n      dialog(cm, replacementQueryDialog, \"Replace with:\", \"\", function(text) {\r\n        text = parseString(text)\r\n        if (all) {\r\n          replaceAll(cm, query, text)\r\n        } else {\r\n          clearSearch(cm);\r\n          var cursor = getSearchCursor(cm, query, cm.getCursor(\"from\"));\r\n          var advance = function() {\r\n            var start = cursor.from(), match;\r\n            if (!(match = cursor.findNext())) {\r\n              cursor = getSearchCursor(cm, query);\r\n              if (!(match = cursor.findNext()) ||\r\n                  (start && cursor.from().line == start.line && cursor.from().ch == start.ch)) return;\r\n            }\r\n            cm.setSelection(cursor.from(), cursor.to());\r\n            cm.scrollIntoView({from: cursor.from(), to: cursor.to()});\r\n            confirmDialog(cm, doReplaceConfirm, \"Replace?\",\r\n                          [function() {doReplace(match);}, advance,\r\n                           function() {replaceAll(cm, query, text)}]);\r\n          };\r\n          var doReplace = function(match) {\r\n            cursor.replace(typeof query == \"string\" ? text :\r\n                           text.replace(/\\$(\\d)/g, function(_, i) {return match[i];}));\r\n            advance();\r\n          };\r\n          advance();\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  CodeMirror.commands.find = function(cm) {clearSearch(cm); doSearch(cm);};\r\n  CodeMirror.commands.findPersistent = function(cm) {clearSearch(cm); doSearch(cm, false, true);};\r\n  CodeMirror.commands.findPersistentNext = function(cm) {doSearch(cm, false, true, true);};\r\n  CodeMirror.commands.findPersistentPrev = function(cm) {doSearch(cm, true, true, true);};\r\n  CodeMirror.commands.findNext = doSearch;\r\n  CodeMirror.commands.findPrev = function(cm) {doSearch(cm, true);};\r\n  CodeMirror.commands.clearSearch = clearSearch;\r\n  CodeMirror.commands.replace = replace;\r\n  CodeMirror.commands.replaceAll = function(cm) {replace(cm, true);};\r\n});\r\n\n\r\n(function(mod) {\r\n  if (typeof exports == \"object\" && typeof module == \"object\") \r\n    mod(require(\"../../lib/codemirror\"), require(\"./foldcode\"));\r\n  else if (typeof define == \"function\" && define.amd) \r\n    define([\"../../lib/codemirror\", \"./foldcode\"], mod);\r\n  else \r\n    mod(CodeMirror);\r\n})(function(CodeMirror) {\r\n  \"use strict\";\r\n\r\n  CodeMirror.defineOption(\"foldGutter\", false, function(cm, val, old) {\r\n    if (old && old != CodeMirror.Init) {\r\n      cm.clearGutter(cm.state.foldGutter.options.gutter);\r\n      cm.state.foldGutter = null;\r\n      cm.off(\"gutterClick\", onGutterClick);\r\n      cm.off(\"change\", onChange);\r\n      cm.off(\"viewportChange\", onViewportChange);\r\n      cm.off(\"fold\", onFold);\r\n      cm.off(\"unfold\", onFold);\r\n      cm.off(\"swapDoc\", onChange);\r\n    }\r\n    if (val) {\r\n      cm.state.foldGutter = new State(parseOptions(val));\r\n      updateInViewport(cm);\r\n      cm.on(\"gutterClick\", onGutterClick);\r\n      cm.on(\"change\", onChange);\r\n      cm.on(\"viewportChange\", onViewportChange);\r\n      cm.on(\"fold\", onFold);\r\n      cm.on(\"unfold\", onFold);\r\n      cm.on(\"swapDoc\", onChange);\r\n    }\r\n  });\r\n\r\n  var Pos = CodeMirror.Pos;\r\n\r\n  function State(options) {\r\n    this.options = options;\r\n    this.from = this.to = 0;\r\n  }\r\n\r\n  function parseOptions(opts) {\r\n    if (opts === true) opts = {};\r\n    if (opts.gutter == null) opts.gutter = \"CodeMirror-foldgutter\";\r\n    if (opts.indicatorOpen == null) opts.indicatorOpen = \"CodeMirror-foldgutter-open\";\r\n    if (opts.indicatorFolded == null) opts.indicatorFolded = \"CodeMirror-foldgutter-folded\";\r\n    return opts;\r\n  }\r\n\r\n  function isFolded(cm, line) {\r\n    var marks = cm.findMarks(Pos(line, 0), Pos(line + 1, 0));\r\n    for (var i = 0; i < marks.length; ++i)\r\n      if (marks[i].__isFold && marks[i].find().from.line == line) return marks[i];\r\n  }\r\n\r\n  function marker(spec) {\r\n    if (typeof spec == \"string\") {\r\n      var elt = document.createElement(\"div\");\r\n      elt.className = spec + \" CodeMirror-guttermarker-subtle\";\r\n      return elt;\r\n    } else {\r\n      return spec.cloneNode(true);\r\n    }\r\n  }\r\n\r\n  function updateFoldInfo(cm, from, to) {\r\n    var opts = cm.state.foldGutter.options, cur = from;\r\n    var minSize = cm.foldOption(opts, \"minFoldSize\");\r\n    var func = cm.foldOption(opts, \"rangeFinder\");\r\n    cm.eachLine(from, to, function(line) {\r\n      var mark = null;\r\n      if (isFolded(cm, cur)) {\r\n        mark = marker(opts.indicatorFolded);\r\n      } else {\r\n        var pos = Pos(cur, 0);\r\n        var range = func && func(cm, pos);\r\n        if (range && range.to.line - range.from.line >= minSize)\r\n          mark = marker(opts.indicatorOpen);\r\n      }\r\n      cm.setGutterMarker(line, opts.gutter, mark);\r\n      ++cur;\r\n    });\r\n  }\r\n\r\n  function updateInViewport(cm) {\r\n    var vp = cm.getViewport(), state = cm.state.foldGutter;\r\n    if (!state) return;\r\n    cm.operation(function() {\r\n      updateFoldInfo(cm, vp.from, vp.to);\r\n    });\r\n    state.from = vp.from; state.to = vp.to;\r\n  }\r\n\r\n  function onGutterClick(cm, line, gutter) {\r\n    var state = cm.state.foldGutter;\r\n    if (!state) return;\r\n    var opts = state.options;\r\n    if (gutter != opts.gutter) return;\r\n    var folded = isFolded(cm, line);\r\n    if (folded) folded.clear();\r\n    else cm.foldCode(Pos(line, 0), opts.rangeFinder);\r\n  }\r\n\r\n  function onChange(cm) {\r\n    var state = cm.state.foldGutter;\r\n    if (!state) return;\r\n    var opts = state.options;\r\n    state.from = state.to = 0;\r\n    clearTimeout(state.changeUpdate);\r\n    state.changeUpdate = setTimeout(function() { updateInViewport(cm); }, opts.foldOnChangeTimeSpan || 600);\r\n  }\r\n\r\n  function onViewportChange(cm) {\r\n    var state = cm.state.foldGutter;\r\n    if (!state) return;\r\n    var opts = state.options;\r\n    clearTimeout(state.changeUpdate);\r\n    state.changeUpdate = setTimeout(function() {\r\n      var vp = cm.getViewport();\r\n      if (state.from == state.to || vp.from - state.to > 20 || state.from - vp.to > 20) {\r\n        updateInViewport(cm);\r\n      } else {\r\n        cm.operation(function() {\r\n          if (vp.from < state.from) {\r\n            updateFoldInfo(cm, vp.from, state.from);\r\n            state.from = vp.from;\r\n          }\r\n          if (vp.to > state.to) {\r\n            updateFoldInfo(cm, state.to, vp.to);\r\n            state.to = vp.to;\r\n          }\r\n        });\r\n      }\r\n    }, opts.updateViewportTimeSpan || 400);\r\n  }\r\n\r\n  function onFold(cm, from) {\r\n    var state = cm.state.foldGutter;\r\n    if (!state) return;\r\n    var line = from.line;\r\n    if (line >= state.from && line < state.to)\r\n      updateFoldInfo(cm, line, line + 1);\r\n  }\r\n});\r\n\n\r\n(function(mod) {\r\n  if (typeof exports == \"object\" && typeof module == \"object\") \r\n    mod(require(\"../../lib/codemirror\"));\r\n  else if (typeof define == \"function\" && define.amd) \r\n    define([\"../../lib/codemirror\"], mod);\r\n  else \r\n    mod(CodeMirror);\r\n})(function(CodeMirror) {\r\n  \"use strict\";\r\n\r\n  var Pos = CodeMirror.Pos;\r\n  function cmp(a, b) { return a.line - b.line || a.ch - b.ch; }\r\n\r\n  var nameStartChar = \"A-Z_a-z\\\\u00C0-\\\\u00D6\\\\u00D8-\\\\u00F6\\\\u00F8-\\\\u02FF\\\\u0370-\\\\u037D\\\\u037F-\\\\u1FFF\\\\u200C-\\\\u200D\\\\u2070-\\\\u218F\\\\u2C00-\\\\u2FEF\\\\u3001-\\\\uD7FF\\\\uF900-\\\\uFDCF\\\\uFDF0-\\\\uFFFD\";\r\n  var nameChar = nameStartChar + \"\\-\\:\\.0-9\\\\u00B7\\\\u0300-\\\\u036F\\\\u203F-\\\\u2040\";\r\n  var xmlTagStart = new RegExp(\"<(/?)([\" + nameStartChar + \"][\" + nameChar + \"]*)\", \"g\");\r\n\r\n  function Iter(cm, line, ch, range) {\r\n    this.line = line; this.ch = ch;\r\n    this.cm = cm; this.text = cm.getLine(line);\r\n    this.min = range ? Math.max(range.from, cm.firstLine()) : cm.firstLine();\r\n    this.max = range ? Math.min(range.to - 1, cm.lastLine()) : cm.lastLine();\r\n  }\r\n\r\n  function tagAt(iter, ch) {\r\n    var type = iter.cm.getTokenTypeAt(Pos(iter.line, ch));\r\n    return type && /\\btag\\b/.test(type);\r\n  }\r\n\r\n  function nextLine(iter) {\r\n    if (iter.line >= iter.max) return;\r\n    iter.ch = 0;\r\n    iter.text = iter.cm.getLine(++iter.line);\r\n    return true;\r\n  }\r\n  function prevLine(iter) {\r\n    if (iter.line <= iter.min) return;\r\n    iter.text = iter.cm.getLine(--iter.line);\r\n    iter.ch = iter.text.length;\r\n    return true;\r\n  }\r\n\r\n  function toTagEnd(iter) {\r\n    for (;;) {\r\n      var gt = iter.text.indexOf(\">\", iter.ch);\r\n      if (gt == -1) { if (nextLine(iter)) continue; else return; }\r\n      if (!tagAt(iter, gt + 1)) { iter.ch = gt + 1; continue; }\r\n      var lastSlash = iter.text.lastIndexOf(\"/\", gt);\r\n      var selfClose = lastSlash > -1 && !/\\S/.test(iter.text.slice(lastSlash + 1, gt));\r\n      iter.ch = gt + 1;\r\n      return selfClose ? \"selfClose\" : \"regular\";\r\n    }\r\n  }\r\n  function toTagStart(iter) {\r\n    for (;;) {\r\n      var lt = iter.ch ? iter.text.lastIndexOf(\"<\", iter.ch - 1) : -1;\r\n      if (lt == -1) { if (prevLine(iter)) continue; else return; }\r\n      if (!tagAt(iter, lt + 1)) { iter.ch = lt; continue; }\r\n      xmlTagStart.lastIndex = lt;\r\n      iter.ch = lt;\r\n      var match = xmlTagStart.exec(iter.text);\r\n      if (match && match.index == lt) return match;\r\n    }\r\n  }\r\n\r\n  function toNextTag(iter) {\r\n    for (;;) {\r\n      xmlTagStart.lastIndex = iter.ch;\r\n      var found = xmlTagStart.exec(iter.text);\r\n      if (!found) { if (nextLine(iter)) continue; else return; }\r\n      if (!tagAt(iter, found.index + 1)) { iter.ch = found.index + 1; continue; }\r\n      iter.ch = found.index + found[0].length;\r\n      return found;\r\n    }\r\n  }\r\n  function toPrevTag(iter) {\r\n    for (;;) {\r\n      var gt = iter.ch ? iter.text.lastIndexOf(\">\", iter.ch - 1) : -1;\r\n      if (gt == -1) { if (prevLine(iter)) continue; else return; }\r\n      if (!tagAt(iter, gt + 1)) { iter.ch = gt; continue; }\r\n      var lastSlash = iter.text.lastIndexOf(\"/\", gt);\r\n      var selfClose = lastSlash > -1 && !/\\S/.test(iter.text.slice(lastSlash + 1, gt));\r\n      iter.ch = gt + 1;\r\n      return selfClose ? \"selfClose\" : \"regular\";\r\n    }\r\n  }\r\n\r\n  function findMatchingClose(iter, tag) {\r\n    var stack = [];\r\n    for (;;) {\r\n      var next = toNextTag(iter), end, startLine = iter.line, startCh = iter.ch - (next ? next[0].length : 0);\r\n      if (!next || !(end = toTagEnd(iter))) return;\r\n      if (end == \"selfClose\") continue;\r\n      if (next[1]) { \r\n        for (var i = stack.length - 1; i >= 0; --i) if (stack[i] == next[2]) {\r\n          stack.length = i;\r\n          break;\r\n        }\r\n        if (i < 0 && (!tag || tag == next[2])) return {\r\n          tag: next[2],\r\n          from: Pos(startLine, startCh),\r\n          to: Pos(iter.line, iter.ch)\r\n        };\r\n      } else { \r\n        stack.push(next[2]);\r\n      }\r\n    }\r\n  }\r\n  function findMatchingOpen(iter, tag) {\r\n    var stack = [];\r\n    for (;;) {\r\n      var prev = toPrevTag(iter);\r\n      if (!prev) return;\r\n      if (prev == \"selfClose\") { toTagStart(iter); continue; }\r\n      var endLine = iter.line, endCh = iter.ch;\r\n      var start = toTagStart(iter);\r\n      if (!start) return;\r\n      if (start[1]) { \r\n        stack.push(start[2]);\r\n      } else { \r\n        for (var i = stack.length - 1; i >= 0; --i) if (stack[i] == start[2]) {\r\n          stack.length = i;\r\n          break;\r\n        }\r\n        if (i < 0 && (!tag || tag == start[2])) return {\r\n          tag: start[2],\r\n          from: Pos(iter.line, iter.ch),\r\n          to: Pos(endLine, endCh)\r\n        };\r\n      }\r\n    }\r\n  }\r\n\r\n  CodeMirror.registerHelper(\"fold\", \"xml\", function(cm, start) {\r\n    var iter = new Iter(cm, start.line, 0);\r\n    for (;;) {\r\n      var openTag = toNextTag(iter), end;\r\n      if (!openTag || iter.line != start.line || !(end = toTagEnd(iter))) return;\r\n      if (!openTag[1] && end != \"selfClose\") {\r\n        var startPos = Pos(iter.line, iter.ch);\r\n        var endPos = findMatchingClose(iter, openTag[2]);\r\n        return endPos && {from: startPos, to: endPos.from};\r\n      }\r\n    }\r\n  });\r\n  CodeMirror.findMatchingTag = function(cm, pos, range) {\r\n    var iter = new Iter(cm, pos.line, pos.ch, range);\r\n    if (iter.text.indexOf(\">\") == -1 && iter.text.indexOf(\"<\") == -1) return;\r\n    var end = toTagEnd(iter), to = end && Pos(iter.line, iter.ch);\r\n    var start = end && toTagStart(iter);\r\n    if (!end || !start || cmp(iter, pos) > 0) return;\r\n    var here = {from: Pos(iter.line, iter.ch), to: to, tag: start[2]};\r\n    if (end == \"selfClose\") return {open: here, close: null, at: \"open\"};\r\n\r\n    if (start[1]) { \r\n      return {open: findMatchingOpen(iter, start[2]), close: here, at: \"close\"};\r\n    } else { \r\n      iter = new Iter(cm, to.line, to.ch, range);\r\n      return {open: here, close: findMatchingClose(iter, start[2]), at: \"open\"};\r\n    }\r\n  };\r\n\r\n  CodeMirror.findEnclosingTag = function(cm, pos, range, tag) {\r\n    var iter = new Iter(cm, pos.line, pos.ch, range);\r\n    for (;;) {\r\n      var open = findMatchingOpen(iter, tag);\r\n      if (!open) break;\r\n      var forward = new Iter(cm, pos.line, pos.ch, range);\r\n      var close = findMatchingClose(forward, open.tag);\r\n      if (close) return {open: open, close: close};\r\n    }\r\n  };\r\n\r\n  CodeMirror.scanForClosingTag = function(cm, pos, name, end) {\r\n    var iter = new Iter(cm, pos.line, pos.ch, end ? {from: 0, to: end} : null);\r\n    return findMatchingClose(iter, name);\r\n  };\r\n});\r\n\n\r\n(function(mod) {\r\n  if (typeof exports == \"object\" && typeof module == \"object\") \r\n    mod(require(\"../../lib/codemirror\"));\r\n  else if (typeof define == \"function\" && define.amd) \r\n    define([\"../../lib/codemirror\"], mod);\r\n  else \r\n    mod(CodeMirror);\r\n})(function(CodeMirror) {\r\n  \"use strict\";\r\n\r\n  function doFold(cm, pos, options, force) {\r\n    if (options && options.call) {\r\n      var finder = options;\r\n      options = null;\r\n    } else {\r\n      var finder = getOption(cm, options, \"rangeFinder\");\r\n    }\r\n    if (typeof pos == \"number\") pos = CodeMirror.Pos(pos, 0);\r\n    var minSize = getOption(cm, options, \"minFoldSize\");\r\n\r\n    function getRange(allowFolded) {\r\n      var range = finder(cm, pos);\r\n      if (!range || range.to.line - range.from.line < minSize) return null;\r\n      var marks = cm.findMarksAt(range.from);\r\n      for (var i = 0; i < marks.length; ++i) {\r\n        if (marks[i].__isFold && force !== \"fold\") {\r\n          if (!allowFolded) return null;\r\n          range.cleared = true;\r\n          marks[i].clear();\r\n        }\r\n      }\r\n      return range;\r\n    }\r\n\r\n    var range = getRange(true);\r\n    if (getOption(cm, options, \"scanUp\")) while (!range && pos.line > cm.firstLine()) {\r\n      pos = CodeMirror.Pos(pos.line - 1, 0);\r\n      range = getRange(false);\r\n    }\r\n    if (!range || range.cleared || force === \"unfold\") return;\r\n\r\n    var myWidget = makeWidget(cm, options);\r\n    CodeMirror.on(myWidget, \"mousedown\", function(e) {\r\n      myRange.clear();\r\n      CodeMirror.e_preventDefault(e);\r\n    });\r\n    var myRange = cm.markText(range.from, range.to, {\r\n      replacedWith: myWidget,\r\n      clearOnEnter: getOption(cm, options, \"clearOnEnter\"),\r\n      __isFold: true\r\n    });\r\n    myRange.on(\"clear\", function(from, to) {\r\n      CodeMirror.signal(cm, \"unfold\", cm, from, to);\r\n    });\r\n    CodeMirror.signal(cm, \"fold\", cm, range.from, range.to);\r\n  }\r\n\r\n  function makeWidget(cm, options) {\r\n    var widget = getOption(cm, options, \"widget\");\r\n    if (typeof widget == \"string\") {\r\n      var text = document.createTextNode(widget);\r\n      widget = document.createElement(\"span\");\r\n      widget.appendChild(text);\r\n      widget.className = \"CodeMirror-foldmarker\";\r\n    } else if (widget) {\r\n      widget = widget.cloneNode(true)\r\n    }\r\n    return widget;\r\n  }\r\n\r\n  CodeMirror.newFoldFunction = function(rangeFinder, widget) {\r\n    return function(cm, pos) { doFold(cm, pos, {rangeFinder: rangeFinder, widget: widget}); };\r\n  };\r\n\r\n  CodeMirror.defineExtension(\"foldCode\", function(pos, options, force) {\r\n    doFold(this, pos, options, force);\r\n  });\r\n\r\n  CodeMirror.defineExtension(\"isFolded\", function(pos) {\r\n    var marks = this.findMarksAt(pos);\r\n    for (var i = 0; i < marks.length; ++i)\r\n      if (marks[i].__isFold) return true;\r\n  });\r\n\r\n  CodeMirror.commands.toggleFold = function(cm) {\r\n    cm.foldCode(cm.getCursor());\r\n  };\r\n  CodeMirror.commands.fold = function(cm) {\r\n    cm.foldCode(cm.getCursor(), null, \"fold\");\r\n  };\r\n  CodeMirror.commands.unfold = function(cm) {\r\n    cm.foldCode(cm.getCursor(), null, \"unfold\");\r\n  };\r\n  CodeMirror.commands.foldAll = function(cm) {\r\n    cm.operation(function() {\r\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\r\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"fold\");\r\n    });\r\n  };\r\n  CodeMirror.commands.unfoldAll = function(cm) {\r\n    cm.operation(function() {\r\n      for (var i = cm.firstLine(), e = cm.lastLine(); i <= e; i++)\r\n        cm.foldCode(CodeMirror.Pos(i, 0), null, \"unfold\");\r\n    });\r\n  };\r\n\r\n  CodeMirror.registerHelper(\"fold\", \"combine\", function() {\r\n    var funcs = Array.prototype.slice.call(arguments, 0);\r\n    return function(cm, start) {\r\n      for (var i = 0; i < funcs.length; ++i) {\r\n        var found = funcs[i](cm, start);\r\n        if (found) return found;\r\n      }\r\n    };\r\n  });\r\n\r\n  CodeMirror.registerHelper(\"fold\", \"auto\", function(cm, start) {\r\n    var helpers = cm.getHelpers(start, \"fold\");\r\n    for (var i = 0; i < helpers.length; i++) {\r\n      var cur = helpers[i](cm, start);\r\n      if (cur) return cur;\r\n    }\r\n  });\r\n\r\n  var defaultOptions = {\r\n    rangeFinder: CodeMirror.fold.auto,\r\n    widget: \"\\u2194\",\r\n    minFoldSize: 0,\r\n    scanUp: false,\r\n    clearOnEnter: true\r\n  };\r\n\r\n  CodeMirror.defineOption(\"foldOptions\", null);\r\n\r\n  function getOption(cm, options, name) {\r\n    if (options && options[name] !== undefined)\r\n      return options[name];\r\n    var editorOptions = cm.options.foldOptions;\r\n    if (editorOptions && editorOptions[name] !== undefined)\r\n      return editorOptions[name];\r\n    return defaultOptions[name];\r\n  }\r\n\r\n  CodeMirror.defineExtension(\"foldOption\", function(options, name) {\r\n    return getOption(this, options, name);\r\n  });\r\n});\r\n\n\r\n(function(mod) {\r\n  if (typeof exports == \"object\" && typeof module == \"object\") \r\n    mod(require(\"../../lib/codemirror\"), require(\"../fold/xml-fold\"));\r\n  else if (typeof define == \"function\" && define.amd) \r\n    define([\"../../lib/codemirror\", \"../fold/xml-fold\"], mod);\r\n  else \r\n    mod(CodeMirror);\r\n})(function(CodeMirror) {\r\n  \"use strict\";\r\n\r\n  CodeMirror.defineOption(\"matchTags\", false, function(cm, val, old) {\r\n    if (old && old != CodeMirror.Init) {\r\n      cm.off(\"cursorActivity\", doMatchTags);\r\n      cm.off(\"viewportChange\", maybeUpdateMatch);\r\n      clear(cm);\r\n    }\r\n    if (val) {\r\n      cm.state.matchBothTags = typeof val == \"object\" && val.bothTags;\r\n      cm.on(\"cursorActivity\", doMatchTags);\r\n      cm.on(\"viewportChange\", maybeUpdateMatch);\r\n      doMatchTags(cm);\r\n    }\r\n  });\r\n\r\n  function clear(cm) {\r\n    if (cm.state.tagHit) cm.state.tagHit.clear();\r\n    if (cm.state.tagOther) cm.state.tagOther.clear();\r\n    cm.state.tagHit = cm.state.tagOther = null;\r\n  }\r\n\r\n  function doMatchTags(cm) {\r\n    cm.state.failedTagMatch = false;\r\n    cm.operation(function() {\r\n      clear(cm);\r\n      if (cm.somethingSelected()) return;\r\n      var cur = cm.getCursor(), range = cm.getViewport();\r\n      range.from = Math.min(range.from, cur.line); range.to = Math.max(cur.line + 1, range.to);\r\n      var match = CodeMirror.findMatchingTag(cm, cur, range);\r\n      if (!match) return;\r\n      if (cm.state.matchBothTags) {\r\n        var hit = match.at == \"open\" ? match.open : match.close;\r\n        if (hit) cm.state.tagHit = cm.markText(hit.from, hit.to, {className: \"CodeMirror-matchingtag\"});\r\n      }\r\n      var other = match.at == \"close\" ? match.open : match.close;\r\n      if (other)\r\n        cm.state.tagOther = cm.markText(other.from, other.to, {className: \"CodeMirror-matchingtag\"});\r\n      else\r\n        cm.state.failedTagMatch = true;\r\n    });\r\n  }\r\n\r\n  function maybeUpdateMatch(cm) {\r\n    if (cm.state.failedTagMatch) doMatchTags(cm);\r\n  }\r\n\r\n  CodeMirror.commands.toMatchingTag = function(cm) {\r\n    var found = CodeMirror.findMatchingTag(cm, cm.getCursor());\r\n    if (found) {\r\n      var other = found.at == \"close\" ? found.open : found.close;\r\n      if (other) cm.extendSelection(other.to, other.from);\r\n    }\r\n  };\r\n});\r\n\n\r\n(function(mod) {\r\n  if (typeof exports == \"object\" && typeof module == \"object\") \r\n    mod(require(\"../../lib/codemirror\"));\r\n  else if (typeof define == \"function\" && define.amd) \r\n    define([\"../../lib/codemirror\"], mod);\r\n  else \r\n    mod(CodeMirror);\r\n})(function(CodeMirror) {\r\n  \"use strict\";\r\n\r\n  var Pos = CodeMirror.Pos;\r\n\r\n  function getHints(cm, options) {\r\n    var tags = options && options.schemaInfo;\r\n    var quote = (options && options.quoteChar) || '\"';\r\n    if (!tags) return;\r\n    var cur = cm.getCursor(), token = cm.getTokenAt(cur);\r\n    if (token.end > cur.ch) {\r\n      token.end = cur.ch;\r\n      token.string = token.string.slice(0, cur.ch - token.start);\r\n    }\r\n    var inner = CodeMirror.innerMode(cm.getMode(), token.state);\r\n    if (inner.mode.name != \"xml\") return;\r\n    var result = [], replaceToken = false, prefix;\r\n    var tag = /\\btag\\b/.test(token.type) && !/>$/.test(token.string);\r\n    var tagName = tag && /^\\w/.test(token.string), tagStart;\r\n\r\n    if (tagName) {\r\n      var before = cm.getLine(cur.line).slice(Math.max(0, token.start - 2), token.start);\r\n      var tagType = /<\\/$/.test(before) ? \"close\" : /<$/.test(before) ? \"open\" : null;\r\n      if (tagType) tagStart = token.start - (tagType == \"close\" ? 2 : 1);\r\n    } else if (tag && token.string == \"<\") {\r\n      tagType = \"open\";\r\n    } else if (tag && token.string == \"</\") {\r\n      tagType = \"close\";\r\n    }\r\n\r\n    if (!tag && !inner.state.tagName || tagType) {\r\n      if (tagName)\r\n        prefix = token.string;\r\n      replaceToken = tagType;\r\n      var cx = inner.state.context, curTag = cx && tags[cx.tagName];\r\n      var childList = cx ? curTag && curTag.children : tags[\"!top\"];\r\n      if (childList && tagType != \"close\") {\r\n        for (var i = 0; i < childList.length; ++i) if (!prefix || childList[i].lastIndexOf(prefix, 0) == 0)\r\n          result.push(\"<\" + childList[i]);\r\n      } else if (tagType != \"close\") {\r\n        for (var name in tags)\r\n          if (tags.hasOwnProperty(name) && name != \"!top\" && name != \"!attrs\" && (!prefix || name.lastIndexOf(prefix, 0) == 0))\r\n            result.push(\"<\" + name);\r\n      }\r\n      if (cx && (!prefix || tagType == \"close\" && cx.tagName.lastIndexOf(prefix, 0) == 0))\r\n        result.push(\"</\" + cx.tagName + \">\");\r\n    } else {\r\n      var curTag = tags[inner.state.tagName], attrs = curTag && curTag.attrs;\r\n      var globalAttrs = tags[\"!attrs\"];\r\n      if (!attrs && !globalAttrs) return;\r\n      if (!attrs) {\r\n        attrs = globalAttrs;\r\n      } else if (globalAttrs) { \r\n        var set = {};\r\n        for (var nm in globalAttrs) if (globalAttrs.hasOwnProperty(nm)) set[nm] = globalAttrs[nm];\r\n        for (var nm in attrs) if (attrs.hasOwnProperty(nm)) set[nm] = attrs[nm];\r\n        attrs = set;\r\n      }\r\n      if (token.type == \"string\" || token.string == \"=\") { \r\n        var before = cm.getRange(Pos(cur.line, Math.max(0, cur.ch - 60)),\r\n                                 Pos(cur.line, token.type == \"string\" ? token.start : token.end));\r\n        var atName = before.match(/([^\\s\\u00a0=<>\\\"\\']+)=$/), atValues;\r\n        if (!atName || !attrs.hasOwnProperty(atName[1]) || !(atValues = attrs[atName[1]])) return;\r\n        if (typeof atValues == 'function') atValues = atValues.call(this, cm); \r\n        if (token.type == \"string\") {\r\n          prefix = token.string;\r\n          var n = 0;\r\n          if (/['\"]/.test(token.string.charAt(0))) {\r\n            quote = token.string.charAt(0);\r\n            prefix = token.string.slice(1);\r\n            n++;\r\n          }\r\n          var len = token.string.length;\r\n          if (/['\"]/.test(token.string.charAt(len - 1))) {\r\n            quote = token.string.charAt(len - 1);\r\n            prefix = token.string.substr(n, len - 2);\r\n          }\r\n          replaceToken = true;\r\n        }\r\n        for (var i = 0; i < atValues.length; ++i) if (!prefix || atValues[i].lastIndexOf(prefix, 0) == 0)\r\n          result.push(quote + atValues[i] + quote);\r\n      } else { \r\n        if (token.type == \"attribute\") {\r\n          prefix = token.string;\r\n          replaceToken = true;\r\n        }\r\n        for (var attr in attrs) if (attrs.hasOwnProperty(attr) && (!prefix || attr.lastIndexOf(prefix, 0) == 0))\r\n          result.push(attr);\r\n      }\r\n    }\r\n    return {\r\n      list: result,\r\n      from: replaceToken ? Pos(cur.line, tagStart == null ? token.start : tagStart) : cur,\r\n      to: replaceToken ? Pos(cur.line, token.end) : cur\r\n    };\r\n  }\r\n  CodeMirror.registerHelper(\"hint\", \"xml\", getHints);\r\n});\r\n\n\r\n(function(mod) {\r\n  if (typeof exports == \"object\" && typeof module == \"object\") \r\n    mod(require(\"../../lib/codemirror\"));\r\n  else if (typeof define == \"function\" && define.amd) \r\n    define([\"../../lib/codemirror\"], mod);\r\n  else \r\n    mod(CodeMirror);\r\n})(function(CodeMirror) {\r\n  \"use strict\";\r\n\r\n  var HINT_ELEMENT_CLASS        = \"CodeMirror-hint\";\r\n  var ACTIVE_HINT_ELEMENT_CLASS = \"CodeMirror-hint-active\";\r\n\r\n  CodeMirror.showHint = function(cm, getHints, options) {\r\n    if (!getHints) return cm.showHint(options);\r\n    if (options && options.async) getHints.async = true;\r\n    var newOpts = {hint: getHints};\r\n    if (options) for (var prop in options) newOpts[prop] = options[prop];\r\n    return cm.showHint(newOpts);\r\n  };\r\n\r\n  CodeMirror.defineExtension(\"showHint\", function(options) {\r\n    options = parseOptions(this, this.getCursor(\"start\"), options);\r\n    var selections = this.listSelections()\r\n    if (selections.length > 1) return;\r\n    if (this.somethingSelected()) {\r\n      if (!options.hint.supportsSelection) return;\r\n      for (var i = 0; i < selections.length; i++)\r\n        if (selections[i].head.line != selections[i].anchor.line) return;\r\n    }\r\n\r\n    if (this.state.completionActive) this.state.completionActive.close();\r\n    var completion = this.state.completionActive = new Completion(this, options);\r\n    if (!completion.options.hint) return;\r\n\r\n    CodeMirror.signal(this, \"startCompletion\", this);\r\n    completion.update(true);\r\n  });\r\n\r\n  function Completion(cm, options) {\r\n    this.cm = cm;\r\n    this.options = options;\r\n    this.widget = null;\r\n    this.debounce = 0;\r\n    this.tick = 0;\r\n    this.startPos = this.cm.getCursor(\"start\");\r\n    this.startLen = this.cm.getLine(this.startPos.line).length - this.cm.getSelection().length;\r\n    var self = this;\r\n    cm.on(\"cursorActivity\", this.activityFunc = function() { self.cursorActivity(); });\r\n  }\r\n\r\n  var requestAnimationFrame = window.requestAnimationFrame || function(fn) {\r\n    return setTimeout(fn, 1000/60);\r\n  };\r\n  var cancelAnimationFrame = window.cancelAnimationFrame || clearTimeout;\r\n\r\n  Completion.prototype = {\r\n    close: function() {\r\n      if (!this.active()) return;\r\n      this.cm.state.completionActive = null;\r\n      this.tick = null;\r\n      this.cm.off(\"cursorActivity\", this.activityFunc);\r\n\r\n      if (this.widget && this.data) CodeMirror.signal(this.data, \"close\");\r\n      if (this.widget) this.widget.close();\r\n      CodeMirror.signal(this.cm, \"endCompletion\", this.cm);\r\n    },\r\n\r\n    active: function() {\r\n      return this.cm.state.completionActive == this;\r\n    },\r\n\r\n    pick: function(data, i) {\r\n      var completion = data.list[i];\r\n      if (completion.hint) completion.hint(this.cm, data, completion);\r\n      else this.cm.replaceRange(getText(completion), completion.from || data.from,\r\n                                completion.to || data.to, \"complete\");\r\n      CodeMirror.signal(data, \"pick\", completion);\r\n      this.close();\r\n    },\r\n\r\n    cursorActivity: function() {\r\n      if (this.debounce) {\r\n        cancelAnimationFrame(this.debounce);\r\n        this.debounce = 0;\r\n      }\r\n\r\n      var pos = this.cm.getCursor(), line = this.cm.getLine(pos.line);\r\n      if (pos.line != this.startPos.line || line.length - pos.ch != this.startLen - this.startPos.ch ||\r\n          pos.ch < this.startPos.ch || this.cm.somethingSelected() ||\r\n          (pos.ch && this.options.closeCharacters.test(line.charAt(pos.ch - 1)))) {\r\n        this.close();\r\n      } else {\r\n        var self = this;\r\n        this.debounce = requestAnimationFrame(function() {self.update();});\r\n        if (this.widget) this.widget.disable();\r\n      }\r\n    },\r\n\r\n    update: function(first) {\r\n      if (this.tick == null) return\r\n      var self = this, myTick = ++this.tick\r\n      fetchHints(this.options.hint, this.cm, this.options, function(data) {\r\n        if (self.tick == myTick) self.finishUpdate(data, first)\r\n      })\r\n    },\r\n\r\n    finishUpdate: function(data, first) {\r\n      if (this.data) CodeMirror.signal(this.data, \"update\");\r\n\r\n      var picked = (this.widget && this.widget.picked) || (first && this.options.completeSingle);\r\n      if (this.widget) this.widget.close();\r\n\r\n      if (data && this.data && isNewCompletion(this.data, data)) return;\r\n      this.data = data;\r\n\r\n      if (data && data.list.length) {\r\n        if (picked && data.list.length == 1) {\r\n          this.pick(data, 0);\r\n        } else {\r\n          this.widget = new Widget(this, data);\r\n          CodeMirror.signal(data, \"shown\");\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  function isNewCompletion(old, nw) {\r\n    var moved = CodeMirror.cmpPos(nw.from, old.from)\r\n    return moved > 0 && old.to.ch - old.from.ch != nw.to.ch - nw.from.ch\r\n  }\r\n\r\n  function parseOptions(cm, pos, options) {\r\n    var editor = cm.options.hintOptions;\r\n    var out = {};\r\n    for (var prop in defaultOptions) out[prop] = defaultOptions[prop];\r\n    if (editor) for (var prop in editor)\r\n      if (editor[prop] !== undefined) out[prop] = editor[prop];\r\n    if (options) for (var prop in options)\r\n      if (options[prop] !== undefined) out[prop] = options[prop];\r\n    if (out.hint.resolve) out.hint = out.hint.resolve(cm, pos)\r\n    return out;\r\n  }\r\n\r\n  function getText(completion) {\r\n\r\n        if (typeof completion == \"string\") {console.log(\"trigger ??\" ,completion);return completion;}\r\n    else return completion.text;\r\n  }\r\n\r\n  function buildKeyMap(completion, handle) {\r\n    var baseMap = {\r\n      Up: function() {handle.moveFocus(-1);},\r\n      Down: function() {handle.moveFocus(1);},\r\n      PageUp: function() {handle.moveFocus(-handle.menuSize() + 1, true);},\r\n      PageDown: function() {handle.moveFocus(handle.menuSize() - 1, true);},\r\n      Home: function() {handle.setFocus(0);},\r\n      End: function() {handle.setFocus(handle.length - 1);},\r\n      Enter: handle.pick,\r\n      Tab: handle.pick,\r\n      Esc: handle.close\r\n    };\r\n    var custom = completion.options.customKeys;\r\n    var ourMap = custom ? {} : baseMap;\r\n    function addBinding(key, val) {\r\n      var bound;\r\n      if (typeof val != \"string\")\r\n        bound = function(cm) { return val(cm, handle); };\r\n      else if (baseMap.hasOwnProperty(val))\r\n        bound = baseMap[val];\r\n      else\r\n        bound = val;\r\n      ourMap[key] = bound;\r\n    }\r\n    if (custom)\r\n      for (var key in custom) if (custom.hasOwnProperty(key))\r\n        addBinding(key, custom[key]);\r\n    var extra = completion.options.extraKeys;\r\n    if (extra)\r\n      for (var key in extra) if (extra.hasOwnProperty(key))\r\n        addBinding(key, extra[key]);\r\n    return ourMap;\r\n  }\r\n\r\n  function getHintElement(hintsElement, el) {\r\n    while (el && el != hintsElement) {\r\n      if (el.nodeName.toUpperCase() === \"LI\" && el.parentNode == hintsElement) return el;\r\n      el = el.parentNode;\r\n    }\r\n  }\r\n\r\n  function Widget(completion, data) {\r\n    this.completion = completion;\r\n    this.data = data;\r\n    this.picked = false;\r\n    var widget = this, cm = completion.cm;\r\n\r\n    var hints = this.hints = document.createElement(\"ul\");\r\n    hints.className = \"CodeMirror-hints\";\r\n    this.selectedHint = data.selectedHint || 0;\r\n\r\n    var completions = data.list;\r\n    for (var i = 0; i < completions.length; ++i) {\r\n      var elt = hints.appendChild(document.createElement(\"li\")), cur = completions[i];\r\n      var className = HINT_ELEMENT_CLASS + (i != this.selectedHint ? \"\" : \" \" + ACTIVE_HINT_ELEMENT_CLASS);\r\n      if (cur.className != null) className = cur.className + \" \" + className;\r\n      elt.className = className;\r\n      if (cur.render) cur.render(elt, data, cur);\r\n      else elt.appendChild(document.createTextNode(cur.displayText || getText(cur)));\r\n      elt.hintId = i;\r\n    }\r\n\r\n    var pos = cm.cursorCoords(completion.options.alignWithWord ? data.from : null);\r\n    var left = pos.left, top = pos.bottom, below = true;\r\n    hints.style.left = left + \"px\";\r\n    hints.style.top = top + \"px\";\r\n    var winW = window.innerWidth || Math.max(document.body.offsetWidth, document.documentElement.offsetWidth);\r\n    var winH = window.innerHeight || Math.max(document.body.offsetHeight, document.documentElement.offsetHeight);\r\n    (completion.options.container || document.body).appendChild(hints);\r\n    var box = hints.getBoundingClientRect(), overlapY = box.bottom - winH;\r\n    var scrolls = hints.scrollHeight > hints.clientHeight + 1\r\n    var startScroll = cm.getScrollInfo();\r\n\r\n    if (overlapY > 0) {\r\n      var height = box.bottom - box.top, curTop = pos.top - (pos.bottom - box.top);\r\n      if (curTop - height > 0) { \r\n        hints.style.top = (top = pos.top - height) + \"px\";\r\n        below = false;\r\n      } else if (height > winH) {\r\n        hints.style.height = (winH - 5) + \"px\";\r\n        hints.style.top = (top = pos.bottom - box.top) + \"px\";\r\n        var cursor = cm.getCursor();\r\n        if (data.from.ch != cursor.ch) {\r\n          pos = cm.cursorCoords(cursor);\r\n          hints.style.left = (left = pos.left) + \"px\";\r\n          box = hints.getBoundingClientRect();\r\n        }\r\n      }\r\n    }\r\n    var overlapX = box.right - winW;\r\n    if (overlapX > 0) {\r\n      if (box.right - box.left > winW) {\r\n        hints.style.width = (winW - 5) + \"px\";\r\n        overlapX -= (box.right - box.left) - winW;\r\n      }\r\n      hints.style.left = (left = pos.left - overlapX) + \"px\";\r\n    }\r\n    if (scrolls) for (var node = hints.firstChild; node; node = node.nextSibling)\r\n      node.style.paddingRight = cm.display.nativeBarWidth + \"px\"\r\n\r\n    cm.addKeyMap(this.keyMap = buildKeyMap(completion, {\r\n      moveFocus: function(n, avoidWrap) { widget.changeActive(widget.selectedHint + n, avoidWrap); },\r\n      setFocus: function(n) { widget.changeActive(n); },\r\n      menuSize: function() { return widget.screenAmount(); },\r\n      length: completions.length,\r\n      close: function() { completion.close(); },\r\n      pick: function() { widget.pick(); },\r\n      data: data\r\n    }));\r\n\r\n    if (completion.options.closeOnUnfocus) {\r\n      var closingOnBlur;\r\n      cm.on(\"blur\", this.onBlur = function() { closingOnBlur = setTimeout(function() { completion.close(); }, 100); });\r\n      cm.on(\"focus\", this.onFocus = function() { clearTimeout(closingOnBlur); });\r\n    }\r\n\r\n    cm.on(\"scroll\", this.onScroll = function() {\r\n      var curScroll = cm.getScrollInfo(), editor = cm.getWrapperElement().getBoundingClientRect();\r\n      var newTop = top + startScroll.top - curScroll.top;\r\n      var point = newTop - (window.pageYOffset || (document.documentElement || document.body).scrollTop);\r\n      if (!below) point += hints.offsetHeight;\r\n      if (point <= editor.top || point >= editor.bottom) return completion.close();\r\n      hints.style.top = newTop + \"px\";\r\n      hints.style.left = (left + startScroll.left - curScroll.left) + \"px\";\r\n    });\r\n\r\n    CodeMirror.on(hints, \"dblclick\", function(e) {\r\n      var t = getHintElement(hints, e.target || e.srcElement);\r\n      if (t && t.hintId != null) {widget.changeActive(t.hintId); widget.pick();}\r\n    });\r\n\r\n    CodeMirror.on(hints, \"click\", function(e) {\r\n      var t = getHintElement(hints, e.target || e.srcElement);\r\n      if (t && t.hintId != null) {\r\n        widget.changeActive(t.hintId);\r\n        if (completion.options.completeOnSingleClick) widget.pick();\r\n      }\r\n    });\r\n\r\n    CodeMirror.on(hints, \"mousedown\", function() {\r\n      setTimeout(function(){cm.focus();}, 20);\r\n    });\r\n\r\n    CodeMirror.signal(data, \"select\", completions[this.selectedHint], hints.childNodes[this.selectedHint]);\r\n    return true;\r\n  }\r\n\r\n  Widget.prototype = {\r\n    close: function() {\r\n      if (this.completion.widget != this) return;\r\n      this.completion.widget = null;\r\n      this.hints.parentNode.removeChild(this.hints);\r\n      this.completion.cm.removeKeyMap(this.keyMap);\r\n\r\n      var cm = this.completion.cm;\r\n      if (this.completion.options.closeOnUnfocus) {\r\n        cm.off(\"blur\", this.onBlur);\r\n        cm.off(\"focus\", this.onFocus);\r\n      }\r\n      cm.off(\"scroll\", this.onScroll);\r\n    },\r\n\r\n    disable: function() {\r\n      this.completion.cm.removeKeyMap(this.keyMap);\r\n      var widget = this;\r\n      this.keyMap = {Enter: function() { widget.picked = true; }};\r\n      this.completion.cm.addKeyMap(this.keyMap);\r\n    },\r\n\r\n    pick: function() {\r\n      this.completion.pick(this.data, this.selectedHint);\r\n    },\r\n\r\n    changeActive: function(i, avoidWrap) {\r\n      if (i >= this.data.list.length)\r\n        i = avoidWrap ? this.data.list.length - 1 : 0;\r\n      else if (i < 0)\r\n        i = avoidWrap ? 0  : this.data.list.length - 1;\r\n      if (this.selectedHint == i) return;\r\n      var node = this.hints.childNodes[this.selectedHint];\r\n      node.className = node.className.replace(\" \" + ACTIVE_HINT_ELEMENT_CLASS, \"\");\r\n      node = this.hints.childNodes[this.selectedHint = i];\r\n      node.className += \" \" + ACTIVE_HINT_ELEMENT_CLASS;\r\n      if (node.offsetTop < this.hints.scrollTop)\r\n        this.hints.scrollTop = node.offsetTop - 3;\r\n      else if (node.offsetTop + node.offsetHeight > this.hints.scrollTop + this.hints.clientHeight)\r\n        this.hints.scrollTop = node.offsetTop + node.offsetHeight - this.hints.clientHeight + 3;\r\n      CodeMirror.signal(this.data, \"select\", this.data.list[this.selectedHint], node);\r\n    },\r\n\r\n    screenAmount: function() {\r\n      return Math.floor(this.hints.clientHeight / this.hints.firstChild.offsetHeight) || 1;\r\n    }\r\n  };\r\n\r\n  function applicableHelpers(cm, helpers) {\r\n    if (!cm.somethingSelected()) return helpers\r\n    var result = []\r\n    for (var i = 0; i < helpers.length; i++)\r\n      if (helpers[i].supportsSelection) result.push(helpers[i])\r\n    return result\r\n  }\r\n\r\n  function fetchHints(hint, cm, options, callback) {\r\n    if (hint.async) {\r\n      hint(cm, callback, options)\r\n    } else {\r\n      var result = hint(cm, options)\r\n      if (result && result.then) result.then(callback)\r\n      else callback(result)\r\n    }\r\n  }\r\n\r\n  function resolveAutoHints(cm, pos) {\r\n    var helpers = cm.getHelpers(pos, \"hint\"), words\r\n    if (helpers.length) {\r\n      var resolved = function(cm, callback, options) {\r\n        var app = applicableHelpers(cm, helpers);\r\n        function run(i) {\r\n          if (i == app.length) return callback(null)\r\n          fetchHints(app[i], cm, options, function(result) {\r\n            if (result && result.list.length > 0) callback(result)\r\n            else run(i + 1)\r\n          })\r\n        }\r\n        run(0)\r\n      }\r\n      resolved.async = true\r\n      resolved.supportsSelection = true\r\n      return resolved\r\n    } else if (words = cm.getHelper(cm.getCursor(), \"hintWords\")) {\r\n      return function(cm) { return CodeMirror.hint.fromList(cm, {words: words}) }\r\n    } else if (CodeMirror.hint.anyword) {\r\n      return function(cm, options) { return CodeMirror.hint.anyword(cm, options) }\r\n    } else {\r\n      return function() {}\r\n    }\r\n  }\r\n\r\n  CodeMirror.registerHelper(\"hint\", \"auto\", {\r\n    resolve: resolveAutoHints\r\n  });\r\n\r\n  CodeMirror.registerHelper(\"hint\", \"fromList\", function(cm, options) {\r\n    var cur = cm.getCursor(), token = cm.getTokenAt(cur);\r\n    var to = CodeMirror.Pos(cur.line, token.end);\r\n    if (token.string && /\\w/.test(token.string[token.string.length - 1])) {\r\n      var term = token.string, from = CodeMirror.Pos(cur.line, token.start);\r\n    } else {\r\n      var term = \"\", from = to;\r\n    }\r\n    var found = [];\r\n    for (var i = 0; i < options.words.length; i++) {\r\n      var word = options.words[i];\r\n      if (word.slice(0, term.length) == term)\r\n        found.push(word);\r\n    }\r\n\r\n    if (found.length) return {list: found, from: from, to: to};\r\n  });\r\n\r\n  CodeMirror.commands.autocomplete = CodeMirror.showHint;\r\n\r\n  var defaultOptions = {\r\n    hint: CodeMirror.hint.auto,\r\n    completeSingle: true,\r\n    alignWithWord: true,\r\n    closeCharacters: /[\\s()\\[\\]{};:>,]/,\r\n    closeOnUnfocus: true,\r\n    completeOnSingleClick: true,\r\n    container: null,\r\n    customKeys: null,\r\n    extraKeys: null\r\n  };\r\n\r\n  CodeMirror.defineOption(\"hintOptions\", null);\r\n});\r\n\n\r\n(function(mod) {\r\n  if (typeof exports == \"object\" && typeof module == \"object\") \r\n    mod(require(\"../../lib/codemirror\"));\r\n  else if (typeof define == \"function\" && define.amd) \r\n    define([\"../../lib/codemirror\"], mod);\r\n  else \r\n    mod(CodeMirror);\r\n})(function(CodeMirror) {\r\n\"use strict\";\r\n\r\nvar htmlConfig = {\r\n  autoSelfClosers: {'area': true, 'base': true, 'br': true, 'col': true, 'command': true,\r\n                    'embed': true, 'frame': true, 'hr': true, 'img': true, 'input': true,\r\n                    'keygen': true, 'link': true, 'meta': true, 'param': true, 'source': true,\r\n                    'track': true, 'wbr': true, 'menuitem': true},\r\n  implicitlyClosed: {'dd': true, 'li': true, 'optgroup': true, 'option': true, 'p': true,\r\n                     'rp': true, 'rt': true, 'tbody': true, 'td': true, 'tfoot': true,\r\n                     'th': true, 'tr': true},\r\n  contextGrabbers: {\r\n    'dd': {'dd': true, 'dt': true},\r\n    'dt': {'dd': true, 'dt': true},\r\n    'li': {'li': true},\r\n    'option': {'option': true, 'optgroup': true},\r\n    'optgroup': {'optgroup': true},\r\n    'p': {'address': true, 'article': true, 'aside': true, 'blockquote': true, 'dir': true,\r\n          'div': true, 'dl': true, 'fieldset': true, 'footer': true, 'form': true,\r\n          'h1': true, 'h2': true, 'h3': true, 'h4': true, 'h5': true, 'h6': true,\r\n          'header': true, 'hgroup': true, 'hr': true, 'menu': true, 'nav': true, 'ol': true,\r\n          'p': true, 'pre': true, 'section': true, 'table': true, 'ul': true},\r\n    'rp': {'rp': true, 'rt': true},\r\n    'rt': {'rp': true, 'rt': true},\r\n    'tbody': {'tbody': true, 'tfoot': true},\r\n    'td': {'td': true, 'th': true},\r\n    'tfoot': {'tbody': true},\r\n    'th': {'td': true, 'th': true},\r\n    'thead': {'tbody': true, 'tfoot': true},\r\n    'tr': {'tr': true}\r\n  },\r\n  doNotIndent: {\"pre\": true},\r\n  allowUnquoted: true,\r\n  allowMissing: true,\r\n  caseFold: true\r\n}\r\n\r\nvar xmlConfig = {\r\n  autoSelfClosers: {},\r\n  implicitlyClosed: {},\r\n  contextGrabbers: {},\r\n  doNotIndent: {},\r\n  allowUnquoted: false,\r\n  allowMissing: false,\r\n  caseFold: false\r\n}\r\n\r\nCodeMirror.defineMode(\"xml\", function(editorConf, config_) {\r\n  var indentUnit = editorConf.indentUnit\r\n  var config = {}\r\n  var defaults = config_.htmlMode ? htmlConfig : xmlConfig\r\n  for (var prop in defaults) config[prop] = defaults[prop]\r\n  for (var prop in config_) config[prop] = config_[prop]\r\n\r\n  var type, setStyle;\r\n\r\n  function inText(stream, state) {\r\n    function chain(parser) {\r\n      state.tokenize = parser;\r\n      return parser(stream, state);\r\n    }\r\n\r\n    var ch = stream.next();\r\n    if (ch == \"<\") {\r\n      if (stream.eat(\"!\")) {\r\n        if (stream.eat(\"[\")) {\r\n          if (stream.match(\"CDATA[\")) return chain(inBlock(\"atom\", \"]]>\"));\r\n          else return null;\r\n        } else if (stream.match(\"--\")) {\r\n          return chain(inBlock(\"comment\", \"-->\"));\r\n        } else if (stream.match(\"DOCTYPE\", true, true)) {\r\n          stream.eatWhile(/[\\w\\._\\-]/);\r\n          return chain(doctype(1));\r\n        } else {\r\n          return null;\r\n        }\r\n      } else if (stream.eat(\"?\")) {\r\n        stream.eatWhile(/[\\w\\._\\-]/);\r\n        state.tokenize = inBlock(\"meta\", \"?>\");\r\n        return \"meta\";\r\n      } else {\r\n        type = stream.eat(\"/\") ? \"closeTag\" : \"openTag\";\r\n        state.tokenize = inTag;\r\n        return \"tag bracket\";\r\n      }\r\n    } else if (ch == \"&\") {\r\n      var ok;\r\n      if (stream.eat(\"#\")) {\r\n        if (stream.eat(\"x\")) {\r\n          ok = stream.eatWhile(/[a-fA-F\\d]/) && stream.eat(\";\");\r\n        } else {\r\n          ok = stream.eatWhile(/[\\d]/) && stream.eat(\";\");\r\n        }\r\n      } else {\r\n        ok = stream.eatWhile(/[\\w\\.\\-:]/) && stream.eat(\";\");\r\n      }\r\n      return ok ? \"atom\" : \"error\";\r\n    } else {\r\n      stream.eatWhile(/[^&<]/);\r\n      return null;\r\n    }\r\n  }\r\n  inText.isInText = true;\r\n\r\n  function inTag(stream, state) {\r\n    var ch = stream.next();\r\n    if (ch == \">\" || (ch == \"/\" && stream.eat(\">\"))) {\r\n      state.tokenize = inText;\r\n      type = ch == \">\" ? \"endTag\" : \"selfcloseTag\";\r\n      return \"tag bracket\";\r\n    } else if (ch == \"=\") {\r\n      type = \"equals\";\r\n      return null;\r\n    } else if (ch == \"<\") {\r\n      state.tokenize = inText;\r\n      state.state = baseState;\r\n      state.tagName = state.tagStart = null;\r\n      var next = state.tokenize(stream, state);\r\n      return next ? next + \" tag error\" : \"tag error\";\r\n    } else if (/[\\'\\\"]/.test(ch)) {\r\n      state.tokenize = inAttribute(ch);\r\n      state.stringStartCol = stream.column();\r\n      return state.tokenize(stream, state);\r\n    } else {\r\n      stream.match(/^[^\\s\\u00a0=<>\\\"\\']*[^\\s\\u00a0=<>\\\"\\'\\/]/);\r\n      return \"word\";\r\n    }\r\n  }\r\n\r\n  function inAttribute(quote) {\r\n    var closure = function(stream, state) {\r\n      while (!stream.eol()) {\r\n        if (stream.next() == quote) {\r\n          state.tokenize = inTag;\r\n          break;\r\n        }\r\n      }\r\n      return \"string\";\r\n    };\r\n    closure.isInAttribute = true;\r\n    return closure;\r\n  }\r\n\r\n  function inBlock(style, terminator) {\r\n    return function(stream, state) {\r\n      while (!stream.eol()) {\r\n        if (stream.match(terminator)) {\r\n          state.tokenize = inText;\r\n          break;\r\n        }\r\n        stream.next();\r\n      }\r\n      return style;\r\n    };\r\n  }\r\n  function doctype(depth) {\r\n    return function(stream, state) {\r\n      var ch;\r\n      while ((ch = stream.next()) != null) {\r\n        if (ch == \"<\") {\r\n          state.tokenize = doctype(depth + 1);\r\n          return state.tokenize(stream, state);\r\n        } else if (ch == \">\") {\r\n          if (depth == 1) {\r\n            state.tokenize = inText;\r\n            break;\r\n          } else {\r\n            state.tokenize = doctype(depth - 1);\r\n            return state.tokenize(stream, state);\r\n          }\r\n        }\r\n      }\r\n      return \"meta\";\r\n    };\r\n  }\r\n\r\n  function Context(state, tagName, startOfLine) {\r\n    this.prev = state.context;\r\n    this.tagName = tagName;\r\n    this.indent = state.indented;\r\n    this.startOfLine = startOfLine;\r\n    if (config.doNotIndent.hasOwnProperty(tagName) || (state.context && state.context.noIndent))\r\n      this.noIndent = true;\r\n  }\r\n  function popContext(state) {\r\n    if (state.context) state.context = state.context.prev;\r\n  }\r\n  function maybePopContext(state, nextTagName) {\r\n    var parentTagName;\r\n    while (true) {\r\n      if (!state.context) {\r\n        return;\r\n      }\r\n      parentTagName = state.context.tagName;\r\n      if (!config.contextGrabbers.hasOwnProperty(parentTagName) ||\r\n          !config.contextGrabbers[parentTagName].hasOwnProperty(nextTagName)) {\r\n        return;\r\n      }\r\n      popContext(state);\r\n    }\r\n  }\r\n\r\n  function baseState(type, stream, state) {\r\n    if (type == \"openTag\") {\r\n      state.tagStart = stream.column();\r\n      return tagNameState;\r\n    } else if (type == \"closeTag\") {\r\n      return closeTagNameState;\r\n    } else {\r\n      return baseState;\r\n    }\r\n  }\r\n  function tagNameState(type, stream, state) {\r\n    if (type == \"word\") {\r\n      state.tagName = stream.current();\r\n      setStyle = \"tag\";\r\n      return attrState;\r\n    } else {\r\n      setStyle = \"error\";\r\n      return tagNameState;\r\n    }\r\n  }\r\n  function closeTagNameState(type, stream, state) {\r\n    if (type == \"word\") {\r\n      var tagName = stream.current();\r\n      if (state.context && state.context.tagName != tagName &&\r\n          config.implicitlyClosed.hasOwnProperty(state.context.tagName))\r\n        popContext(state);\r\n      if ((state.context && state.context.tagName == tagName) || config.matchClosing === false) {\r\n        setStyle = \"tag\";\r\n        return closeState;\r\n      } else {\r\n        setStyle = \"tag error\";\r\n        return closeStateErr;\r\n      }\r\n    } else {\r\n      setStyle = \"error\";\r\n      return closeStateErr;\r\n    }\r\n  }\r\n\r\n  function closeState(type, _stream, state) {\r\n    if (type != \"endTag\") {\r\n      setStyle = \"error\";\r\n      return closeState;\r\n    }\r\n    popContext(state);\r\n    return baseState;\r\n  }\r\n  function closeStateErr(type, stream, state) {\r\n    setStyle = \"error\";\r\n    return closeState(type, stream, state);\r\n  }\r\n\r\n  function attrState(type, _stream, state) {\r\n    if (type == \"word\") {\r\n      setStyle = \"attribute\";\r\n      return attrEqState;\r\n    } else if (type == \"endTag\" || type == \"selfcloseTag\") {\r\n      var tagName = state.tagName, tagStart = state.tagStart;\r\n      state.tagName = state.tagStart = null;\r\n      if (type == \"selfcloseTag\" ||\r\n          config.autoSelfClosers.hasOwnProperty(tagName)) {\r\n        maybePopContext(state, tagName);\r\n      } else {\r\n        maybePopContext(state, tagName);\r\n        state.context = new Context(state, tagName, tagStart == state.indented);\r\n      }\r\n      return baseState;\r\n    }\r\n    setStyle = \"error\";\r\n    return attrState;\r\n  }\r\n  function attrEqState(type, stream, state) {\r\n    if (type == \"equals\") return attrValueState;\r\n    if (!config.allowMissing) setStyle = \"error\";\r\n    return attrState(type, stream, state);\r\n  }\r\n  function attrValueState(type, stream, state) {\r\n    if (type == \"string\") return attrContinuedState;\r\n    if (type == \"word\" && config.allowUnquoted) {setStyle = \"string\"; return attrState;}\r\n    setStyle = \"error\";\r\n    return attrState(type, stream, state);\r\n  }\r\n  function attrContinuedState(type, stream, state) {\r\n    if (type == \"string\") return attrContinuedState;\r\n    return attrState(type, stream, state);\r\n  }\r\n\r\n  return {\r\n    startState: function(baseIndent) {\r\n      var state = {tokenize: inText,\r\n                   state: baseState,\r\n                   indented: baseIndent || 0,\r\n                   tagName: null, tagStart: null,\r\n                   context: null}\r\n      if (baseIndent != null) state.baseIndent = baseIndent\r\n      return state\r\n    },\r\n\r\n    token: function(stream, state) {\r\n      if (!state.tagName && stream.sol())\r\n        state.indented = stream.indentation();\r\n\r\n      if (stream.eatSpace()) return null;\r\n      type = null;\r\n      var style = state.tokenize(stream, state);\r\n      if ((style || type) && style != \"comment\") {\r\n        setStyle = null;\r\n        state.state = state.state(type || style, stream, state);\r\n        if (setStyle)\r\n          style = setStyle == \"error\" ? style + \" error\" : setStyle;\r\n      }\r\n      return style;\r\n    },\r\n\r\n    indent: function(state, textAfter, fullLine) {\r\n      var context = state.context;\r\n      if (state.tokenize.isInAttribute) {\r\n        if (state.tagStart == state.indented)\r\n          return state.stringStartCol + 1;\r\n        else\r\n          return state.indented + indentUnit;\r\n      }\r\n      if (context && context.noIndent) return CodeMirror.Pass;\r\n      if (state.tokenize != inTag && state.tokenize != inText)\r\n        return fullLine ? fullLine.match(/^(\\s*)/)[0].length : 0;\r\n      if (state.tagName) {\r\n        if (config.multilineTagIndentPastTag !== false)\r\n          return state.tagStart + state.tagName.length + 2;\r\n        else\r\n          return state.tagStart + indentUnit * (config.multilineTagIndentFactor || 1);\r\n      }\r\n      if (config.alignCDATA && /<!\\[CDATA\\[/.test(textAfter)) return 0;\r\n      var tagAfter = textAfter && /^<(\\/)?([\\w_:\\.-]*)/.exec(textAfter);\r\n      if (tagAfter && tagAfter[1]) { \r\n        while (context) {\r\n          if (context.tagName == tagAfter[2]) {\r\n            context = context.prev;\r\n            break;\r\n          } else if (config.implicitlyClosed.hasOwnProperty(context.tagName)) {\r\n            context = context.prev;\r\n          } else {\r\n            break;\r\n          }\r\n        }\r\n      } else if (tagAfter) { \r\n        while (context) {\r\n          var grabbers = config.contextGrabbers[context.tagName];\r\n          if (grabbers && grabbers.hasOwnProperty(tagAfter[2]))\r\n            context = context.prev;\r\n          else\r\n            break;\r\n        }\r\n      }\r\n      while (context && context.prev && !context.startOfLine)\r\n        context = context.prev;\r\n      if (context) return context.indent + indentUnit;\r\n      else return state.baseIndent || 0;\r\n    },\r\n\r\n    electricInput: /<\\/[\\s\\w:]+>$/,\r\n    blockCommentStart: \"<!--\",\r\n    blockCommentEnd: \"-->\",\r\n\r\n    configuration: config.htmlMode ? \"html\" : \"xml\",\r\n    helperType: config.htmlMode ? \"html\" : \"xml\",\r\n\r\n    skipAttribute: function(state) {\r\n      if (state.state == attrValueState)\r\n        state.state = attrState\r\n    }\r\n  };\r\n});\r\n\r\nCodeMirror.defineMIME(\"text/xml\", \"xml\");\r\nCodeMirror.defineMIME(\"application/xml\", \"xml\");\r\nif (!CodeMirror.mimeModes.hasOwnProperty(\"text/html\"))\r\n  CodeMirror.defineMIME(\"text/html\", {name: \"xml\", htmlMode: true});\r\n\r\n});\r\n"]}